---
title: "Analyzing Spotify Data of Tracks from 1921-2020"
author: "Michael Hoang"
date: "05/02/2021"
output: html_document
---

![Spotify](C:\Users\micha\Pictures\Spotify Logo.jpg)


# INTRODUCTION 


Using a data set from [Kaggle](https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks) that webscrapped data from Spotify, I will attempt to explore this data to explore trends of music over time as it pertains to various musical aspects of a song over the years.  With reference to Spotify's documentation of the audio features used in this data set available [here](https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/), these included the following:


| ** VARIABLE **  | ** DESCRIPTION **                                                                                                                                     |
|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| valence         | "Positiveness" conveyed by a track measured b/t 0 (sad/negative) to 1 (happy/positive)                                                                |
| year            | The year with which the track was released (at least according to Spotify)                                                                            |
| acousticness    | A measure of how acoustic the track is with a measure b/t 0 (low) to 1 (high)                                                                         |
| artists         | Artist who made the track                                                                                                                             |
| danceability    | A measure of how suitable the track is for dancing; range from 0 (low) to 1 (high)                                                                    |
| duration_ms     | Length of the track as measured in milliseconds                                                                                                       |
| energy          | Perceptual measure of the intensity and activity of the song with 0 = low and 1 = high                                                                | 
| explicit        | A dummy variable that tells whether the track is explicit or not                                                                                      |
| id              | track id generated by Spotify                                                                                                                         |
| instrmentalness | A prediction measure of whether a track contains no vocals; 0 = all vocals vs 1 = instrumental; values > 0.5 = instrumental tracks                    | 
| key             | Estimated overall key that the track is played; It's scored using [pitch class notation](https://en.wikipedia.org/wiki/Pitch_class)                   |
| liveness        | A predictive measure of the presence of an audience in the recording where higher value = greater likelihood of an audience                           |
| tempo           | Overall tempo of the track based on beats per minute                                                                                                  |
| loudness        | A measure of how loud the track is based on a range from -60 db to 0 db                                                                               | 
| mode            | The modality of the track where it is either in Major (1) or Minor (0)                                                                                | 
| name            | The name of the track                                                                                                                                 |
| popularity      | Composite score measuring the popularity of the song with 0 = low vs 100 = very popular; weighed more on # of plays and how recently it's been played |
| release_date    | Date when the track was released                                                                                                                      |
| speechiness     | Measure of the presence of spoken work in a track; closer to 1 = very speech-like; 0 - 0.33 = instrumental, 0.33-0.66 = mix, > 0,66 = mostly words    |


Ultimately the goal would be to:

    1) Observe some of the trends of each audio feature of a song across the years (i.e. how does energy/loudness/acousticness change based on year of song release)
    2) Answer some question on which tracks or artists were popular at a given year based on popularity score assigned through Spotify
    3) Devise several models to predict popularity score of a track based on audio & track features. 




## STEP 1: Setting up the Working Directory, Loading the Libraries, Read file

```{r}

options(scipen = 999)
set.seed(123) 
setwd("~/MyDatasets")

library(tidyverse)
library(ggplot2)
library(ggcorrplot)
library(caret)
library(rmarkdown)
library(MASS)
library(rms)
library(skimr)
library(DMwR)
library(class)
library(statmod)
library(tweedie)
library(pscl)
library(mgcv)
library(ggpubr)
library(plyr)
library(rpart)
library(rpart.plot)

spotify = read.csv("spotify_data.csv")

```

## STEP 2: Explore the data 

Overall, it looks pretty decent data set with no apparent issue of missing data. However, it looks like I will need to do some modification to the dataset to include a few variables of interest, address the issue with character strings used for naming artist on a track, segregate credited artists from featured one, appropriately assigning data types to certain variables, etc.  

```{r}

skim(spotify)
summary(spotify)
head(spotify)

```

## STEP 3: Cleaning the data 

**Part A**: Convert the "mode" and "explicit" variable from a numeric into something else that is more appropriate and rename "mode" to something more identifiable.  Realistically, since this is a binary outcome, it could be classified as a factor instead of a numeric.  However, we can re-word this variable to mean the same thing but treat it as a logic instead.

```{r}

spotify = spotify %>% mutate(mode = as.logical(mode), explicit = as.logical(explicit))
spotify = plyr::rename(spotify, c("mode" = "is_major"))
colnames(spotify)

```

**Part B**: Breaking up the names of artists in the spotify data set so that it can be usable.  More importantly, I'm interested in segregating the principal credited artist from the rest of the features.  Fortunately, the prinicpal-credited artist is the first listed artist in this group.  So the intention for me will be to create mutiple columns: one with the principal artist and the others for each individual artist.  I realized that there may be a lot of them, so this will suck. 

    NOTE: In creating a column for each featured artist, I will be introducing some missingness to this data set. This is fine for now. 

```{r}

spotify = spotify %>% 
  mutate(
    artist_step_1 = gsub("\\[|\\]", "", artists) # Getting rid of the square brackets surrounding all of the artists name
  ) %>% 
  mutate(
    artist_step_2 = gsub('\\"', "", artist_step_1) # Getting rid of the double quotes surrounding the artists names
  ) %>% 
  mutate(
    artist_step_3 = gsub("\\'", "", artist_step_2) # Getting rid of the single quotes + apostrophes in artists names
  ) %>%
  mutate(
    more_than_one_artist = str_detect(artist_step_3, ", ") # Determine if there are more than 1 name associated with a given track 
  ) %>% 
  separate(
    artist_step_3, into = c("main.artist", "feature.artist.1", "feature.artist.2", "feature.artist.3", "feature.artist.4", "feature.artist.5", "feature.artist.6", "feature.artist.7", "feature.artist.8", "feature.artist.9", "feature.artist.10", "feature.artist.11", "feature.artist.12", "feature.artist.13", "feature.artist.14", "feature.artist.15", "feature.artist.16", "feature.artist.17", "feature.artist.18", "feature.artist.19", "feature.artist.20", "feature.artist.21", "feature.artist.22", "feature.artist.23", "feature.artist.24", "feature.artist.25", "feature.artist.26", "feature.artist.27", "feature.artist.28", "feature.artist.29", "feature.artist.30", "feature.artist.31", "feature.artist.32", "feature.artist.33", "feature.artist.34", "feature.artist.35", "feature.artist.36", "feature.artist.37", "feature.artist.38", "feature.artist.39"),
			sep = ","
  )


```

**Part C**: Convert duration from milliseconds to seconds

```{r}

spotify = spotify %>% mutate(duration = duration_ms/1000)

```

**Part D**: Removing duplicate track entries in the Spotify Data set. Obviously as we know, certain songs were remade by other artists (i.e. Can't Take My Eyes Off of You, Boots are Made for Walking, Tennesse Whiskey) or re-released by the same artist as part of a Remastered, Live Version or Greatest Hit list (i.e. Another One Bites the Dust from Queen, Immigrant Song from Led Zeppelin, basically anything from Dave Matthews Band). However, from skimming the data set, it was found that there were multiple entries for the same titled track that was from the same artist(s) + year.  Example of these instances include Karol G + Ozuma "Hello" in 2020, Queen '39-Remastered 2011, etc.  So I've decided to use the criteria that songs that were from the same artist(s), same year of release and same titled will be excluded.  It is important to note that popularity is not included in this filtering process as it is likely that folks will pick either one or the other copy (likely the first option that appeared which will impact the popularity score which is based on number of play times and clicks). 

There are 170,653 titled track entries but 37015 entries were duplicated in terms of track title which is about 21.6% of the total entries.  Looking further into this, only 5859 (or ~ 3.43%) of the total entries met the filtering criteria as stated above. So these entries will be excluded in the finalized Spotify Data Set. 

    NOTE: I've kept the featured artist count to 5 since it's really unlikely there will be more than 5 artist on a given track where it will be meaningful. 
  
```{r}

length(spotify$id)
count(duplicated(spotify$name))

spotify %>% 
  group_by(name, main.artist) %>% 
  filter (duplicated(name) == T & duplicated(main.artist) == T & duplicated(year) & duplicated(feature.artist.1) & duplicated(feature.artist.2) & duplicated(feature.artist.3) == T & duplicated(feature.artist.4) == T & duplicated(feature.artist.5) == T & duplicated(more_than_one_artist)) %>% 
  dplyr::summarise(count = n())

spotify_updated = spotify %>% distinct(name, main.artist, year, feature.artist.1, feature.artist.2, feature.artist.3, feature.artist.4, feature.artist.5, more_than_one_artist, .keep_all = T)


```

**Part E**: Introducing a new variable that looks for suspected foreign artist 

So unless I want to individually examine each entry, there really isn't an exact way to determine this.  However, I will operate on the assumption that those with 5 or more non-ASCII characters in a name = definitely foreign.  Granted some artists might slip through the cracks b/c of anglicized names or have names with only English characters, but I really will have some confidence that at least those that are caught = definitely foreign.  

    (Future Mike) Well it was an attempt... Likely will need to refine this further to include a list of unique character combinations to catch artists with anglicized names, which happens to be a much bigger issue here. In any case, we can pretty much ignore this here. 
    
```{r}

is_foreign_artist_check = function(string) {
  num_of_char = 0
  splitted_string = str_split(string, "")
  splitted_string = splitted_string[[1]]
  
  for(char in splitted_string) {
    if (str_detect(char, "[^ -~]") == T) {
      num_of_char = num_of_char + 1
    }
  }
  
  check_status = ifelse(num_of_char >= 5, "yes", 'no')
  return(check_status)
}

list_of_main_artist = spotify_updated$main.artist
placeholder = lapply(list_of_main_artist, is_foreign_artist_check)
is_foreign = unlist(placeholder)
spotify_updated = cbind(spotify_updated, is_foreign)
spotify_updated

```

**Part F**: Potential issues with one-hit wonders 

Given the ruthlessness of the Music Industry, it obvious that some artists will not have a really long career or in some cases lucrative.  However there are instances where some folks experience a short-lived fame in music history (i.e. one-hit wonders).  The problem with these groups are that they do end up being outliers in future analysis.  So we will try to eliminate those artist that did not have **3 or more** songs on Spotify (i.e. Trinidad James).  The rationale for this is based on the distribution of the "count" variable within the "by_artist" data set where the median score was 3 songs. 

    NOTE: I didn't show this process, but the approach to this was to find the list of names where the "main artist" only had 2 or less appearances.  From there, I've essentially splitted up the number of names into sections and used regular expression to select only those that EXACTLY matched these names to identify as "one-hit wonders".  

```{r}

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.1 = ifelse(str_detect(main.artist, "^\\$NOT$|^\\$uicideBoy\\$$|^\\(Hed\\) P.E.$|^\\*NSYNC$|^\\? & The Mysterians$|^\\+44$|^03 Greedo$|^10$|^10 Years$|^100 gecs$|^101 Strings Orchestra$|^10cc$|^112$|^12 Stones$|^13th Floor Elevators$|^1422$|^1910 Fruitgum Company$|^1986 Omega Tribe$|^2 Chainz$|^2 LIVE CREW$|^2 Unlimited$|^20 Fingers$|^2002$|^20th Century Fox Studio Orchestra$|^21 Savage$|^24kGoldn$|^2NE1$|^2Pac$|^3 Doors Down$|^311$|^38 Special$|^3LW$|^3OH!3$|^3rd Bass$|^4 Non Blondes$|^45 Grave$|^4Him$|^5 Seconds of Summer$|^50 Cent$|^50 Guitars of Tommy Garrett$|^69 Boyz$|^6ix9ine$|^6LACK$|^702$|^88rising$|^8Ball$|^8Ball & MJG$|^98Âº$|^999$|^a-ha$|^A Boogie Wit da Hoodie$|^A Day To Remember$|^A Flock Of Seagulls$|^A Great Big World$|^A Perfect Circle$|^A R I Z O N A$|^A Rocket To The Moon$|^A Skylit Drive$|^A Taste Of Honey$|^A Tribe Called Quest$|^A\\$AP Ferg$|^A\\$AP Mob$|^A\\$AP Rocky$|^A*Teens$|^A. L. Lloyd$|^A. M. Rajah$|^A. P. Komala$|^A. R. Oza$|^A. R. Qureshi$|^A.B. Quintanilla III$|^A.B. Quintanilla III Y Los Kumbia Kings$|^A.R. Rahman$|^Ã“lafur Arnalds$|^Ã“scar ChÃ¡vez$|^Ã“scar Medina$|^Ã‰dith Piaf$|^Ã‰douard Lalo$|^Ã\u0081ngeles Del Infierno$|^Aaliyah$|^Aaron Copland$|^Aaron Hall$|^Aaron Kwok$|^Aaron Lewis$|^Aaron Lohr$|^Aaron Neville$|^Aaron Tippin$|^Aaron Watson$|^Aaron Y Su Grupo Ilusion$|^Aarti Mukherji$|^Ab-Soul$|^ABBA$|^Abbasuddin Ahmed$|^ABC$|^Abdel Aziz Mahmoud$|^Abdel Halim Hafez$|^Abel Zavala$|^Abhayapada Chatterjee$|^Abhram Bhagat$|^ABN$|^Above & Beyond$|^Abraham Goldfaden$|^Abram Chasins$|^AC/DC$|^Academia dos Renascidos$|^Acapulco Tropical$|^Accept$|^Ace Frehley$|^Ace Hood$|^Ace of Base$|^Acerina Y Su Danzonera$|^Acid Bath$|^Acker Bilk$|^Action Bronson$|^Adalberto Santiago$|^Adam Ant$|^Adam Hicks$|^Adam Lambert$|^Adam Pascal$|^Adam Sandler$|^Adan Chalino Sanchez$|^Adele$|^Adelitas Way$|^Adema$|^Adolescents$|^Adolescents Orquesta$|^Adolfo BerÃ³n$|^Adolph Deutsch$|^Adolph Green$|^Adolphe Adam$|^Adolphe BÃ©rard$|^Adriana Caselotti$|^Adriano Celentano$|^Adriel Favela$|^Adventure Time$|^Aer$|^Aerosmith$|^Aesop Rock$|^AFI$|^Afrika Bambaataa$|^Afrojack$|^Afroman$|^After 7$|^After The Burial$|^Against Me!$|^Agathoklis Mouskas$|^Agent Orange$|^Agnostic Front$|^Agust D$|^AgustÃ­n Barrios MangorÃ©$|^AgustÃ­n Lara$|^Ahmad Jamal$|^Ahmad Jamal Quintet$|^Ahmad Jamal Trio$|^Ahmed Dilawar$|^Aida Cuevas$|^Aim$|^Aimee Mann$|^Air$|^Air Supply$|^Airbourne$|^Airplay$|^AJ Mitchell$|^AJ Rafael$|^AJJ$|^AJR$|^Akira Yamaoka$|^Akon$|^Akwid$|^Al B. Sure!$|^Al Bowlly$|^Al Caiola$|^Al Di Meola$|^Al Green$|^Al Haig Quartet$|^Al Haig Trio$|^Al Hirt$|^Al Hurricane$|^Al Jarreau$|^Al Jolson$|^Al Kooper$|^Al Martino$|^Al Stewart$|^Alabama$|^Alabama Shakes$|^Alacranes Musical$|^Alan Hawkshaw$|^Alan Jackson$|^Alan Lomax$|^Alan Menken$|^Alan Mills$|^Alan Silvestri$|^Alan Tam$|^Alan Walker$|^Alanis Morissette$|^Alannah Myles$|^Alasdair Fraser$|^Alaska Y Dinarama$|^Alban Berg$|^Albeli$|^Albert Collins$") == T, TRUE, FALSE)
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.2 = 
      ifelse(str_detect(main.artist, "^Albert Hammond$|^Albert King$|^Albert Lortzing$|^Albert PrÃ©jean$|^Alberto Beltran$|^Alberto Cortez$|^Alberto Gomez$|^Alberto Pedraza$|^Alberto Rabagliati$|^Alberto Vazquez$|^Alberto Y Roberto$|^Alborosie$|^Alcoholics Anonymous$|^Aldo Nova$|^Alec Benjamin$|^Alec Guitar Slim Seward$|^Alejandra Guzman$|^Alejandra Zambrini$|^Alejandro FernÃ¡ndez$|^alejandro ramirez silva$|^Alejandro Sanz$|^Alekos Dimou$|^Alekos Kitsakis$|^Aleks Syntek$|^Alessandra De Negri$|^Alessia Cara$|^Alesso$|^Alex & Sierra$|^Alex Bueno$|^Alex Bugnon$|^Alex Campos$|^Alex de Grassi$|^Alex G$|^Alex Gargolas$|^Alex Rose$|^Alex Turner$|^Alex Ubago$|^Alexander Borodin$|^Alexander Glazunov$|^Alexander ONeal$|^Alexander Scriabin$|^Alexander Skip Spence$|^Alexandre Desplat$|^Alexi Murdoch$|^Alexis y Fido$|^Alexisonfire$|^Alfred Drake$|^Alfred Hitchcock$|^Alfred Newman$|^Alfredo Catalani$|^Alfredo Olivas$|^Ali Farka TourÃ©$|^Ali Gatie$|^Alibert$|^Alice Coltrane$|^Alice Cooper$|^Alice DJ$|^Alice Faye$|^Alice In Chains$|^Alicia Keys$|^Alicia Myers$|^Alicia Villarreal$|^Alien Ant Farm$|^Alina Baraz$|^Alison Krauss$|^Alison Krauss & Union Station$|^Alison Moyet$|^Alka Yagnik$|^Alkaline Trio$|^All-4-One$|^All Sons & Daughters$|^All That Remains$|^All Time Low$|^Alla Pugacheva$|^Allen Toussaint$|^Allman Brothers Band$|^Allure$|^Almirante$|^Aloe Blacc$|^Alpana Banerjee$|^Alphaville$|^alt-J$|^Alter Bridge$|^Altered Images$|^Althea And Donna$|^Alton Ellis$|^Alvarenga E Ranchinho$|^Alvaro Torres$|^Alvin & The Chipmunks$|^Alvvays$|^Aly & AJ$|^AmÃ¡Î™ia Rodrigues$|^AmÃ¡lia Rodrigues$|^AmaIia Rodriguez$|^Amalia Mendoza$|^Amanaz$|^Amanda Miguel$|^Amanda Perez$|^Amanda Seyfried$|^Amaranthe$|^Amazing Rhythm Aces$|^Amber Run$|^Ambroise Thomas$|^Ambrosia$|^Amel Larrieux$|^America$|^American Authors$|^American Football$|^American Hi-Fi$|^Amerie$|^Amilcare Ponchielli$|^AminÃ©$|^Amir Khan$|^Amirbai Karnataki$|^Amitabh Bachchan$|^Amon Amarth$|^Amon DÃ¼Ã¼l II$|^Amon Tobin$|^Amos Lee$|^Amr Diab$|^Amy Adams$|^Amy Grant$|^Amy Winehouse$|^Ana BÃ¡rbara$|^Ana BelÃ©n$|^Ana Gabriel$|^Ananda Shankar$|^Anarbor$|^Anasuya Mukherjee$|^Anberlin$|^Anca Elena$|^Anderson .Paak$|^AndrÃ© BaugÃ©$|^AndrÃ© Breton$|^AndrÃ© Gide$|^AndrÃ© Previn$|^AndrÃ© Reyes$|^AndrÃ© Rieu$|^AndrÃ©s Calamaro$|^AndrÃ©s Segovia$|^Andrae Crouch$|^Andre Kostelanetz$|^Andre Kostelanetz & His Orchestra$|^Andre Nickatina$|^Andrea Bocelli$|^Andrea McArdle$|^Andrea Wolper$|^Andreas Vollenweider$|^Andrew Belle$|^Andrew Bird$|^Andrew E.$|^Andrew Gold$|^Andrew Hill$|^Andrew Lloyd Webber$|^Andrew Rannells$|^Andrew Rowan Summers$|^Andrew W.K.$|^Andy Gibb$|^Andy Grammer$|^Andy Griffith$|^Andy Griggs$|^Andy Irvine$|^Andy Mineo$|^Andy MontaÃ±ez$|^Andy Williams$|^Anestis Delias$|^Anestos Delias$|^Angel Canales$|^Angel Olsen$|^Angel Y Khriz$|^Angela Bofill$|^Angela Lansbury$|^Angela Winbush$|^Angelo Badalamenti$|^Angels & Airwaves$|^Angie Stone$|^Angurbala Devi$|^Angus & Julia Stone$|^Ani DiFranco$|^Aniceto Molina$|^Aniceto Molina Y La Luz Roja De San Marcos$|^Anika Noni Rose$|^Anika Rizvi$|^Anil Biswas$|^Anima Dasgupta$|^Anima Ghosh$|^Animal Collective$|^Animaniacs$|^Anita Baker$|^Anita Darian$|^Anita Mui$|^Anita ODay$|^Anjali Mukherjee$|^Anjos Do Inferno$|^Ann-Margret$|^Ann Miller$|^Ann Peebles$|^Anna Clendening$|^Anna Russell$|^Annaleigh Ashford$") == T, TRUE,
      ifelse(at_least_3_songs.1 == T, TRUE, FALSE))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.3 = 
      ifelse(str_detect(main.artist, "^Anne Lloyd$|^Anne Murray$|^Annette Funicello$|^Annette Moreno$|^Annie Lennox$|^Annie Ross$|^Annihilator$|^Anonymous$|^Another Bad Creation$|^Anoushirvan Rohani$|^Anri$|^Ansambl Biljana$|^Anson Seabra$|^AntÃ´nio Carlos Jobim$|^Anthony Hamilton$|^Anthony Ramos$|^Anthony Rapp$|^Anthony Santos$|^Anthony Warlow$|^Anthrax$|^Anti-Flag$|^Anton Bruckner$|^Anton Rubinstein$|^Anton Webern$|^Antonello Venditti$|^Antonio Aguilar$|^Antonio Diaz Mena$|^Antonio Morel$|^Antonio PriÃ³$|^Antonio Vivaldi$|^ANTONIS NTALGKAS$|^Antony Santos$|^Anuel AA$|^Anup Ghoshal$|^Anupam Ghatak$|^Anuradha Paudwal$|^Anvil$|^Anzen Chitai$|^Aphex Twin$|^APO Hiking Society$|^Apocalyptica$|^Apocolothoth$|^Apostolos Xatzixristos$|^April Wine$|^Aqua$|^Aqua Timez$|^AR30$|^Aracy de Almeida$|^Aram Khachaturian$|^Arcade Fire$|^Arcadia$|^Arcangel$|^Arcangelo Corelli$|^Arch Enemy$|^Archana$|^Archers Of Loaf$|^Archibald MacLeish$|^Archie Bell & The Drells$|^Archie Shepp$|^Arctic Monkeys$|^Aretha Franklin$|^Argent$|^Ari Lennox$|^Ariana Grande$|^Ariel Camacho y Los Plebes Del Rancho$|^Ariel Pink$|^Ariel Rivera$|^Ariel Zilber$|^Aries$|^Arijit Singh$|^Arik Einstein$|^Arizona Zervas$|^Arletty$|^Arlo Guthrie$|^Armand Van Helden$|^Armando Manzanero$|^Armando Sciascia$|^Armando Trovajoli$|^Armin van Buuren$|^Armor For Sleep$|^Armored Saint$|^Arnold Bax$|^Arrested Development$|^Arsenal Efectivo$|^Art Blakey$|^Art Blakey & The Jazz Messengers$|^Art Blakey Percussion Ensemble$|^Art Blakey Quintet$|^Art Farmer$|^Art Garfunkel$|^Art Lund$|^Art Of Dying$|^Art Pepper$|^Art Tatum$|^Art Taylor$|^Arthur Askey$|^Arthur Askey and cast$|^Arthur Lyman$|^Arthur Russell$|^Arthur Schnitzer$|^Arthur Schwartz$|^Arthur Sullivan$|^Arthur Verocai$|^Artie Morris$|^Artie Shaw$|^Arun Kumar$|^Arvo PÃ¤rt$|^As I Lay Dying$|^Ascharyamoyee Dasi$|^Aschberger Saitenmusi$|^Asha Bhosle$|^Ashana$|^Ashanti$|^Ashes Remain$|^Ashford & Simpson$|^Ashlee Simpson$|^Ashley Tisdale$|^Ashnikko$|^Ashok Kumar$|^Ashra$|^Ashraf Khan$|^Asia$|^ASIAN KUNG-FU GENERATION$|^Asin$|^Asit Baran$|^Asking Alexandria$|^Asleep At The Wheel$|^Astor Piazzolla$|^Astrud Gilberto$|^Aswad$|^At The Drive In$|^At The Gates$|^ATB$|^Aterciopelados$|^Athanase Sika$|^Atlanta Rhythm Section$|^Atlantic Five Jazz Band$|^Atlantic Starr$|^Atmosphere$|^Atomic Kitten$|^Atreyu$|^Attack Attack!$|^Attila$|^Attila the Hun$|^Audio Adrenaline$|^Audioslave$|^Audrey Hepburn$|^August Alsina$|^August Burns Red$|^Augustana$|^Augustin Ramirez$|^Augustus Pablo$|^Aulii Cravalho$|^AURORA$|^Aurra$|^Austin Mahone$|^Austin Moon$|^Australian Crawl$|^Authority Zero$|^Autograph$|^Autoheart$|^Ava Max$|^Avant$|^Avelino MuÃ±oz$|^Avenged Sevenfold$|^Aventura$|^Average White Band$|^Avicii$|^Avinash$|^Avinash Vyas$|^Avril Lavigne$|^AWOLNATION$|^ayokay$|^AZ$|^Azealia Banks$|^Aztec Camera$|^Azucar Moreno$|^Azumi Inoue$|^Azymuth$|^B-Legit$|^B Jayamma$|^B\\*Witched$|^B. Chagy$|^B.B. King$|^B.J. Thomas$|^B.o.B$|^B.T. Express$|^B2K$|^BÃ˜RNS$|^BÃ©la BartÃ³k$|^BÃ©la Fleck$|^BÃ©la Fleck and the Flecktones$|^bÃ¼low$|^BabasÃ³nicos$|^Babatunde Olatunji$|^Babe Ruth$|^Babes In Toyland\\xa0$|^Baby Alka$|^Baby Bash$|^Baby Dodds$") == T, TRUE,
      ifelse(at_least_3_songs.2 == T, TRUE,
      ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.4 = 
      ifelse(str_detect(main.artist, "^Baby Huey & The Baby Sitters$|^Baby Keem$|^Baby Lullaby Academy$|^Babyface$|^BABYMETAL$|^Bachman-Turner Overdrive$|^Bacilos$|^Backstreet Boys$|^Bad Boys Blue$|^Bad Brains$|^Bad Bunny$|^Bad Company$|^Bad English$|^Bad Manners$|^Bad Meets Evil$|^Bad Religion$|^Bad Suns$|^Bad Wolves$|^Baden Powell$|^Badfinger$|^Badly Drawn Boy$|^Baha Men$|^Bahamas$|^Baileys Nervous Kats$|^Balaidas Sil$|^Balbir$|^Balgandharva$|^Balla Et Ses Balladins$|^Balmorhea$|^Bananarama$|^Band of Horses$|^Band Of Skulls$|^Banda Arkangel R-15$|^Banda Blanca$|^Banda Bostik$|^Banda Brava$|^Banda Cuisillos$|^Banda El Recodo$|^Banda EspaÃ±ola$|^Banda La CosteÃ±a$|^Banda La Pirinola$|^Banda Los GuamuchileÃ±os De Culiacan$|^Banda Los Lagos$|^Banda Los Recoditos$|^Banda Machos$|^Banda Maguey$|^Banda Movil$|^Banda MS de Sergio LizÃ¡rraga$|^Banda Pachuco$|^Banda Pelillos$|^Banda PequeÃ±os Musical$|^Banda R-15$|^Banda Republicana$|^Banda Sinaloense El Recodo De Cruz Lizarraga$|^Banda Sinaloense Los Recoditos$|^Banda Sinaloense MM$|^Banda Torera Del Valle$|^Banda Vallarta Show$|^Bankrol Hayden$|^BANKS$|^BANNERS$|^Bao Huy$|^BarÃ£o Vermelho$|^Barbara Cook$|^Barbara Dane$|^Barbara Lewis$|^Barbara Lynn$|^Barbara Mandrell$|^Barbara Mason$|^Barbra Streisand$|^Barenaked Ladies$|^Barian$|^Barney$|^Barney Kessel$|^Barns Courtney$|^Barrett Wilbert Weed$|^Barrington Levy$|^Barry Dennen$|^Barry Frank$|^Barry Harris Trio$|^Barry Manilow$|^Barry McGuire$|^Barry White$|^Bas$|^Bascom Lamar Lunsford$|^Basement Jaxx$|^Bashir Qawal$|^Basia$|^Basies Bad Boys$|^Basshunter$|^Bassnectar$|^Bastiaan Everink$|^Bastille$|^Bathory$|^Bauhaus$|^Bay City Rollers$|^Bayside$|^Bazzi$|^bbno$$|^Bea Miller$|^beabadoobee$|^Beach Bunny$|^Beach Fossils$|^Beach House$|^Beanie Sigel$|^Beartooth$|^Beastie Boys$|^Beat Happening$|^Beatriz Adriana$|^Beautiful Chorus$|^Bebe & Cece Winans$|^Bebe Rexha$|^Bechu Dutta$|^Beck$|^Becky G$|^Bedana Dasi$|^BedÅ™ich Smetana$|^Bedroom$|^Bedtime Baby$|^Bee Gees$|^Beegie Adair$|^Beenie Man$|^Begum Para$|^Beirut$|^Belanova$|^Belinda Carlisle$|^Bell Biv DeVoe$|^Belle & Sebastian$|^Belly$|^Belton Richard$|^Ben E. King$|^Ben Fankhauser$|^Ben Folds$|^Ben Folds Five$|^Ben Harper$|^Ben Howard$|^Ben Platt$|^Ben Rector$|^Ben Webster$|^Ben Wright$|^BENEE$|^Beniamino Gigli$|^Benjamin Britten$|^Benjy Wertheimer$|^Benny$|^Benny Benassi$|^benny blanco$|^Benny Carter$|^Benny Golson$|^Benny Goodman$|^Benny Goodman Big Band$|^Benny Goodman Quartet$|^Benny Goodman Sextet$|^Benny Goodman Trio$|^Benny Hinn$|^Beny MorÃ©$|^Beres Hammond$|^Berlin$|^Bernadette Peters$|^Bernard Herrmann$|^Bernard Wright$|^Berner$|^Bert Jansch$|^Bert Kaempfert$|^Bert Lahr$|^Berthe Sylva$|^Bertie Higgins$|^Bessie Smith$|^Best Coast$|^Beth Carvalho$|^Bethel Music$|^Beto Quintanilla$|^Beto Y Sus Canarios$|^Bette Davis$|^Bette Midler$|^Better Than Ezra$|^Betty Carter$|^Betty Davis$|^Betty Everett$|^Betty Harris$|^Betty Hutton$|^Betty Wright$|^Beverly Glenn-Copeland$|^Beverly Kenney$|^BeyoncÃ©$|^Beyond$|^Beyondomatic$|^Bhad Bhabie$|^Bhanumathi Ramakrishna$|^Bharat Vyas$|^Bharati Devi$|^Bhimsen Joshi$|^Bhupinder Singh$|^Bibbo$|^Bienvenido Granda$|^Big & Rich$|^Big Audio Dynamite$|^Big Bad Voodoo Daddy$|^Big Bill Broonzy$|^Big Bird$") == T, TRUE,
      ifelse(at_least_3_songs.3 == T, TRUE,
      ifelse(at_least_3_songs.2 == T, TRUE, 
      ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.5 = 
      ifelse(str_detect(main.artist, "^Big Black$|^Big Boi$|^Big Brother & The Holding Company$|^Big Country$|^Big Daddy Kane$|^Big Daddy Weave$|^Big Gigantic$|^Big Head Todd and The Monsters$|^Big Jay McNeely$|^Big L$|^Big Mama Thornton$|^Big Maybelle$|^Big Mike$|^Big Moe$|^Big Pun$|^Big Sean$|^Big Star$|^Big Thief$|^Big Time Rush$|^Big Tymers$|^Big Wild$|^BIGBANG$|^Bijoylal Mukherjee$|^Bikini Kill$|^Bill Bonyun$|^Bill Charlap$|^Bill Clifton$|^Bill Conti$|^Bill Cosby$|^Bill Doggett$|^Bill Evans$|^Bill Evans Trio$|^Bill Haley & His Comets$|^Bill Jenkins$|^Bill Jenkins and the Virginia Mountain Boys$|^Bill Justis$|^Bill LaBounty$|^Bill Lee$|^Bill Monroe$|^Bill Monroe & His Blue Grass Boys$|^Bill Withers$|^Billie Eilish$|^Billie Holiday$|^Billie Jo Spears$|^Billos$|^Billy Bragg$|^Billy Cobham$|^Billy Currington$|^Billy Dean$|^Billy Eckstine$|^Billy Idol$|^Billy Joe Royal$|^Billy Joe Shaver$|^Billy Joel$|^Billy Lee Riley$|^Billy May$|^Billy Ocean$|^Billy Paul$|^Billy Preston$|^Billy Ray Cyrus$|^Billy Squier$|^Billy Stewart$|^Billy Strayhorn$|^Billy Swan$|^Billy Talent$|^Billy Taylor$|^Billy Vaughn$|^Billy Walker$|^Bimal Bhushan$|^Bina Chowdhury$|^Binapani Mukherjee$|^Bing Crosby$|^Bingo Players$|^Binomio de Oro$|^Binomio de Oro de AmÃ©rica$|^Binota Roy$|^Bird Sounds$|^Birdman$|^Birdtalker$|^Birdy$|^Bishop Paul S. Morton$|^Bix Beiderbecke$|^Biz Markie$|^BJ The Chicago Kid$|^BjÃ¶rk$|^Black & Blues$|^Black Box$|^Black Eyed Peas$|^Black Flag$|^Black Label Society$|^Black Moon$|^Black Oak Arkansas$|^Black Rebel Motorcycle Club$|^Black Sabbath$|^Black Sheep$|^Black Star$|^Black Stone Cherry$|^Black Uhuru$|^Black Veil Brides$|^Blackalicious$|^blackbear$|^Blackberry Smoke$|^Blackfoot$|^BlackHawk$|^Blackmill$|^BLACKPINK$|^Blackstreet$|^Blake Shelton$|^Blancmange$|^Blaque$|^Blaze Foley$|^Bleachers$|^Blessid Union Of Souls$|^blessthefall$|^Blest$|^Blind Faith$|^Blind Guardian$|^Blind Melon$|^Blind Pilot$|^Blind Willie Johnson$|^Blind Willie McTell$|^blink-182$|^Blitz$|^Bloc Party$|^Blockhead$|^Blondie$|^Blood$|^Blood Orange$|^Bloodhound Gang$|^Bloods & Crips$|^Bloodstone$|^Blossom Dearie$|^Blu Cantrell$|^Blue$|^Blue-Room$|^Blue Ã–yster Cult$|^Blue Cheer$|^Blue Magic$|^Blue Mitchell$|^Blue October$|^Blue Rodeo$|^Blue Swede$|^Blueface$|^Bluegrass Champs$|^Blues Traveler$|^Blur$|^Bnny Rbbt$|^Bo Burnham$|^Bo Diddley$|^BoA$|^Boards of Canada$|^Bob Brookmeyer$|^Bob Crosby & His Orchestra$|^Bob Crosby & The Bob Cats$|^Bob Dorough$|^Bob Dylan$|^Bob James$|^Bob Luman$|^Bob Marley & The Wailers$|^Bob Nelson$|^Bob Newhart$|^Bob Seger$|^Bob Seger & The Last Heard$|^Bob Sinclar$|^Bob Weir$|^Bob Welch$|^Bob Wills$|^Bob Wills & His Texas Playboys$|^Bobbi Humphrey$|^Bobbie Gentry$|^Bobby Bare$|^Bobby Blue Bland$|^Bobby Boris Pickett$|^Bobby Brown$|^Bobby Caldwell$|^Bobby Capo$|^Bobby Charles$|^Bobby Cruz$|^Bobby Darin$|^Bobby Day$|^Bobby Driscoll$|^Bobby Goldsboro$|^Bobby Hebb$|^Bobby Helms$|^Bobby Hutcherson$|^Bobby Lewis$|^Bobby McFerrin$|^Bobby Pulido$|^Bobby Rydell$|^Bobby Shmurda$|^Bobby Taylor & The Vancouvers$|^Bobby Timmons$|^Bobby Timmons Trio$|^Bobby V.$|^Bobby Valentin$|^Bobby Vee$|^Bobby Vinton$|^Bobby Womack$|^Bodeans$|^Body Count$") == T, TRUE,
      ifelse(at_least_3_songs.4 == T, TRUE,
      ifelse(at_least_3_songs.3 == T, TRUE,
      ifelse(at_least_3_songs.2 == T, TRUE, 
      ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.6 = ifelse(str_detect(main.artist, "^Bohannon$|^Bohumil KulÃ­nskÃ½$|^Bolt Thrower$|^Bomba EstÃ©reo$|^Bombay Bicycle Club$|^Bon Iver$|^Bon Jovi$|^Bone Thugs-N-Harmony$|^BONES$|^Boney James$|^Boney M.$|^Bonnie Raitt$|^Bonnie Tyler$|^Bonny Cepeda$|^Bonobo$|^Boogie Down Productions$|^Book Of Love$|^Booker Little$|^Booker T. & the M.G.s$|^Boosie Badazz$|^Boots Randolph$|^Bootsy Collins$|^Boris Karloff$|^Boston$|^Bourvil$|^Bow Wow$|^Bow Wow Wow$|^Bowling For Soup$|^Box Car Racer$|^boy pablo$|^Boyce Avenue$|^Boys Like Girls$|^Boyz II Men$|^Boyzone$|^Boz Scaggs$|^Brad Fiedel$|^Brad Kane$|^Brad Mehldau$|^Brad Paisley$|^Brainstorm$|^Brand New$|^Brand Nubian$|^Brandi Carlile$|^Brandon Heath$|^Brandy$|^Brantley Gilbert$|^Brass Construction$|^Bratmobile$|^Brazeros Musical De Durango$|^Bread$|^Breakbot$|^Breaking Benjamin$|^Breakwater$|^Brenda And The Tabulations$|^Brenda K. Starr$|^Brenda Lee$|^Brenda Russell$|^Brent Faiyaz$|^Brenton Wood$|^Brett Dennen$|^Brett Eldredge$|^Brett Young$|^Brewer & Shipley$|^Brian Crain$|^Brian Culbertson$|^Brian Eno$|^Brian Hyland$|^Brian McKnight$|^Brian Regan$|^Brian Setzer$|^Brian Stokes Mitchell$|^Brian Tuey$|^Brian Tyler$|^Brick$|^Bridget St John$|^Bridgit Mendler$|^Bright Eyes$|^Brigitte Bardot$|^Brijmala$|^Bring Me The Horizon$|^Brinquinho e Brioso$|^Briston Maroney$|^Britney Spears$|^Britny Fox$|^Britt Nicole$|^Broadcast$|^BROCKHAMPTON$|^Broken Bells$|^Broken Social Scene$|^Bronco$|^Bronco El Gigante de America$|^Bronski Beat$|^Brook Benton$|^Brooklyn Bridge$|^Brooks & Dunn$|^Brooks Jefferson$|^Brotha Lynch Hung$|^Brother Ali$|^Brother John Sellers$|^Brother Yusef$|^Brothers Osborne$|^Brown Bird$|^Brownie McGhee$|^Brownside$|^Brownstone$|^Bruce Cockburn$|^Bruce Faulconer$|^Bruce Hornsby$|^Bruce Rowland$|^Bruce Springsteen$|^Bruno Major$|^Bruno Mars$|^Bruno Nicolai$|^Bryan Adams$|^Bryan Ferry$|^Bryan White$|^Bryce Vine$|^Bryson Tiller$|^BTS$|^Bubba Sparxxx$|^Buck Clayton$|^Buck Owens$|^Buckcherry$|^Buckethead$|^Buckwheat Zydeco$|^Bud Powell$|^Bud Powell Trio$|^Buddy DeFranco$|^Buddy Fo & His Group$|^Buddy Greco$|^Buddy Guy$|^Buddy Holly$|^Buddy Miles$|^Buddy Rich$|^Buddy Rich And His Sextet$|^Buddy Weed$|^Budgie$|^Buena Vista Social Club$|^Buffalo Springfield$|^Buffy Sainte-Marie$|^Built To Spill$|^Buju Banton$|^Bukka White$|^Bullet For My Valentine$|^Bulletboys$|^Bulo C.Rani$|^Bun B$|^Bunbury$|^Bunny Berigan$|^Bunny Berigan and His Orchestra$|^Bunny Wailer$|^Burl Ives$|^Burning Spear$|^Burt Bacharach$|^Burton Cummings$|^Burzum$|^Busdriver$|^Bush$|^Busta Rhymes$|^Butthole Surfers$|^Buzzcocks$|^Byron Cage$|^C-Kan$|^C-Murder$|^C & C Music Factory$|^C. H. Atma$|^C. Ramchandra$|^C.W. McCall$|^C418$|^CÃ©line Dion$|^CÃ©sar Franck$|^Caamp$|^Cab Calloway$|^Cab Calloway & His Orchestra$|^Cactus$|^Caetano Veloso$|^CafÃ© Tacvba$|^Cage The Elephant$|^Caifanes$|^Cake$|^Cal Tjader$|^Cal Tjader Quartet$|^Cal Tjaders Modern Mambo Quintet$|^Calboy$|^Cali Life Style$|^Calibre 50$|^Call Me Karizma$|^Calle 13$|^Calo$|^Calum Scott$|^Calvin Harris$|^Calvin Richardson$|^Camâ€™ron$|^Camarata Chorus and Orchestra$|^Camel$|^Cameo$|^Camila$|^Camila Cabello$|^Camille Saint-SaÃ«ns$|^Camilo$") == T, TRUE,
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.7 = ifelse(str_detect(main.artist, "^Camilo Sesto$|^Camouflage$|^Camp Lo$|^Camper Van Beethoven$|^CAN$|^Candace$|^Candi Staton$|^Candido Camero$|^Candlebox$|^Candlemass$|^Candy Johnson$|^Canhoto$|^Canned Heat$|^Cannibal Corpse$|^Cannonball Adderley$|^Cannonball Adderley Quartet$|^Cano Estremera$|^Canserbero$|^Capcom Sound Team$|^Capn Jazz$|^Capone-N-Noreaga$|^Captain & Tennille$|^Captain Beefheart & His Magic Band$|^Captain Beyond$|^Car Seat Headrest$|^Caravan$|^Caravan Palace$|^Cardenales De Nuevo LeÃ³n$|^Cardi B$|^Caribou$|^Carin Leon$|^Carl Anderson$|^Carl Carlton$|^Carl Maria von Weber$|^Carl Nielsen$|^Carl Orff$|^Carl Perkins$|^Carl Philipp Emanuel Bach$|^Carl Thomas$|^Carl Verheyen$|^Carl Woitschach$|^Carl Zittrer$|^Carla Boni$|^Carla Bruni$|^Carla Morrison$|^Carla Thomas$|^Carlo Buti$|^Carlo Buti Con Orchestra Stefano Ferruzzi$|^Carlo Pepoli$|^Carlos Di Sarli$|^Carlos Gardel$|^Carlos Montoya$|^Carlos Santana$|^Carlos Vives$|^Carlos Y Jose$|^Carlota Jaramillo$|^Carlton and the Shoes$|^Carly Pearce$|^Carly Rae Jepsen$|^Carly Simon$|^Carmen Delia Dipini$|^Carmen McRae$|^Carmen Miranda$|^Carnage$|^Carnoustie and District Youth Brass Band$|^Carol Burnett$|^Carol Channing$|^Carol Hall$|^Carol Richards$|^Carole King$|^Carolina Cardoso de Menezes$|^Carpenters$|^Carre$|^Carrie Underwood$|^Carroll Gibbons$|^Cartel$|^Cartel De Santa$|^Casa De Leones$|^Cascada$|^Cascatinha & Inhana$|^Case$|^Casey Donahew$|^Cash Cash$|^CASIOPEA$|^Cass Elliot$|^Cassidy$|^Cassie$|^Cast Of The Motion Picture Rent$|^Casting Crowns$|^Cat Power$|^Catch 22$|^Catfish and the Bottlemen$|^Catherine Zeta-Jones$|^Cavetown$|^Cazuza$|^CeCe Peniston$|^CeCe Winans$|^Cecil Lytle$|^Cecil Taylor$|^Cecilio & Kapono$|^Cedarmont Kids$|^CeeLo Green$|^Celeste Holm$|^Celia Cruz$|^Cellular Project$|^Celso PiÃ±a$|^Celtic Frost$|^Celtic Woman$|^Central Departure$|^Ceora Jaffe$|^CesÃ¡ria Evora$|^Cesare Andrea Bixio$|^Chad & Jeremy$|^Chad Mitchell Trio$|^Chaka Demus & Pliers$|^Chaka Khan$|^Chalino Sanchez$|^Chamillionaire$|^Champion Jack Dupree$|^Chance the Rapper$|^Chandrakala$|^Change$|^Changing Faces$|^ChantÃ© Moore$|^Chantal Kreviazuk$|^Chapuseaux y DamirÃ³n$|^Charity Bailey$|^Charles Aznavour$|^Charles Bernstein$|^Charles Bradley$|^Charles Gounod$|^Charles Mingus$|^Charles Strouse$|^Charles Trenet$|^Charles Wright & The Watts 103rd Street Rhythm Band$|^Charley Pride$|^Charli XCX$|^Charlie$|^Charlie Byrd$|^Charlie Chaplin$|^Charlie Daniels$|^Charlie Mariano$|^Charlie Palmieri$|^Charlie Parker$|^Charlie Parker And His Orchestra$|^Charlie Parker Quartet$|^Charlie Parker Quintet$|^Charlie Puth$|^Charlie Rich$|^Charlie Robison$|^Charlie Rouse$|^Charlie Wilson$|^Charlotte Diamond$|^Charly GarcÃ­a$|^Charly McClain$|^Charmian Carr$|^Charras Gonzalez$|^Chase Atlantic$|^Chase Rice$|^Chava Alberstein$|^Chayanne$|^Chayito Valdez$|^Cheap Trick$|^Cheat Codes$|^Cheech & Chong$|^Chelo$|^Cheo Feliciano$|^Cher$|^Cher Lloyd$|^Cherish$|^Cherrelle$|^Cheryl Lynn$|^Chet Atkins$|^Chet Baker$|^Chet Baker Quartet$|^Chet Faker$|^Chevelle$|^Chhota Gandharva$|^Chiang Yu-Heng$|^CHIC$|^Chicago$|^ChiChi Peralta$|^Chick Corea$|^Chico Buarque$|^Chico Hamilton$|^Chicos de Barrio$|^Chief Keef$|^Childish Gambino$|^Children Of Bodom$|^Chilliwack$|^China Anne McClain$|^China Crisis$|^Chingy$|^Chino & Nacho$|^Chiodos$|^Chitalkar$|^Chittoor V. Nagaiah$|^Chloe x Halle$|^Chocolate Milk$|^Choker$") == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.8 = ifelse(str_detect(main.artist, "^Choking Victim$|^Chorus$|^Chorus - Pocahontas$|^Chorus - Sleeping Beauty$|^Chris Botti$|^Chris Brown$|^Chris Cagle$|^Chris Cornell$|^Chris de Burgh$|^Chris G LeBon$|^Chris Isaak$|^Chris Janson$|^Chris Knight$|^Chris Lane$|^Chris LeDoux$|^Chris Montez$|^Chris Rea$|^Chris Renzema$|^Chris Rice$|^Chris Stapleton$|^Chris Tomlin$|^Chris Webby$|^Chris Young$|^Chrisette Michele$|^Christian Borle$|^Christian Death$|^Christian French$|^Christian Leave$|^Christian Nodal$|^Christina Aguilera$|^Christina Milian$|^Christina Perri$|^Christine DClario$|^Christine McVie$|^Christoph Willibald Gluck$|^Christopher Cross$|^Christopher Jackson$|^Christopher Lynch$|^Christopher Wilde$|^Christopher Williams$|^Chromatics$|^Chromeo$|^Chubby Checker$|^Chucho Avellanet$|^Chuck Berry$|^Chuck Mangione$|^Chuck Wicks$|^Chuck Willis$|^Chuy Lizarraga y Su Banda Tierra Sinaloense$|^CHVRCHES$|^Ciara$|^Cibo Matto$|^Cigarettes After Sex$|^Cinderella$|^Cindy Bullens$|^Circa Survive$|^Circle Jerks$|^Cisco Houston$|^Citizen$|^Citizen Cope$|^City and Colour$|^City Girls$|^CKY$|^Clairo$|^Clan of Xymox$|^Clannad$|^Clara Jaione con Orchestra Armando Fragna$|^Clarence Carter$|^Clarence Williams & His Washboard Band$|^Clarence Williams Blue Five$|^Clark Terry$|^Classics IV$|^Claude-Michel SchÃ¶nberg$|^Claude Barzotti$|^Claude Debussy$|^Claude King$|^Claude Thornhill & His Orchestra$|^Claudine Longet$|^Claudio Baglioni$|^Claudio Villa$|^Clay Walker$|^Clean Bandit$|^Cliff Edwards$|^Cliff Jordan$|^Cliff Richard$|^Clifford Brown$|^Climax Blues Band$|^Clint Black$|^Clint Mansell$|^Clipse$|^Cloud One$|^Club Nouveau$|^Cluster$|^Clutch$|^Coal Chamber$|^Coast Modern$|^Cobra Starship$|^Cock Robin$|^Cock Sparrer$|^Cocteau Twins$|^Cody Jinks$|^Cody Johnson$|^Coheed and Cambria$|^COIN$|^Colbie Caillat$|^Cold$|^Cold Chisel$|^Cold War Kids$|^Coldplay$|^Cole Porter$|^Cole Swindell$|^Coleman Hawkins$|^Coleman Hawkins Quartet$|^Colette$|^Colin Blunstone$|^Colin Hay$|^Collective Soul$|^Collie Buddz$|^Collin Raye$|^Colm Wilkinson$|^Colmillo NorteÃ±o$|^Colony House$|^Color Me Badd$|^Colt Ford$|^Colter Wall$|^Comethazine$|^Commander Cody and His Lost Planet Airmen$|^Commissioned$|^Commodores$|^Common$|^Common Kings$|^Comptons Most Wanted$|^Con Funk Shun$|^Conan Gray$|^Concrete Blonde$|^Confederate Railroad$|^Conjunto 31 de Octubre$|^Conjunto Atardecer$|^Conjunto Chaney$|^Conjunto Primavera$|^Conjunto Rio Grande$|^Connie Francis$|^Connie Smith$|^Conor Maynard$|^Conte Candoli$|^Control$|^Control Machete$|^convolk$|^Conway Twitty$|^Cookie & The Cupcakes$|^Coolio$|^Corb Lund$|^Cordae$|^Corey Hart$|^Corey Smith$|^Corinne Bailey Rae$|^CornÃ©lio Pires$|^Cornelia Otis Skinner$|^Cornelio Reyna$|^Cornershop$|^Coro Infantil Sinfonico$|^CORPSE$|^Corrosion Of Conformity$|^Cortex$|^Cortijo Y Su Combo$|^Cory Asbury$|^Cory Morrow$|^Cosculluela$|^Costumbre$|^Cotton Jones$|^Count Basie$|^Count Basie & His All American Rhythm Section$|^Count Basie Octet$|^Count Basies Kansas City Seven$|^Count Five$|^Counting Crows$|^Country Comfort$|^Country Joe & The Fish$|^Coven$|^Cowboy$|^Cowboy Junkies$|^Coyote Oldman$|^Cracker$|^Cradle Of Filth$|^Craig Campbell$|^Craig David$|^Craig Mack$|^Craig Morgan$|^Crash Test Dummies$|^Crass$|^Cream$|^Creature Feature$|^Creed$|^Creedence Clearwater Revival$|^Crime Mob$|^Cristian$|^Cristian Castro$|^Cristian Vasile$|^Crivel E Coro$|^Cro-Mags$") == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.9 = ifelse(str_detect(main.artist, "^Crosby$|^Cross Canadian Ragweed$|^Crossfade$|^Crowded House$|^Crowder$|^Crown The Empire$|^Crumb$|^Crvena Jabuka$|^Crystal Castles$|^Crystal Gayle$|^Crystal Waters$|^Cuco$|^Cuco SÃ¡nchez$|^Cultura ProfÃ©tica$|^Culture$|^Culture Beat$|^Culture Club$|^Current Joys$|^Cursive$|^Curtis Fuller$|^Curtis Fuller Quintet$|^Curtis Mayfield$|^Cute Is What We Aim For$|^Cutting Crew$|^CVBZ$|^Cy Coleman$|^Cymande$|^Cyndi Lauper$|^Cypress Hill$|^Cyril Ritchard$|^D-Train$|^D. Brubeck$|^D.Filipopoulos$|^D.I.$|^D.J. Rogers$|^D.O.A.$|^D.P. Korgaonkar$|^D.R.I.$|^D.roitman$|^D12$|^D4L$|^Da Brat$|^Da Vincis Notebook$|^DaBaby$|^Daddy Yankee$|^Daft Punk$|^Dag Nasty$|^Dagames$|^Dailey & Vincent$|^Dale Carnegie$|^Dalex$|^Dalida$|^Dalva De Oliveira$|^Damia$|^Damian Marley$|^Damien Rice$|^Damn Yankees$|^Dan \\+ Shay$|^Dan Auerbach$|^Dan Fogelberg$|^Dan Hartman$|^Dan Hicks & His Hot Licks$|^Dan Hill$|^Dan Sacks$|^Dan Seals$|^Danai Stratigopoulou$|^Dance Gavin Dance$|^DAngelo$|^Danger Danger$|^Danger Incorporated$|^DANGERDOOM$|^Dangerous Toys$|^Daniel Balavoine$|^Daniel Caesar$|^Daniel Caine Orchestra$|^Daniel Calveti$|^Daniel Johnston$|^Daniel Santos$|^Daniel Tigerâ€™s Neighborhood$|^Daniela Andrade$|^Daniela Romo$|^Danielle Bradbery$|^DaniLeigh$|^Danilo Montero$|^Danity Kane$|^Danja Mowf$|^Danna Paola$|^Danny Barker$|^Danny Berrios$|^Danny Brown$|^Danny Chan$|^Danny Elfman$|^Danny Gokey$|^Danny Kaye$|^Danny Ocean$|^Danny Rivera$|^Danny Wright$|^Danzig$|^Danzonera La Playa$|^Dario Marianelli$|^Darius Milhaud$|^Darius Rucker$|^Dark Angel$|^Darkthrone$|^Darlene Love$|^Darrell Scott$|^Darryl Worley$|^Darude$|^Daryl Braithwaite$|^Daryl Hall$|^Daryl Hall & John Oates$|^Daryle Singletary$|^Das EFX$|^Dashboard Confessional$|^Daughter$|^Daughtry$|^Dave Brubeck$|^Dave Dudley$|^Dave Edmunds$|^Dave Grusin$|^Dave Hollister$|^Dave Koz$|^Dave Mason$|^Dave Matthews$|^Dave Matthews Band$|^DAVE RODGERS$|^Dave Van Ronk$|^Dave Wong$|^David-Trio$|^David & David$|^David Allan Coe$|^David Axelrod$|^David Ball$|^David Banner$|^David Bauer$|^David Benoit$|^David Bowie$|^David Bowie & The Spiders From Mars$|^David Bromberg$|^David Byrne$|^David Cassidy$|^David Cook$|^David Crosby$|^David Crowder Band$|^David Foster$|^David Frizzell$|^David Gates$|^David Gilmour$|^David Gray$|^David Guetta$|^David Huntsinger$|^David Lanz$|^David Lee Garza$|^David Lee Murphy$|^David Lee Roth$|^David Nail$|^David Nevue$|^David Pabon$|^David Pomeranz$|^David Raskin$|^David Ruffin$|^David Sanborn$|^David Shire$|^David Tao$|^David Tomlinson$|^David Zaizar$|^Davy Graham$|^Dawes$|^Daya$|^Dayglow$|^Days Of The New$|^Dazz Band$|^DC Talk$|^DDG$|^De La Ghetto$|^Dead Boys$|^Dead Can Dance$|^Dead Kennedys$|^Dead Mans Bones$|^Dead Moon$|^Dead Or Alive$|^Dead Prez$|^deadmau5$|^DEAN$|^Dean Evenson$|^Dean Lewis$|^Dean Martin$|^Deana Carter$|^Death$|^Death Angel$|^Death Before Disco$|^Death Cab for Cutie$|^Death From Above 1979$|^Death Grips$|^Death In June$|^Debabrata Biswas$|^DeBarge$|^Debbie Deb$|^Debbie Gibson$|^Debbie Reynolds$") == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.10 = ifelse(str_detect(main.artist, "^Deborah Cox$|^Debra Laws$|^Decca Concert Orchestra$|^Declan McKenna$|^Dee Clark$|^Dee Dee Sharp$|^Deee-Lite$|^Deep Purple$|^Deep Sleep Music Collective$|^Deer Tick$|^Deerhunter$|^Def Leppard$|^Default$|^Deftones$|^Deicide$|^Deitrick Haddon$|^DeJ Loaf$|^Del Amitri$|^Del Shannon$|^Del The Funky Homosapien$|^Delaney & Bonnie$|^Delbert McClinton$|^Delegation$|^Della Reese$|^Deltron 3030$|^Dem Franchize Boyz$|^Demetri Martin$|^Demetrio Gonzalez$|^Demi Lovato$|^Demis Roussos$|^Deniece Williams$|^Denis Solee$|^Denise LaSalle$|^Dennis Brown$|^Dennis Day$|^Dennis Edwards$|^Dennis Wilson$|^Denzel Curry$|^Deodato$|^Deorro$|^Depeche Mode$|^Derek & The Dominos$|^Dermot Kennedy$|^Descendents$|^Desmond Dekker$|^Desree$|^Destinys Child$|^Destroyer$|^Deuter$|^Deutsche Grammophon Literatur$|^Devendra Banhart$|^Devika Rani$|^DevilDriver$|^Devin The Dude$|^DEVO$|^Dexter Gordon$|^Dexter Wansel$|^Dexys Midnight Runners$|^Dhananjay Bhattacharya$|^Dhirendrachandra Mitra$|^Dhirendranath Das$|^Diahann Carroll$|^Diamond Head$|^Diamond Rio$|^Diana Krall$|^Diana Ross$|^Diana Ross & The Supremes$|^Dick Dale and his Del-Tones$|^Dick Gaughan$|^Dick Haymes$|^Dick Jurgens & His Orchestra$|^Dick Justice$|^Dick Powell$|^Dick Van Dyke$|^Dickey Betts$|^Diddy$|^Diddy - Dirty Money$|^Dido$|^Die Antwoord$|^Diego Torres$|^Diego Verdaguer$|^Dierks Bentley$|^Digable Planets$|^Digital Underground$|^DilÃº Melo$|^Dilated Peoples$|^Dilip Kumar$|^Dilip Kumar Roy$|^Dillard & Clark$|^Dilshad Begum$|^Dimension Latina$|^Dimitra Ntourali$|^Dimitris Arapakis$|^Dimitris Filipopoulos$|^Dimitris Gkogkos$|^Dimitris Mitropanos$|^Dimitris Perdikopoulos$|^Dimmu Borgir$|^Dinah Shore$|^Dinah Washington$|^Dinendranath Tagore$|^Dinosaur Jr.$|^Dio$|^Diomedes Diaz$|^Dion$|^Dion & The Belmonts$|^Dionne Warwick$|^Diplo$|^Dire Straits$|^Dirty Heads$|^Discharge$|^Disclosure$|^Dishwalla$|^Dismemberment Plan$|^Disney Studio Chorus$|^Dispatch$|^Disturbed$|^Divine$|^Divinyls$|^Dizzy Gillespie$|^Dizzy Gillespie Sextet$|^DJ Clue$|^DJ Drama$|^DJ Felli Fel$|^DJ Jazzy Jeff & The Fresh Prince$|^DJ Khaled$|^Dj Laz$|^DJ Magic Mike$|^DJ Quik$|^DJ Screw$|^DJ Shadow$|^DJ Snake$|^Djalma Ferreira$|^Django Reinhardt$|^Djavan$|^Djivan Gasparyan$|^DLG$|^Dmitri Shostakovich$|^Dmitry Kabalevsky$|^DMX$|^DNCE$|^Do Or Die$|^Dobie Gray$|^Doc & Merle Watson$|^Doc Watson$|^Dock Boggs$|^Dock Reed$|^dodie$|^Doja Cat$|^Dokken$|^Dolly Parton$|^Dom David$|^Dom Kennedy$|^Domenico Modugno$|^Domenico Scarlatti$|^Dominic Fike$|^Don Carlos$|^Don Cherry$|^Don Covay$|^Don Gibson$|^Don Henley$|^Don Hinson & The Rigamorticians$|^Don Ho$|^Don McLean$|^Don Moen$|^Don Omar$|^Don Ralke$|^Don Shirley$|^Don Toliver$|^Don Williams$|^Donald Byrd$|^Donald Fagen$|^Donavon Frankenreiter$|^Donell Jones$|^Donna Summer$|^Donnie & Joe Emerson$|^Donnie McClurkin$|^Donny Hathaway$|^Donny Osmond$|^Donovan$|^Doobie$|^Dooley Wilson$|^Dope$|^Dora The Explorer$|^Doris Day$|^Dorothy Ashby$|^Dorrough Music$|^Dottie West$|^Doug Stone$|^Doug Supernaw$|^Dougie MacLean$|^Dove Cameron$|^Doves$|^DOWN$|^Dr. Alban$|^Dr. Buzzards Original Savannah Band$|^Dr. Dog$|^Dr. Dre$|^Dr. Hook$|^Dr. John$") == T, TRUE,
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.11 = ifelse(str_detect(main.artist, "^Dr. Lonnie Smith$|^Dr. Octagon$|^Dr. Samuel J. Hoffman$|^Dr. Seuss$|^DrÃ©an$|^DragonForce$|^Drake$|^Drakeo the Ruler$|^Dranem$|^Dread Mar I$|^Dream$|^Dream Theater$|^DREAMERS$|^DREAMS COME TRUE$|^Dreamville$|^Drew Holcomb & The Neighbors$|^Drive-By Truckers$|^Drivin N Cryin$|^Drop Nineteens$|^Dropkick Murphys$|^Drowning Pool$|^Dru Down$|^Dru Hill$|^Dua Lipa$|^Duane Allman$|^Duane Eddy$|^Duckwrth$|^Duelo$|^Dueto America$|^Duke Ellington$|^Duke Ellington Orchestra$|^Duke Jordan$|^Duke of Iron$|^Duncan Dhu$|^Duncan Sheik$|^Duran Duran$|^Duster$|^Dustin Lynch$|^Dustin OHalloran$|^Dusty Springfield$|^DVBBS$|^dvsn$|^Dwarves$|^Dwele$|^Dwight Yoakam$|^Dwijen Mukherjee$|^Dyango$|^DYING SPASM$|^Dylan Scott$|^Dynasty$|^E-40$|^E.E. Cummings$|^E.Y. Harburg$|^Eagles$|^Eagles Of Death Metal$|^Earl Hines$|^Earl Hines & His Orchestra$|^Earl Hooker$|^Earl Klugh$|^Earl Scruggs$|^Earl Sweatshirt$|^Earl Thomas Conley$|^Earle Hagen$|^Earth$|^Eartha Kitt$|^EARTHGANG$|^Eason Chan$|^Easton Corbin$|^Eazy-E$|^Ebi$|^Ebo Taylor$|^Echo & the Bunnymen$|^Ed Ames$|^Ed Ivory$|^Ed Sheeran$|^Ed Sullivan$|^Eddie Cochran$|^Eddie Condon$|^Eddie Dee$|^Eddie Fisher$|^Eddie Floyd$|^Eddie Gonzalez$|^Eddie Harris$|^Eddie Hazel$|^Eddie Heywood$|^Eddie Holman$|^Eddie Kendricks$|^Eddie Money$|^Eddie Murphy$|^Eddie Palmieri$|^Eddie Rabbitt$|^Eddie Santiago$|^Eddie Vedder$|^Eddy Arnold$|^Eddy Herrera$|^Eddy Mitchell$|^Eddy Raven$|^EDEN$|^Eden Ahbez$|^Eden James$|^Edgar Allan Poe$|^Edgar Winter$|^Edie Brickell & New Bohemians$|^Edison Lighthouse$|^Edith MÃ¡rquez$|^Edna St. Vincent Millay$|^Edoardo Vianello$|^Edu Da Gaita$|^Eduardo di Capua$|^Edvard Grieg$|^Edward Elgar$|^Edward Maya$|^Edward Sharpe & The Magnetic Zeros$|^Edwin Luna y La Trakalosa de Monterrey$|^Edwin McCain$|^Edwin Starr$|^Eek-A-Mouse$|^Eels$|^eevee$|^Egypt Central$|^Eiffel 65$|^Ekolu$|^El As De La Sierra$|^El Chapo De Sinaloa$|^El Chaval$|^El Chicano$|^El Combo De Las Estrellas$|^El Coyote Y Su Banda Tierra Santa$|^El DeBarge$|^El Fantasma$|^El GÃ¼ero y Su Banda Centenario$|^El General$|^El Gran Combo De Puerto Rico$|^El Gran Silencio$|^El Halcon De La Sierra$|^El Komander$|^El Palomo Y El Gorrion$|^El Piporro$|^El Poder Del Norte$|^El Potro De Sinaloa$|^El Tiempo$|^El Tigrillo Palma$|^El Tri$|^El Trono de Mexico$|^ElÃ©ni LiÃ¡pi$|^ElÃ® Merdan$|^Electric Guest$|^Electric Light Orchestra$|^Elefante$|^Elephant Man$|^Elevation Worship$|^Eli Young Band$|^eli.$|^Elia y Elizabeth$|^Elijah Kelley$|^Elijah Who$|^Elis Regina$|^Elizabeth Bishop$|^Elizabeth Cotten$|^Elizabeth Mitchell$|^Ella Fitzgerald$|^Ella Henderson$|^Ella Logan$|^Ella Mai$|^Elle King$|^Ellen Gottschalch$|^Ellie Goulding$|^Elliott Smith$|^Elmer Bernstein$|^Elmer Bernstein conducting The United Artists Studio Orch.$|^Elmo & Patsy$|^Elmore James$|^Elsie Houston$|^Elton John$|^Elvin Bishop$|^Elvis Costello$|^Elvis Costello & The Attractions$|^Elvis Crespo$|^Elvis Martinez$|^Elvis Presley$|^Emancipator$|^Emeli SandÃ©$|^Emerson$|^Emile Pandolfi$|^Emilie-Claire Barlow$|^Emilio Navaira$|^Eminem$|^Emma Liebel$|^Emmanuel$|^Emmanuel Chabrier$|^Emmylou Harris$|^Empire of the Sun$|^En EspÃ­ritu Y En Verdad$|^En Vogue$|^Enaid$|^Enchantment$|^Engelbert Humperdinck$|^England Dan & John Ford Coley$|^English Chamber Orchestra$|^Enigma$") == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.12 = ifelse(str_detect(main.artist, "^Ennio Morricone$|^Enrico Macias$|^Enrique Granados$|^Enrique Guzman$|^Enrique Iglesias$|^Ensemble - The Lion King$|^Entombed$|^Environments$|^Enya$|^EOR$|^EPMD$|^ERA$|^Eraserheads$|^Erasmo Carlos$|^Erasure$|^Eric B. & Rakim$|^Eric Bellinger$|^Eric BenÃ©t$|^Eric Burdon$|^Eric Burdon & the Animals$|^Eric Carmen$|^Eric Church$|^Eric Clapton$|^Eric Darius$|^Eric Dolphy$|^Eric Johnson$|^Eric Prydz$|^Eric Weissberg$|^Erich Wolfgang Korngold$|^Erick Sermon$|^Erik Eriksson$|^Erik Satie$|^Ermanno Wolf-Ferrari$|^Ernest Bloch$|^Ernest Chausson$|^Ernest Gold$|^Ernest Hemingway$|^Ernest Ranglin$|^Ernest Tubb$|^Ernestine Anderson$|^Ernie$|^Ernst H. Gombrich$|^Eros Ramazzotti$|^Erroll Garner$|^Erykah Badu$|^Escape the Fate$|^Eslabon Armado$|^Esperanza de Vida$|^Esperanza Spalding$|^Espinoza Paz$|^Esquivel!$|^Esteban Gabriel$|^Esther Phillips$|^Ethel Merman$|^Ethel Waters$|^Etta James$|^Etta Jones$|^Euge Groove$|^Eugen Mirea$|^Eugene McDaniels$|^Europe$|^Eurythmics$|^Eva Cassidy$|^Evadne Baker$|^Evan Rachel Wood$|^Evanescence$|^Evans Blue$|^Eve$|^Eve 6$|^Evelyn Champagne King$|^Everclear$|^EVERGLOW$|^Everlast$|^Every Time I Die$|^Everything But The Girl$|^Ewan MacColl$|^Excision$|^Exile$|^EXO$|^Exodus$|^Explosions In The Sky$|^ExposÃ©$|^Extreme$|^Exuma$|^Eydie GormÃ©$|^Ezequiel PeÃ±a$|^Ezra Pound$|^F. J. McMahon$|^FÃ©lix Mayol$|^Fabolous$|^Fabre Duroseau$|^Fabrizio De AndrÃ©$|^Face To Face$|^Faces$|^Fad Gadget$|^Failure$|^Fairport Convention$|^Fairuz$|^Faith Evans$|^Faith Hill$|^Faith No More$|^Falange EspaÃ±ola$|^Falco$|^Fall Out Boy$|^Falling In Reverse$|^Famous Dex$|^Fan Sounds$|^Fania All Stars$|^Fantasia$|^Faouzia$|^Far East Movement$|^Farid al-Atrash$|^Faron Young$|^Farruko$|^Fastball$|^Faster Pussycat$|^Fastway$|^Fat Boys$|^Fat Joe$|^Fat Pat$|^Fatback Band$|^Fatboibari$|^Fatboy Slim$|^Father John Misty$|^Fats Domino$|^Fats Navarro$|^Fats Waller$|^Faye Wong$|^Fear$|^Fear Factory$|^Federico GarcÃ­a Lorca$|^Federico Moreno Torroba$|^Feist$|^Fela Kuti$|^Felipe Arriaga$|^Felipe V. Rivera$|^Felix Mendelssohn$|^Felt$|^Fenton Robinson$|^Ferde GrofÃ©$|^Fergie$|^Fern Kinney$|^Fernando Ortega$|^Fernando Sor$|^Fernando Villalona$|^Ferrante & Teicher$|^Fess Parker$|^Fetty Wap$|^Fey$|^Fida Hussain$|^Fidel Rueda$|^FIDLAR$|^Fields Of The Nephilim$|^Fifth Harmony$|^Filter$|^Finch$|^Fine Young Cannibals$|^Finger Eleven$|^FINNEAS$|^Fiona Apple$|^Firefall$|^Firehouse$|^Firehouse Five Plus Two$|^First Aid Kit$|^Fishbone$|^Fishmans$|^Fito Olivares y Su Grupo$|^Fito Paez$|^Fitz and The Tantrums$|^Five$|^Five Finger Death Punch$|^Five For Fighting$|^FKJ$|^Flamin Groovies$|^Flans$|^Flash Ki$|^Flatland Cavalry$|^Flatsound$|^Flatt & Scruggs$|^Flaw$|^Fleet Foxes$|^Fleetwood Mac$|^FLETCHER$|^Fletcher Henderson & His Orchestra$|^Flex$|^Flight Facilities$|^Flip Phillips$|^Flipp Dinero$|^Flipper$|^Flo Milli$|^Flo Rida$|^Flo Sandons$|^Floetry$|^Flogging Molly$|^Flor Silvestre$|^Florence \\+ The Machine$|^Florida Georgia Line$|^Floros Floridis$|^Flovry$|^FLOW$") == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.13 = ifelse(str_detect(main.artist, "^Floyd Cramer$|^Flume$|^Flux Pavilion$|^Flying Lotus$|^Flyleaf$|^FM Static$|^Foals$|^Fobia$|^Focus$|^Foghat$|^Fonseca$|^Fontella Bass$|^Foo Fighters$|^for KING & COUNTRY$|^Force M.D.s$|^Foreigner$|^Forever The Sickest Kids$|^Forrest.$|^Fort Minor$|^FortugÃ©$|^Foster The People$|^Fotis Polimeris$|^Fountains Of Wayne$|^Four Tops$|^Four Year Strong$|^Fourplay$|^Foxy Brown$|^Fra Lippo Lippi$|^FrÃ©dÃ©ric Chopin$|^FrÃ©hel$|^FranÃ§ois Mauriac$|^FranÃ§oise Hardy$|^France Gall$|^France Joli$|^Frances Archer$|^Frances Ruffelle$|^Frances Yip$|^Francesc Macia$|^Francesca Battistelli$|^Francesco Cilea$|^Francesco De Gregori$|^Francesco De Masi$|^Francesco Paolo Tosti$|^Francis Cabrel$|^Francis Lai$|^Francis Poulenc$|^Francisco Canaro$|^Francisco Canaro Jazz Band$|^Francisco Charro Avitia$|^Francisco Ernani Braga$|^Francisco TÃ¡rrega$|^Franck Pourcel$|^Franco Battiato$|^Franco De Vita$|^Francois Campion$|^Frank Black$|^Frank Campbell Milne$|^Frank Chacksfield & His Orchestra$|^Frank Loesser$|^Frank Morgan$|^Frank Ocean$|^Frank Proffitt$|^Frank Reyes$|^Frank Sinatra$|^Frank Stallone$|^Frank Wedekind$|^Frank Zappa$|^Frankie Avalon$|^Frankie Ballard$|^Frankie Goes To Hollywood$|^Frankie J$|^Frankie Laine$|^Frankie Lymon$|^Frankie Miller$|^Frankie Ruiz$|^Frankie Smith$|^Frankie Trumbauer & His Orchestra$|^Frankie Valli$|^Frankie Valli & The Four Seasons$|^Frankie Yankovic$|^Frankie Yankovic & His Yanks$|^Frantz Casseus$|^Franz Allers$|^Franz Ferdinand$|^Franz Joseph Haydn$|^Franz LehÃ¡r$|^Franz Liszt$|^Franz Schubert$|^Franz von SuppÃ©$|^Franz Waxman$|^Franz Xaver Gruber$|^Fred Astaire$|^Fred Bird Rythmicans$|^Fred Bongusto$|^Fred Buscaglione$|^Fred Gouin$|^Fred Hammond$|^Fred Mollin$|^Fred Neil$|^Fred von Hoerschelmann$|^Fred Waring$|^Fred Waring & The Pennsylvanians$|^Freddie Dredd$|^Freddie Gibbs$|^Freddie Hubbard$|^Freddie Jackson$|^Freddie King$|^Freddie McGregor$|^Freddie Mercury$|^Freddy Fender$|^Freddy Quinn$|^Frederick Delius$|^Frederick Loewe$|^Free$|^Free Nationals$|^Freemulitas Groove$|^Freestyle$|^Freeway$|^French Montana$|^Frente Popular$|^Friedrich Gulda$|^Friedrich Schiller$|^Friedrich von Flotow$|^Friedrich Wilhelm Nietzsche$|^Frightened Rabbit$|^Fritz Kreisler$|^Front Porch Step$|^Frou Frou$|^Fruko Y Sus Tesos$|^Fuel$|^Fuerza Regida$|^Fugazi$|^Fugees$|^Fulanito$|^Fun Boy Three$|^fun\\.$|^Funkadelic$|^Funkdoobiest$|^Funkmaster Flex$|^Furyan$|^Future$|^Future Islands$|^Future Rapper$|^Futuristic$|^G-DRAGON$|^G-Eazy$|^G-Unit$|^G Herbo$|^G. I. Gurdjieff$|^G. Love & Special Sauce$|^G. M. Durrani$|^G. Siroto$|^G.Q.$|^GÃ¡bor SzabÃ³$|^Gabby Barrett$|^Gabby Pahinui$|^Gabriel FaurÃ©$|^Gabrielle Aplin$|^Gaby Montbreuse$|^Gaelic Storm$|^Gaetano Donizetti$|^Gaiteros de Pillopo$|^Gal Costa$|^Galactic$|^Galantis$|^Galaxie 500$|^Gale Garnett$|^Galt MacDermot$|^Galy Galiano$|^Gang Green$|^Gang Of Four$|^Gang Starr$|^Gangsta Pat$|^Garbage$|^Garland Jeffreys$|^Garnet Clark$|^Garnet Mimms & The Enchanters$|^Garnett Silk$|^Garth Stevenson$|^Gary Allan$|^Gary Burton$|^Gary Clark Jr.$|^Gary Hobbs$|^Gary Lewis & The Playboys$|^Gary Moore$|^Gary Numan$|^Gary Puckett & The Union Gap$|^Gary Stewart$|^Gary Valenciano$|^Gary Wilson$|^Gary Wright$|^Gaston Bachelard$|^Gaston Gabaroche$|^Gato Barbieri$|^Gauhar Sultana$|^Gavin DeGraw$|^GebrÃ¼der Grimm$|^Geeta Dutt$|^Geeta Sen Naha$|^Gene Ammons$") == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.14 = ifelse(str_detect(main.artist, "^Gene Autry$|^Gene Chandler$|^Gene Clark$|^Gene Kelly$|^Gene Krupa$|^Gene Krupa Big Band$|^Gene McDaniels$|^Gene Pitney$|^Gene Vincent$|^Gene Vincent & His Blue Caps$|^Gene Watson$|^Generacion De Jesus$|^Generation X$|^Generationals$|^Genesis$|^Gentle Giant$|^Geo Da Silva$|^Geoffrey Oryema$|^Georg Kaiser$|^Georg Philipp Telemann$|^George Baker Selection$|^George Balanchines The Nutcracker$|^George Benson$|^George Beverly Shea$|^George Bruns$|^George Butterworth$|^George Carlin$|^George Clinton$|^George Duke$|^George Duning$|^George Edvadovich Conus$|^George Enescu$|^George Ezra$|^George Frideric Handel$|^George Gershwin$|^George Hamilton IV$|^George Harrison$|^George Howard$|^George Jones$|^George Lam$|^George Lamond$|^George Lewis$|^George Martin$|^George McCrae$|^George Melachrino and his Orchestra$|^George Michael$|^George Olsen$|^George Shearing$|^George Shearing Quintet$|^George Strait$|^George Thorogood & The Destroyers$|^George Winston$|^Georges Auric$|^Georges Bizet$|^Georges Brassens$|^Georges Delerue$|^Georges GuÃ©tary$|^Georges Milton$|^Georges Thill$|^Georges Van Parys$|^Georgette Heyer$|^Georgia Mitaki$|^Georgia Mittaki$|^Georgie Fame$|^Georgie Fame & The Blue Flames$|^Georgius$|^Geraint Jones$|^Gerald Albright$|^Gerald Levert$|^Gerardo Ortiz$|^Gerardo Reyes$|^Gerry & The Pacemakers$|^Gerry Mulligan$|^Gerry Mulligan Band$|^Gerry Mulligan Quartet$|^Gerry Mulligan Sextet$|^Gerry Rafferty$|^Gertrude Stein$|^Gesaffelstein$|^Get Scared$|^Geto Boys$|^GG Allin$|^Ghantasala$|^Ghost$|^Ghostemane$|^Ghostface Killah$|^Ghulam Haider$|^Giacomo Puccini$|^Giacomo Rondinella$|^gianni & kyle$|^Giannis Verras$|^Giasemi$|^Gigi$|^Gigi DAgostino$|^Gigi Gryce$|^Gigi Gryce - Clifford Brown Sextet$|^Gigi Gryce & His Orchestra$|^Gigi Masin$|^Gil Evans$|^Gil Melle$|^Gil Scott-Heron$|^Gilbert BÃ©caud$|^Gilbert OSullivan$|^Gilberto Gil$|^Gilberto Monroig$|^Gilberto Santa Rosa$|^Gillian Welch$|^Gin Blossoms$|^Gino Bechi$|^Gino Vannelli$|^Ginuwine$|^Gioachino Rossini$|^Gion$|^Giorgio Consolini$|^Giorgio Moroder$|^Giorgos Kavouras$|^Giorgos Mitsakis$|^Giorgos Mpatis$|^Giorgos Nakos$|^Giorgos Papasideris$|^Giota Xalkia$|^Gipsy Kings$|^girl in red$|^Girl Talk$|^Girls Generation$|^Girlschool$|^Gisela Prugel$|^GIT$|^Giuseppe Verdi$|^Giveon$|^Gladys Knight$|^Gladys Knight & The Pips$|^Glass Animals$|^Glass Tiger$|^Glee Cast$|^Glen Campbell$|^Glenn Frey$|^Glenn Gould$|^Glenn Jones$|^Glenn Medeiros$|^Glenn Miller$|^Glenn Yarbrough$|^Gloria Estefan$|^Gloria Gaynor$|^Gloria Lynne$|^Gloria Trevi$|^Gloriana$|^Glynis Johns$|^Gnarls Barkley$|^gnash$|^Go West$|^Gobinda Gopal Mukherjee$|^god$|^Gods Property$|^Godsmack$|^Godspeed You\\! Black Emperor$|^Gojira$|^Golden Earring$|^Golden Smog$|^Goldfinger$|^Goldfrapp$|^GoldLink$|^Gondwana$|^Gong$|^Good Charlotte$|^Goodie Mob$|^Gordon Lightfoot$|^Gorilla Biscuits$|^Gorilla Zoe$|^Gorillaz$|^GOT7$|^Gotan Project$|^Gottfried von Einem$|^Gotye$|^Gouri Kedar Bhattacharya$|^Govi$|^Govindrao Tembe$|^Govt Mule$|^Gowan$|^Grace Chang$|^Grace Jones$|^Grace Potter & The Nocturnals$|^Graham Central Station$|^Graham Nash$|^Gram Parsons$|^Gramatik$|^Gramophone Club$|^Grand Funk Railroad$|^Grand Puba$|^Grandaddy$|^Grandmaster Flash & The Furious Five$|^Grandpa Jones$|^grandson$|^Granger Smith$|^Grant Green$|^Granular$|^Grateful Dead$|^Gravediggaz$|^Great Big Sea$|^Great White$") == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.15 = ifelse(str_detect(main.artist, "^Green Day$|^Greensky Bluegrass$|^Greg Brown$|^Gregg Allman$|^Gregorian Chant$|^Gregory Alan Isakov$|^Gregory Isaacs$|^Greta Van Fleet$|^Gretchen Wilson$|^Greyboy$|^Grigoras Dinicu$|^Grigoris Asikis$|^Grimes$|^GRiZ$|^Grizzly Bear$|^Groove Armada$|^Grouplove$|^Grover Washington$|^Grupo Alfa 7$|^Grupo Bryndis$|^Grupo CaÃ±averal De Humberto PabÃ³n$|^Grupo Exterminador$|^Grupo Firme$|^Grupo GalÃ©$|^Grupo Kual?$|^Grupo La Migra$|^Grupo Laberinto$|^Grupo Ladron$|^Grupo Libra$|^Grupo Limite$|^Grupo Mandingo$|^Grupo Mania$|^Grupo Miramar$|^Grupo Modelo$|^Grupo Mojado$|^Grupo Niche$|^Grupo Pegasso$|^Grupo Romance$|^Grupo Samuray$|^Grupo Sonador$|^Grupo Tentacion$|^Grupo Toppaz$|^Grupo Toppaz De Reynaldo Flores$|^Grupo Vennus$|^Grupo Zaaz de Victor Hugo Ruiz$|^Gryffin$|^Guaco$|^Guandulito$|^Guardianes Del Amor$|^GuayacÃ¡n Orquesta$|^Gucci Mane$|^guccihighwaters$|^Guided By Voices$|^Guillermo Butikofer$|^Guillermo Gomez$|^Gunna$|^Guns N Roses$|^Guru$|^Gus Dapperton$|^Gustav Holst$|^Gustav Mahler$|^Gustavo Cerati$|^Gustavo Santaolalla$|^Guster$|^Guttermouth$|^Guy$|^Guy Clark$|^Guy Lombardo$|^Guy Lombardo & His Royal Canadians$|^Guy Mitchell$|^Gwar$|^Gwen Guthrie$|^Gwen Stefani$|^Gwen Verdon$|^Gwendolyn Brooks$|^Gyanendra Prasad Goswami$|^Gym Class Heroes$|^Gyptian$|^GZA$|^H-Town$|^H Khan Mastana$|^H.E.R.$|^H.P. Lovecraft$|^Ha*Ash$|^HÃ«ctor Montemayor$|^HÃ©ctor Acosta El Torito$|^HÃ©ctor El Father$|^HÃ©ctor Lavoe$|^HÃ¼nkar$|^HÃ¼sker DÃ¼$|^Hacken Lee$|^Haddaway$|^Hailee Steinfeld$|^HAIM$|^Haircut 100$|^Hal Ketchum$|^Halestorm$|^halfâ€¢alive$|^Halsey$|^Hameeda Bano$|^Hamiyet YÃ¼ceses$|^Hampton Hawes$|^Hampton Hawes Trio$|^Handsome Boy Modeling School$|^Hank Jones$|^Hank Locklin$|^Hank Mobley$|^Hank Mobley Quartet$|^Hank Snow$|^Hank Thompson$|^Hank Williams$|^Hank Williams III$|^Hannah Montana$|^Hanoi Rocks$|^Hans Christian Lumbye$|^Hans J. Salter$|^Hans Pfitzner$|^Hans Zimmer$|^Hanson$|^Hap Palmer$|^Hapa$|^Happy Mondays$|^Hardline$|^HARDY$|^Hariharan$|^Harimati$|^Hariprasad Chaurasia$|^Harish Bhardwaj$|^Harishchandra Bali$|^Harlequin$|^Harmonium$|^Harold Arlen$|^Harold Budd$|^Harold Courlander$|^Harold Faltermeyer$|^Harold Melvin & The Blue Notes$|^Harpers Bizarre$|^Harry Belafonte$|^Harry Chapin$|^Harry Connick$|^Harry Curtis$|^Harry Gold & His Pieces Of Eight$|^Harry Gregson-Williams$|^Harry James$|^Harry McClintock$|^Harry Nilsson$|^Harry Simeone Chorale$|^Harry Styles$|^Harry Sweets Edison$|^Haruomi Hosono$|^Hatebreed$|^Have A Nice Life$|^Hawaiian Style Band$|^Hawkwind$|^Hawthorne Heights$|^Hayes Carll$|^Hayley Mills$|^Haystak$|^Hazel Scott$|^He Is We$|^Head East$|^Heart$|^Heather Headley$|^Heatmiser$|^Heatwave$|^Heaven 17$|^Heavy D & The Boyz$|^Hector & Tito$|^Hector Berlioz$|^Heitor dos Prazeres$|^Heitor Villa-Lobos$|^Helen Forrest$|^Helen Gallagher$|^Helen Jane Long$|^Helen Merrill$|^Helen Reddy$|^Helix$|^Hellogoodbye$|^Helloween$|^HELLYEAH$|^Helmet$|^Hemant Kumar$|^Henri Garat$|^Henri Texier$|^Henri Vieuxtemps$|^Henry Calvin$|^Henry Fiol$|^Henry Hall$|^Henry Mancini$|^Henry Purcell$|^Henryk Wieniawski$|^Herb Alpert$|^Herb Alpert & The Tijuana Brass$|^Herb Ellis$|^Herb Geller$|^Herbie Hancock$|^Herbie Mann$|^Herencia de Patrones$|^Hermanas Lima$|^Hermanos Carrion$") == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.16 = ifelse(str_detect(main.artist, "^Hermans Hermits$|^Hermes Nye$|^Hermitude$|^Hernaldo Zuniga$|^Heroes Del Silencio$|^Hers$|^Hesen ZÃ®rek$|^Hey Violet$|^Hezekiah Walker$|^Hi-C$|^Hi-Five$|^Hieroglyphics$|^High School Musical Cast$|^High Valley$|^Highly Suspect$|^Highway 101$|^Hikaru Utada$|^Hilary Duff$|^Hillel and Aviva$|^Hillsong UNITED$|^Hillsong Worship$|^HIM$|^Himangshu Dutta$|^Hinder$|^Hippie Sabotage$|^Hippo Campus$|^Hirabai Barodekar$|^Hiroshima$|^Hiroyuki Sawano$|^Hlias Litos-Klarino$|^HNNY$|^Hoagy Carmichael$|^Hoagy Carmichael & His Orchestra$|^Hobo Johnson$|^Hoku$|^Hole$|^Hollywood Undead$|^Hombres G$|^Home$|^Honeymoon Suite$|^HonorÃ© de Balzac$|^Hoobastank$|^Hoodie Allen$|^Hoodoo Gurus$|^Hootie & The Blowfish$|^Hopsin$|^Horace Parlan$|^Horace Silver$|^Horace Silver Quintet$|^Hot Chelle Rae$|^Hot Chip$|^Hot Chocolate$|^Hot Lips Page$|^Hot Rize$|^Hot Tuna$|^Hot Water Music$|^Hotdog$|^Hothouse Flowers$|^Hound Dog Taylor$|^Houndmouth$|^House Of Pain$|^Howard Ferguson$|^Howard Hewett$|^Howard Jones$|^Howard Keel$|^Howard McGhee$|^Howard Roberts$|^Howard Shelly$|^Howard Shore$|^Howie Day$|^Howlin Wolf$|^Hozier$|^Hubert Fol$|^Huevito Rey$|^Huey$|^Huey Lewis & The News$|^Huey Piano Smith$|^Hugh Jackman$|^Hugh Mundell$|^Hugh Tracey$|^Hugo Friedhofer$|^Hugo Montenegro$|^Hugo von Hofmannsthal$|^Hugo Wolf$|^Hui Ohana$|^Hum$|^Humble Pie$|^Huncho Jack$|^HUNNY$|^Hunter Hayes$|^Hurricane Chris$|^Hurt$|^Husn Banu$|^I DONT KNOW HOW BUT THEY FOUND ME$|^I Prevail$|^I See Stars$|^Iamjakehill$|^Ian & Sylvia$|^Ian Dury$|^Ian Hunter$|^Ian Tyson$|^iann dior$|^Ibrahim Ã–zgÃ¼r$|^Ibrahim Ferrer$|^IC3PEAK$|^Ice-T$|^Ice Cube$|^Ice Nine Kills$|^ICEHOUSE$|^Icon For Hire$|^Icona Pop$|^Idealism$|^Idina Menzel$|^Idris Muhammad$|^Iggy Azalea$|^Iggy Pop$|^Ignacio Corsini$|^Igor Stravinsky$|^Ike & Tina Turner$|^Ike Quebec$|^Ike Turner & The Kings Of Rhythm$|^Ikimonogakari$|^Il Divo$|^Ila Ghosh$|^Ila Mitra Ghosh$|^Ilegales$|^Ilene Woods$|^ILLENIUM$|^Illinois Jacquet$|^ilyTOMMY$|^Imagine Dragons$|^Immature$|^Immortal Technique$|^Imogen Heap$|^ImpÃ©rio Pedreirense$|^Impacto De Montemorelos$|^Imran Khan$|^In Flames$|^In The Heights Original Broadway Company$|^In This Moment$|^Incognito$|^Incubus$|^India.Arie$|^Indigo Girls$|^Indrabadan Bhatt$|^Indrani$|^Indu.$|^Indubala$|^Indubala Devi$|^Industria del Amor$|^Information Society$|^Ingrid Michaelson$|^Ingrid Rosario$|^Ini Kamoze$|^Inner Life$|^INOJ$|^Insane Clown Posse$|^Inspector$|^InspiraciÃ²n$|^Internet Money$|^Interpol$|^Intocable$|^Intro$|^Invisible$|^INXS$|^Ioanna Georgakopoulou$|^Ioannis Panagiotopoulos$|^Ioannis Xristou$|^Iqbal Bibi$|^Iration$|^Irene Cara$|^Iris DeMent$|^Irma Serrano$|^Irma Thomas$|^Iron & Wine$|^Iron Butterfly$|^Iron Maiden$|^Irving Berlin$|^Irwin Kostal$|^Isaac AlbÃ©niz$|^Isaac Hayes$|^Isabel Pantoja$|^Isaiah Rashad$|^Isaura Garcia$|^Ishwarlal$|^Ismael Miranda$|^Ismael Rivera$|^Ismael Rivera Y Sus Cachimbos$|^Israel Kamakawiwoole$|^Israel Vibration$|^Issa Ibrahim$|^Issachar Miron$|^ITZY$|^IU$|^IvÃ¡n RolÃ³n$|^Ivy Queen$|^Iwan A. Krylow$|^Iyaz$|^ÎŸrquesta Maestro Torroba$|^j-hope$") == T, TRUE,
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.17 = ifelse(str_detect(main.artist, "^Jerry Butler$|^Jerry Byrd$|^Jerry Clower$|^Jerry Garcia$|^Jerry Garcia Band$|^Jerry Goldsmith$|^Jerry Herman$|^Jerry Jeff Walker$|^Jerry Lee Lewis$|^Jerry Lewis$|^Jerry Mengo$|^Jerry Murads Harmonicats$|^Jerry Reed$|^Jerry Rivera$|^Jerry Vale$|^Jerry Wallace$|^Jeru The Damaja$|^JesÃºs AdriÃ¡n Romero$|^Jess Glynne$|^Jesse & Joy$|^Jesse Cook$|^Jesse Johnson$|^Jesse McCartney$|^Jesse Pearson$|^Jessi Colter$|^Jessica Keenan Wynn$|^Jessica Simpson$|^Jessie J$|^Jessie Reyez$|^Jesus Culture$|^Jet$|^Jethro Tull$|^Jewel$|^JFA$|^Jhay Cortez$|^JhenÃ© Aiko$|^JID$|^Jikki$|^Jill Scott$|^Jim & Jesse$|^Jim and Jesse and the Virginia Boys$|^Jim Brickman$|^Jim Croce$|^Jim Cummings$|^Jim Ed Brown$|^Jim Ford$|^Jim Hall$|^Jim Jones$|^Jim Morrison$|^Jim Nabors$|^Jim Reeves$|^Jim Stafford$|^Jim Sturgess$|^Jimi Hendrix$|^Jimmie Allen$|^Jimmie Lunceford$|^Jimmie Lunceford & His Orchestra$|^Jimmie Rodgers$|^Jimmie Thompson$|^Jimmie Vaughan$|^Jimmies Chicken Shack$|^Jimmy Bryant$|^Jimmy Buffett$|^Jimmy Cliff$|^Jimmy Dean$|^Jimmy Dorsey & His Orchestra$|^Jimmy Durante$|^Jimmy Eat World$|^Jimmy Giuffre$|^Jimmy Heath$|^Jimmy Knepper Quintet$|^Jimmy McGriff$|^Jimmy Raney$|^Jimmy Reed$|^Jimmy Ruffin$|^Jimmy Smith$|^Jimmy Witherspoon$|^Jimmy Yancey$|^Jinsang$|^JJ Grey & Mofro$|^JJ Heller$|^JJ Lin$|^Jnan Dutt$|^Jo Dee Messina$|^Jo Stafford$|^JoÃ£o Donato$|^JoÃ£o Gilberto$|^Joan Armatrading$|^Joan Baez$|^Joan Ellison$|^Joan Jett & The Blackhearts$|^Joan Manuel Serrat$|^Joan Roberts$|^Joan Sebastian$|^Joanie Sommers$|^JoaquÃ­n Rodrigo$|^JoaquÃ­n Sabina$|^JoaquÃ­n Turina$|^Joaquin Phoenix$|^Jodeci$|^Jodi Benson$|^Jody Watley$|^Joe$|^Joe Bataan$|^Joe Bonamassa$|^Joe Bushkin$|^Joe Bushkin & Trio$|^Joe Cocker$|^Joe Cuba Sextet$|^Joe Dassin$|^Joe Diffie$|^Joe E. Brown$|^Joe Ely$|^Joe Henderson$|^Joe Hisaishi$|^Joe Jackson$|^Joe Maphis$|^Joe Mooney$|^Joe Nichols$|^Joe Pass$|^Joe Quartz$|^Joe Roland$|^Joe Sample$|^Joe Satriani$|^Joe Simon$|^Joe Strummer$|^Joe Veras$|^Joe Walsh$|^Joe Williams$|^Joel e GaÃºcho$|^Joel Grey$|^Joey Bada\\$\\$$|^Johann Christian Bach$|^Johann Pachelbel$|^Johann Sebastian Bach$|^Johann Strauss I$|^Johann Strauss II$|^Johannes Brahms$|^Johannes Heesters$|^John Anderson$|^John Bacchus Dykes$|^John Barry$|^John Butler Trio$|^John Cafferty & the Beaver Brown Band$|^John Cage$|^John Cale$|^John Carpenter$|^John Coltrane$|^John Coltrane Quartet$|^John Conlee$|^John Debney$|^John Denver$|^John Fahey$|^John Farnham$|^John Fogerty$|^John Frusciante$|^John Gary$|^John Hartford$|^John Hiatt$|^John Holt$|^John Kander$|^John Klemmer$|^John Lee Hooker$|^John Legend$|^John Lennon$|^John Lewis$|^John Martyn$|^John Maus$|^John Mayall$|^John Mayall & The Bluesbreakers$|^John Mayer$|^John McCormack$|^John Mellencamp$|^John Michael Montgomery$|^John Michael Talbot$|^John Mulaney$|^John Parr$|^John Philip Sousa$|^John Powell$|^John Prine$|^John Raitt$|^John Schneider$|^John Scofield$|^John Sebastian$|^John Stafford Smith$|^John Tartaglia$|^John Travolta$|^John Williams$|^John Zacherle$|^Johnnie Ray$|^Johnnie Taylor$|^Johnny Burnette$|^Johnny Burnette & The Rock N Roll Trio$|^Johnny Cash$|^Johnny Clegg$|^Johnny Colon$|^Johnny Cooper$|^Johnny Costa$|^Johnny Depp$|^Johnny Gill$") == T, TRUE,
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.18 = ifelse(str_detect(main.artist, "^Johnny Green$|^Johnny Griffin$|^Johnny Guitar Watson$|^Johnny Hallyday$|^Johnny Hartman$|^Johnny Hates Jazz$|^Johnny Hodges$|^Johnny Hodges & His Orchestra$|^Johnny Horton$|^Johnny Jenkins$|^Johnny Lee$|^Johnny Maestro$|^Johnny Mathis$|^Johnny Mercer$|^Johnny Nash$|^Johnny O.$|^Johnny Osbourne$|^Johnny Pacheco$|^Johnny Paycheck$|^Johnny Rivera$|^Johnny Rivers$|^Johnny Rodriguez$|^Johnny Thunders$|^Johnny Tillotson$|^Johnny Ventura y su Combo$|^Johnny Winter$|^Johnnyswim$|^Joji$|^JoJo$|^Jon & Vangelis$|^Jon B.$|^Jon Bellion$|^Jon Bon Jovi$|^Jon Brion$|^Jon Hassell$|^Jon Hopkins$|^Jon Jelmer$|^Jon Langston$|^Jon Pardi$|^Jon Schmidt$|^Jon Secada$|^Jonas Blue$|^Jonas Brothers$|^Jonathan Butler$|^Jonathan Coulton$|^Jonathan Edwards$|^Jonathan Groff$|^Jonathan Richman$|^Jonathan Richman & The Modern Lovers$|^Jones-Smith$|^Joni Mitchell$|^Jonny Diaz$|^Jonny Lang$|^Jordan Davis$|^Jordin Sparks$|^Jorge Ben Jor$|^Jorge CeledÃ³n$|^Jorge Dominguez y su Grupo Super Class$|^Jorge Drexler$|^Jorge Negrete$|^Jorge Valente$|^Jorja Smith$|^Jorma Kaukonen$|^JosÃ© Alfredo Jimenez$|^JosÃ© Feliciano$|^JosÃ© GonzÃ¡lez$|^JosÃ© JosÃ©$|^JosÃ© Luis Perales$|^JosÃ© Maria NapoleÃ³n$|^JosÃ©phine Baker$|^Jose Alberto El Canario$|^Jose Antonio Salaman$|^Jose Gamboa Ceballos Y Su Orquesta$|^Jose Mari Chan$|^Jose Miguel Class - El Gallito de Manati$|^Jose Prats Sirera$|^Josef Strauss$|^Josef VenclÅ¯ se svÃ½m orchestrem$|^Joseph Achron$|^Joseph Fonseca$|^Joseph Kosma$|^Josh A$|^Josh Abbott Band$|^Josh Gad$|^Josh Garrels$|^Josh Groban$|^Josh Ritter$|^Josh Thompson$|^Josh Turner$|^Josh White$|^Joshua Radin$|^Joss Stone$|^Jossie Esteban$|^Journey$|^Jowell & Randy$|^Joy Division$|^Joyce Manor$|^Joyner Lucas$|^Joywave$|^JP Saxe$|^Jr. Walker & The All Stars$|^jsan$|^JT Money$|^JT Music$|^Juan Carlos Alvarado$|^Juan DArienzo$|^Juan Gabriel$|^Juan Gotti$|^Juan Luis Guerra 4.40$|^Juan Luis Guerra y 440$|^Juan MagÃ¡n$|^Juan Valentin$|^Juanes$|^Judah & the Lion$|^Judas Priest$|^Judee Sill$|^Judy Collins$|^Judy Garland$|^Judy Holliday$|^Judy Kuhn$|^Juelz Santana$|^Juice Newton$|^Juice WRLD$|^Juicy J$|^Jukebox The Ghost$|^Jule Styne$|^Julee Cruise$|^Jules Massenet$|^Julia Lee & Her Boyfriends$|^Julia Michaels$|^Julian Cope$|^Julie and the Phantoms Cast$|^Julie Andrews$|^Julie London$|^Julie Sue$|^Julien Clerc$|^Julieta Venegas$|^Julio Chaidez$|^Julio Iglesias$|^Julio Jaramillo$|^Julio Preciado Y Su Banda Perla Del Pacifico$|^Julio Sosa$|^Julius LaRosa$|^June Carter Cash$|^June Christy$|^Jungle Brothers$|^Junior Brown$|^Junior Byles$|^Junior H$|^Junior Kimbrough$|^Junior Klan$|^Junior M.A.F.I.A.$|^Junior Mance$|^Junior Wells$|^Junko Ohashi$|^Junmai$|^Jurassic 5$|^Justice$|^Justin Bieber$|^Justin Moore$|^Justin Quiles$|^Justin Timberlake$|^Justin Townes Earle$|^Justo Betancourt$|^Juthika Roy$|^Jutta Hipp$|^Jutta Hipp Quintet$|^Juvenile$|^Juyen Sebulba$|^jxdn$|^Jyoti$|^Jyotsna Bhole$|^K-Ci & JoJo$|^K-Paz De La Sierra$|^K CAMP$|^K Dutta$|^K Mullick$|^K. B. Sundarambal$|^K. C. Goel$|^K. S. Chithra$|^K.C. Douglas$|^K.C.Dey$|^k.d. lang$|^K.Flay$|^K.R.Ramasamy$|^K.T. Oslin$|^K/DA$|^Kabah$|^Kacey Musgraves$|^Kai Winding$|^Kaiser Chiefs$|^Kakia Mendri$|^Kakkia Mendri$|^kalapana$|^Kaleidoscope$|^KALEO$|^Kalergis$|^Kali Uchis$|^Kalimba$|^Kalyani$") == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.19 = ifelse(str_detect(main.artist, "^Kamal Dasgupta$|^Kamala Bai$|^Kamala Jharia$|^Kanak Das Biswas$|^Kanan Devi$|^Kane Brown$|^Kanika Banerjee$|^Kano$|^Kansas$|^Kanta Kumari$|^Kantilal$|^Kany Garcia$|^Kanye West$|^Kaoma$|^Kapena$|^Karen Dalton$|^Karen Khachaturian$|^Karen Mok$|^Kari Jobe$|^Karina$|^Karla Bonoff$|^KAROL G$|^Karunesh$|^Karyn White$|^Kasabian$|^Kaskade$|^Kate & Anna McGarrigle$|^Kate Bush$|^Kate Nash$|^Kate Smith$|^Katharine McPhee$|^Kathryn Beaumont$|^Kathryn Grayson$|^Kathy Mattea$|^Katy Perry$|^Kaumudi Munshi$|^Kaushalya$|^Kausion$|^Kaveret$|^Kavinsky$|^Kavita Krishnamurthy$|^Kay Starr$|^KAYTRANADA$|^KB$|^KC & The Sunshine Band$|^Kealii Reichel$|^Keane$|^Keaton Henson$|^Keb Mo$|^Keely Smith$|^Kehlani$|^Keith & Kristyn Getty$|^Keith Anderson$|^Keith Emerson$|^Keith Forsey$|^Keith Green$|^Keith Jarrett$|^Keith Jarrett Trio$|^Keith Mansfield$|^Keith Murray$|^Keith Richards$|^Keith Sweat$|^Keith Urban$|^Keith Washington$|^Keith Whitley$|^Kelis$|^Keller Williams$|^Kellie Pickler$|^Kelly Clarkson$|^Kelly Price$|^Kelly Rida$|^Kelly Rowland$|^Kelsea Ballerini$|^Kem$|^Ken Ashcorp$|^Ken Boothe$|^Ken Elkinson$|^Ken Griffin$|^Kendrick Lamar$|^Kenny Burrell$|^Kenny Chesney$|^Kenny Dorham$|^Kenny Drew$|^Kenny Drew Trio$|^Kenny G$|^Kenny Lattimore$|^Kenny Loggins$|^Kenny Nolan$|^Kenny Rankin$|^Kenny Rogers$|^Kenny Wayne Shepherd$|^Kent Henry$|^Keola Beamer$|^Keri Hilson$|^Kermit$|^Kesari$|^Kesha$|^keshi$|^Kevin Abstract$|^Kevin Ayers$|^Kevin Gates$|^Kevin Kern$|^Kevin Rudolf$|^Key Glock$|^Keyshia Cole$|^khai dreams$|^Khalid$|^KHP Kridhamardawa Karaton Ngayogyakarta Hadiningrat$|^Khruangbin$|^Khursheed$|^Khursheed Bano$|^Khurshid Bano$|^Kiana LedÃ©$|^Kid Cudi$|^Kid Frost$|^Kid Ink$|^Kid N Play$|^Kid Ory$|^Kid Rock$|^KIDS SEE GHOSTS$|^Kidsongs$|^Kidz Bop Kids$|^Kikuo$|^Killing Joke$|^Killstation$|^Killswitch Engage$|^Kim Carnes$|^Kim Jung Mi$|^Kim Waters$|^Kim Wilde$|^Kimya Dawson$|^Kina$|^Kindred The Family Soul$|^King Crimson$|^King Curtis$|^King Diamond$|^King Geedorah$|^King Harvest$|^King Krule$|^King Lil G$|^King Olivers Creole Jazz Band$|^King Pleasure$|^King Princess$|^King Radio$|^King Sunny Ade$|^King Tubby$|^King Von$|^Kingdom Come$|^Kingo Hamada$|^Kings of Convenience$|^Kings of Leon$|^Kings X$|^Kino$|^Kip Moore$|^Kirk Franklin$|^Kirk Whalum$|^Kishore Kumar$|^KISS$|^Kitaro$|^Kittie$|^Kitty Kallen$|^Kix$|^Kiyotaka Sugiyama$|^KK$|^Klaatu$|^Klara Rumyanova$|^Klarino- Nikos Karakostas$|^Klaus Badelt$|^Kleeer$|^Klymaxx$|^KMFDM$|^KNAAN$|^Knife Party$|^Kodak Black$|^Kodaline$|^Koe Wetzel$|^Koko Taylor$|^Kolohe Kai$|^Kolton Moore & the Clever Few$|^Kontopoylos$|^Kool & The Gang$|^Kool G Rap$|^Kool Moe Dee$|^Koop$|^Korn$|^KortÃ¡rsak$|^Kostas Karipis$|^Kostas Roukounas$|^Kostas Roykoynas$|^Kostas Skafidas$|^Kostas Tsanakos$|^Kota the Friend$|^Kotch$|^Kottonmouth Kings$|^Kraftwerk$|^Kreator$|^Kreider$|^Kris Kristofferson$|^Kris Kross$|^Krishna Bhamini$") == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.20 = ifelse(str_detect(main.artist, "^Krishna Chandra Dey$|^Kristen Bell$|^Kristin Chenoweth$|^Kriszta Kovats$|^Krizz Kaliko$|^Krokus$|^KRS-One$|^Kruder & Dorfmeister$|^KT Tunstall$|^Kulsum$|^Kumar Sanu$|^Kurt Carr & The Kurt Carr Singers$|^Kurt Graunke$|^Kurt Heynicke$|^Kurt Hugo Schneider$|^Kurt Weill$|^Kurtis Blow$|^Kurupt$|^Kusum Mantri$|^Kut Klose$|^Kutless$|^Kygo$|^KYLE$|^Kylie Minogue$|^Kyuss$|^L. Royvas$|^L.A. Guns$|^L.c. Cooke$|^L.M. Hilton$|^L.T.D.$|^L7$|^La Adictiva Banda San JosÃ© de Mesillas$|^La Apuesta$|^La Arrolladora Banda El LimÃ³n De Rene Camacho$|^La Banda Gorda$|^La Bouche$|^La CombinaciÃ³n Vallenata$|^La Diferenzia$|^La Factoria$|^La Fiebre$|^La Firma$|^LA INDIA$|^La Ley$|^La Lupe$|^La Luz Roja De San Marcos$|^La Mafia$|^La Makina$|^La Mosca Tse-Tse$|^La Nobleza De Aguililla$|^La Numero 1 Banda Jerez De Marco A. Flores$|^La Oreja de Van Gogh$|^La Original Banda El LimÃ³n de Salvador LizÃ¡rraga$|^La Playa Sextet$|^La Quinta Estacion$|^La Roscada$|^La Roux$|^La Secta AllStar$|^La Sonora Dinamita$|^La Sonora Matancera$|^La Sonora Santanera$|^La Tropa Chicana$|^La Tropa Vallenata$|^LÃ´ Borges$|^LÃ©o Delibes$|^LÃ‰ON$|^LaBelle$|^Labi Siffre$|^Labrinth$|^Lacuna Coil$|^Ladron$|^Lady A$|^Lady Gaga$|^Lady in the Dark Ensemble (1963)$|^Ladysmith Black Mambazo$|^Lafayette Afro Rock Band$|^Lagwagon$|^Laid Back$|^Lake Street Dive$|^Lakeside$|^Lakshmi Bai$|^Lalah Hathaway$|^Lalita Dewoolkar$|^Lalita Parulekar$|^Lallubhai Naik$|^Lalo Mora$|^Lalo Schifrin$|^Lamb of God$|^Lambert$|^Lampros Xalkias$|^Lana Del Rey$|^Langston Hughes$|^Lani Misalucha$|^LANY$|^Lara & Reyes$|^Lara Fabian$|^Laraaji$|^LARGE KALLIOPE WITH BELLS$|^Larry Carlton$|^Larry Gatlin & The Gatlin Brothers$|^Larry Graham$|^Larry Groce$|^Larry Norman$|^Larry Williams$|^Las AtlixqueÃ±as$|^Las Hermanas Padilla$|^Las Jilguerillas$|^LaShun Pace$|^Lata Mangeshkar$|^Latimore$|^Laura Bell Bundy$|^Laura Branigan$|^Laura Nyro$|^Laura Olsher$|^Laura Pausini$|^Laura Story$|^Lauren Alaina$|^Lauren Daigle$|^Laurie Anderson$|^Laurie Johnson$|^Lauv$|^LaVern Baker$|^Lawrence Brown$|^Lawson-Haggart Jazz Band$|^Layla Mourad$|^LCD Soundsystem$|^Le Tigre$|^Lea Michele$|^Lea Salonga$|^Lead Belly$|^Leadbelly with Josh White$|^League of Legends$|^LeAnn Rimes$|^Lebo M.$|^LebrÃ³n Brothers$|^Lecrae$|^Led Zeppelin$|^Ledisi$|^Lee Ann Womack$|^Lee Brice$|^Lee Dorsey$|^Lee Greenwood$|^Lee Hazlewood$|^Lee Konitz$|^Lee Michaels$|^Lee Moon Sae$|^Lee Morgan$|^Lee Remick$|^Lee Ritenour$|^Lee Roy Parnell$|^Lee Scratch Perry$|^Leela Bai$|^Leela Chitnis$|^Leela Mehta$|^Leela Pawar$|^Leela Sawant$|^Leftover Salmon$|^Lefty Frizzell$|^LEGADO 7$|^Legend The Band$|^LegiÃ£o Urbana$|^LegiÃ³n EspaÃ±ola$|^Lehman Engel$|^Leigh Harline$|^Lemon Demon$|^Lemon Jelly$|^Lena Horne$|^Lenin RamÃ­rez$|^Lenka$|^Lennie Hayton & His Orchestra$|^Lennie Tristano$|^Lennon Stella$|^Lenny Cooper$|^Lenny Kravitz$|^Leo Dan$|^Leo Kottke$|^Leo Marini$|^Leo Mathisen$|^Leo Mathisens Band$|^Leo Sayer$|^Leon Bridges$|^Leon Redbone$|^Leon Russell$|^Leon Ware$|^Leona Lewis$|^Leonard Bernstein$|^Leonard Cohen$|^Leonardo Favio$|^Leonardo Paniagua$|^Leonid Hambro$|^Leopold Stokowski$|^Leroy Anderson$|^Leroy Carr$|^Leroy Hutson$|^Leroy Van Dyke$|^Les Baxter$|^Les Brown$|^Les Brown & His Orchestra$|^Les McCann$|^Les MisÃ©rables-Original London Cast$|^Les MisÃ©rables - 10th Anniversary Concert Cast$") == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.21 = ifelse(str_detect(main.artist, "^Les Paul$|^Les Paul & Mary Ford$|^Les Rita Mitsouko$|^Lesley Gore$|^Leslie Bricusse$|^Leslie Cheung$|^Leslie Odom Jr.$|^Less Than Jake$|^Lester Flatt$|^Lester Lanin$|^Lester Young$|^Letters To Cleo$|^Level 42$|^Levert$|^Levi Stubbs$|^Levon Helm$|^Lew Stone$|^Lewis Capaldi$|^Lewis Del Mar$|^Lewis H. Redner$|^LFO$|^Liam Payne$|^LiberaciÃ³n$|^Lifehouse$|^Lighter Shade Of Brown$|^Lighthouse Family$|^Lightnin Hopkins$|^Lijadu Sisters$|^Lil Baby$|^Lil Boodang$|^Lil Darkie$|^Lil Dicky$|^Lil Durk$|^Lil Flip$|^Lil Jon$|^Lil Jon & The East Side Boyz$|^Lil Keke$|^Lil Kim$|^Lil Loaded$|^Lil Mosey$|^Lil Nas X$|^Lil Peep$|^Lil Rob$|^Lil Scrappy$|^Lil Skies$|^Lil Suzy$|^Lil Tecca$|^Lil Tjay$|^Lil Troy$|^Lil Uzi Vert$|^Lil Wayne$|^Lil Wyte$|^Lil Xan$|^Lil Yachty$|^Lilly Goodman$|^Lillys Chapel School (Ala.)$|^Lily Allen$|^Lime$|^Limp Bizkit$|^Lin-Manuel Miranda$|^Linda Martell$|^Linda Perhacs$|^Linda Ronstadt$|^Lindisfarne$|^Lindsay Lohan$|^Lindsey Buckingham$|^Lindsey Stirling$|^Lindy Doherty$|^Link Wray$|^Link Wray & The Wraymen$|^Linked Horizon$|^Linkin Park$|^Linton Kwesi Johnson$|^Lion$|^Lionel Bart$|^Lionel Belasco$|^Lionel Hampton$|^Lionel Hampton Orchestra$|^Lionel Richie$|^Lipps Inc.$|^Liquid Mind$|^Liran Roll$|^LiSA$|^Lisa Gerrard$|^Lisa Lisa & Cult Jam$|^Lisa Loeb$|^Lisa Stansfield$|^Lisandro Meza$|^Lit$|^Lita Ford$|^Little Anthony & The Imperials$|^Little Beaver$|^Little Big Town$|^Little Dragon$|^Little Eva$|^Little Feat$|^Little Jimmy Dickens$|^Little Jimmy Scott$|^Little Joe$|^Little Joe & La Familia$|^Little Joe And The Latinaires$|^Little Milton$|^Little Mix$|^Little Richard$|^Little River Band$|^Little Texas$|^Little Walter$|^Little Willie John$|^Liva Weel$|^Live$|^Living Colour$|^Living Legends$|^Living Strings$|^Liz Callaway$|^Liz Phair$|^Liz Story$|^Liza Minnelli$|^Lizzo$|^LL Cool J$|^Lloyd$|^Lloyd Banks$|^Lloyd Cole and the Commotions$|^Lloyd Price$|^LMFAO$|^Lobo$|^Local H$|^Local Natives$|^Local Oafs$|^LOCASH$|^Loggins & Messina$|^Logic$|^Lola BeltrÃ¡n$|^Lola Flores$|^Loleatta Holloway$|^Lolita$|^London Symphony Orchestra$|^Lonestar$|^Long Beach Dub Allstars$|^Lonnie Johnson$|^Lonnie Liston Smith$|^Looking Glass$|^LOONA$|^Loose Ends$|^LOrchestra Italiana$|^Lord Berners$|^Lord Huron$|^Lord Invader$|^Lord Kitchener$|^Lord Melody$|^Lorde$|^Lords Of The Underground$|^Loredana BertÃ¨$|^Loreena McKennitt$|^Lorenzo De Monteclaro$|^Loretta Lynn$|^Lorne Greene$|^Lorrie Morgan$|^Los Ã\u0081ngeles Azules$|^Los Acosta$|^Los Alegres de la Sierra$|^Los Alegres De Teran$|^Los Alegres Del Barranco$|^Los Amigos Invisibles$|^Los Amos De Nuevo Leon$|^Los Angeles De Charly$|^Los Angeles Negros$|^Los Armadillos de la Sierra$|^Los Askis$|^Los AutÃ©nticos Decadentes$|^Los Baron De Apodaca$|^Los Bondadosos$|^Los Brincos$|^Los Broncos de Reynosa$|^Los Buitres De Culiacan Sinaloa$|^Los Bukis$|^Los Bybys$|^Los Cachorros de Juan Villarreal$|^Los Cadetes De Linares$|^Los Cafres$|^Los Caminantes$|^Los Camisas Negras$|^Los Canelos De Durango$|^Los Cantantes$|^Los Cometas$|^Los Compadres$|^Los Corraleros De Majagual$|^Los Cuates de Sinaloa$|^Los Cuatro Huasos$|^Los Dandys$|^Los Dareyes De La Sierra$|^Los Del Rio$|^Los Diablitos$|^Los Dinamicos Del Norte$|^Los Dos Carnales$|^Los Enanitos Verdes$|^Los Extranos$|^Los Fabulosos Cadillacs$|^Los Felinos$|^Los Freddys$|^Los Fugitivos$") == T, TRUE,
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.22 = ifelse(str_detect(main.artist, "^Los Galos$|^Los Gatos Negros De Tiberio$|^Los Hermanos Arriagada$|^Los Hermanos Barron$|^Los Hermanos Rosario$|^Los HorÃ³scopos De Durango$|^Los Humildes$|^Los Huracanes del Norte$|^Los Indios Tabajaras$|^Los Indomables De Cedral$|^Los Inquietos Del Norte$|^Los inquietos del vallenato$|^Los Invasores De Nuevo LeÃ³n$|^Los Iracundos$|^Los Jaivas$|^Los Karkiks$|^Los Kjarkas$|^Los Leones Del Norte$|^Los Liricos De Teran$|^Los Llayras$|^Los Lobos$|^Los Lonely Boys$|^Los Marineros del Norte$|^Los MelÃ³dicos$|^Los Mier$|^Los Mismos$|^Los Morros Del Norte$|^Los MuÃ±equitos De Matanzas$|^Los Muecas$|^Los Nuevos Rebeldes$|^Los Originales De San Juan$|^Los Pajaritos De Tacupa$|^Los Palominos$|^Los Panchos$|^Los Peregrinos$|^Los Pericos$|^Los Players$|^Los Plebes del Rancho de Ariel Camacho$|^Los Primos MX$|^Los Prisioneros$|^Los Provincianos$|^Los Razos$|^Los Rebeldes Del Bravo$|^Los Rehenes$|^Los Relampagos Del Norte$|^Los Reyes Del Camino$|^Los Reyes Locos$|^Los Rieleros Del Norte$|^Los Socios Del Ritmo$|^Los Solitarios$|^Los Teen Tops$|^Los Telez$|^Los Temerarios$|^Los terribles Del Norte$|^Los Terricolas$|^Los Tigres Del Norte$|^Los Tigrillos$|^Los Tiranos Del Norte$|^Los Titanes De Durango$|^Los Toreros Muertos$|^Los Toros Band$|^Los Traileros Del Norte$|^Los Tres Caballeros$|^Los Troqueros$|^Los Troveros Criollo$|^Los Tucanes De Tijuana$|^Los YaguarÃº$|^Los Yonics$|^Lost Boyz$|^Lost Kings$|^Lou Christie$|^Lou Donaldson$|^Lou Gramm$|^Lou Monte$|^Lou Rawls$|^Lou Reed$|^Loud Luxury$|^LOUDNESS$|^Loudon Wainwright III$|^Louie Bellson$|^Louie Ramirez$|^Louie Zong$|^Louis and Bebe Barron$|^Louis Armstrong$|^Louis Armstrong & His Hot Five$|^Louis Armstrong & His Hot Seven$|^Louis Armstrong & His Savoy Ballroom Five$|^Louis Armstrong & His Sebastian New Cotton Club Orchestra$|^Louis Hardin$|^Louis Jordan & His Tympany Five$|^Louis Jourdan$|^Louis Prima$|^Louis The Child$|^Louis Untermeyer$|^Louise Bennett$|^Louise Bogan$|^Love$|^Love and Rockets$|^Love Unlimited$|^Loverboy$|^Low$|^Lowell Fulson$|^Lowell George$|^Lowell Mason$|^LSG$|^Lu Watters Yerba Buena Jazz Band$|^Lucero$|^Lucha Villa$|^Lucho Gatica$|^Lucho Oliva$|^Luciano Pavarotti$|^Luciano Tajoli$|^Lucienne Boyer$|^Lucille Bogan$|^Lucinda Williams$|^Lucio Battisti$|^Lucio Dalla$|^Lucky Ali$|^Lucky Dube$|^Lucy Dacus$|^Lucy Pearl$|^Ludacris$|^Ludo$|^Ludovico Einaudi$|^Ludwig van Beethoven$|^Luh Kel$|^Luigi Boccherini$|^Luigi Cherubini$|^Luigi Denza$|^Luis Bacalov$|^Luis de Milan$|^Luis Enrique$|^Luis Fernando Ramirez Zuluaga$|^Luis Fonsi$|^Luis Miguel$|^Luis Rovira y su Orquesta$|^Luis Segura$|^Luis Vargas$|^Luis Villegas$|^Luis y Julian$|^Luiz BonfÃ¡$|^Lukas Graham$|^Luke Bryan$|^Luke Combs$|^Luke Henry$|^Luna$|^Lunay$|^Lund$|^Luniz$|^Luny Tunes$|^Lupe Fiasco$|^Lupillo Rivera$|^Lush$|^Luther Barnes$|^Luther Ingram$|^Luther Vandross$|^Luz Casal$|^Lyfe Jennings$|^Lykke Li$|^Lyle Lovett$|^Lyle Ritz$|^Lyn Collins$|^Lynch Mob$|^Lynn Anderson$|^Lynyrd Skynyrd$|^Lys Gauty$|^M. Faruqi$|^M. Hershman$|^M. K. Thyagaraja Bhagavathar$|^M. L. Vasanthakumari$|^M. Malloire$|^M. N. Ghosh$|^M. S. Rajeswari$|^M. S. Rama Rao$|^M. S. Subbulakshmi$|^M. V. Subbaiah Naidu$|^M. Ward$|^M.I.A.$|^M.M.Dandapani Desikar$|^M.O.P.$|^M.V. Rajamma$|^(M\\|O\\|O\\|N)$|^M2M$|^M83$|^MÅ“nia$|^MÃ¤go de Oz$|^MÃ¶tley CrÃ¼e$|^MÃ¼nir Nurettin SelÃ§uk$|^MÃ¼zeyyen Senar$|^MÃ½a$|^Mabel Mercer$|^Mabuhay Singers$|^Mac Davis$|^Mac DeMarco$|^Mac Dre$|^Mac Mall$|^Mac Miller$|^Macbeth the Great$|^Maceo And The Macks$|^Machine Gun Kelly$") == T, TRUE,
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.23 = ifelse(str_detect(main.artist, "^Machine Head$|^Machito & His Afro-Cuban Orchestra$|^Machito & His Afro Cubans$|^Machito & His Orchestra$|^Machito Orchestra$|^Mack 10$|^Macklemore$|^Macklemore & Ryan Lewis$|^Macross 82-99$|^Macy Gray$|^Mad Cobra$|^Mad Season$|^Maddie & Tae$|^MadeinTYO$|^Madeleine Peyroux$|^Madhavapeddi Sathyam$|^Madhubala Jhaveri$|^Madhuri Mukherjee$|^Madison Beer$|^Madlib$|^Madness$|^Madonna$|^Madvillain$|^Maelo Ruiz$|^Maggie Lindemann$|^Maggie Rogers$|^Magic Sam$|^MAGIC!$|^Magneto$|^Mahalia Jackson$|^Mahavishnu Orchestra$|^Mahendra Kapoor$|^Majid Jordan$|^Major Lazer$|^Makaveli$|^Makbule Enver HanÄ±m$|^Makis Vasiliadis$|^Makoto Matsushita$|^Mal Blum$|^Mal Waldron$|^Mala Karim$|^Malcolm McLaren$|^Maldita Vecindad Y Los Hijos Del 5to. Patio$|^Malo$|^Malti$|^Maluma$|^Malvina Reynolds$|^MAMAMOO$|^MamlÃª$|^ManÃ¡$|^Manabendra Mukherjee$|^Manchester Orchestra$|^Mandi e Sorocabinha$|^Mandisa$|^Mandolin Orange$|^Mandrill$|^Mandy Gonzalez$|^Mandy Moore$|^Mandy Patinkin$|^Manfred Mann$|^Manfred Manns Earth Band$|^Manfried RÃ¶ssner$|^Manic Street Preachers$|^Manik Varma$|^Manju$|^Manna Dey$|^Mannheim Steamroller$|^Manole Stroici$|^Manorama$|^Manos Koutsaggelidis$|^Manowar$|^mansionz$|^Mantovani$|^Manu Chao$|^Manuel & The Music Of The Mountains$|^Manuel de Falla$|^Manuel Pomian$|^Manuel Ponce$|^Manuel Turizo$|^MarÃ­a Elena Walsh$|^MarÃ­a JosÃ©$|^Maracaibo 15$|^Maranatha! Vocal Band$|^Marc Anthony$|^Marc Cohn$|^Marc E. Bassy$|^Marc Jordan$|^Marca MP$|^Marcel Pagnol$|^Marcela Gandara$|^Marcia Griffiths$|^Marco Antonio SolÃ­s$|^Marco Barrientos$|^Marco Sison$|^Marconi Union$|^Marcos Brunet$|^Marcos Valle$|^Marcos Vidal$|^Marcos Witt$|^Marcos Yaroide$|^Marcy Playground$|^Maren Morris$|^Margaret Whiting$|^Margarita Cueto$|^Margarita la diosa de la cumbia$|^Margo Guryan$|^Marguerite Viby$|^Mari Merche Y Su Orquesta$|^Mari Trini$|^Maria BethÃ¢nia$|^Maria Conchita Alonso$|^Mariachi Vargas De Tecalitlan$|^Mariah$|^Mariah Carey$|^Marian McPartland$|^Marianas Trench$|^Marianne Faithfull$|^Marianne Moore$|^Maribou State$|^Marie Dubas$|^Marijata$|^Marika Frantzeskopoulou$|^Marika Kanaropoulou$|^Marika Ninou$|^Marika Papaggika$|^Marika Papagkika$|^Marillion$|^Marilyn Horne$|^Marilyn Manson$|^MARINA$|^Marina Polixronopoulou$|^Marine Band Of The Royal Netherlands Navy$|^Marino$|^Mario$|^Mario Castelnuovo-Tedesco$|^Mario Nascimbene$|^Marisela$|^Marito Rivera Y Su Grupo Bravo$|^Mark Chesnutt$|^Mark Knopfler$|^Mark Mancina$|^Mark Morrison$|^Mark OConnor$|^Mark Olf$|^Mark Ronson$|^Mark Schultz$|^Mark Wills$|^Markos Vamvakaris$|^Marlena Shaw$|^Marlene$|^Marlene Dietrich$|^Marlon D$|^Marmalade$|^Marni Nixon$|^Maroon 5$|^Marques Houston$|^Marshmello$|^Martha Reeves & The Vandellas$|^Martika$|^Martin Denny$|^Martin Garrix$|^Martin ODonnell$|^Martin Solveig$|^Martina McBride$|^Martinho Da Vila$|^Marty Haugen$|^Marty Murray$|^Marty Robbins$|^Marty Stuart$|^Marvin Gaye$|^Marvin Hamlisch$|^Marvin Santiago$|^Marvin Sapp$|^Marvin Sease$|^Mary Chapin Carpenter$|^Mary Costa$|^Mary Hopkin$|^Mary J. Blige$|^Mary Jane Girls$|^Mary Lou Williams$|^Mary Martin$|^Mary Mary$|^Mary Norton$|^Mary Wells$|^Maryline Garcia & Christophe da Silva$|^Masatoshi Ono$|^Mase$|^Masego$|^Mason Foster$|^Mason Williams$|^Massiel$|^Massimo Ranieri$|^Massive Attack$|^Masta Ace Incorporated$|^Master Ebrahim$|^Master Krishnarao$|^Master Mohammad$|^Master P$|^Mastodon$|^Mat Kearney$") == T, TRUE,
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.24 = ifelse(str_detect(main.artist, "^Matchbook Romance$|^Matchbox Twenty$|^Mathias Wieman$|^Matisyahu$|^Matoma$|^Matt and Kim$|^Matt Maeson$|^Matt Maher$|^Matt Mason$|^Matt Monro$|^Matt Nathanson$|^Matt Redman$|^Matthew Sweet$|^Matthew West$|^Matthew Wilder$|^Matthias Kadar$|^Matti Caspi$|^Mau y Ricky$|^Maurice Chevalier$|^Maurice Jarre$|^Maurice Jaubert$|^Maurice Ravel$|^Mavis Staples$|^MAX$|^Max Bruch$|^Max Freegrant$|^Max Hansen$|^Max Miller$|^Max Reger$|^Max Richter$|^Max Roach$|^Max Romeo$|^Max Steiner$|^Maxi Priest$|^MAXIMUM THE HORMONE$|^Maxwell$|^Maya Banerjee$|^Mayday Parade$|^Mayer Hawthorne$|^Mayhem$|^Maynard Ferguson$|^Mayukh Hazarika$|^Maze$|^Mazz$|^Mazzy Star$|^MC Eiht$|^MC Hammer$|^MC Lyte$|^MC Magic$|^MC5$|^McCafferty$|^McCoy Tyner$|^McCoy Tyner Trio$|^MDC$|^Me First and the Gimme Gimmes$|^Meade Lux Lewis$|^Meat Loaf$|^Meat Puppets$|^Mecano$|^Meco$|^Medasin$|^Medeski$|^MEDUZA$|^Meek Mill$|^Meena Kapoor$|^Meena Kumari$|^Meenakshi$|^Megadeth$|^Megan Thee Stallion$|^Meghan Trainor$|^Mehmet Kemiksiz$|^Mehtab$|^Mel McDaniel$|^Mel TormÃ©$|^Melanie$|^Melanie C$|^Melanie Martinez$|^Melba Moore$|^Melisa Morgan$|^Melissa Etheridge$|^Melissa Manchester$|^Melody Gardot$|^Melody the Music Box$|^Melvins$|^Memphis Bleek$|^Memphis May Fire$|^Memphis Minnie$|^Memphis Slim$|^Men At Work$|^Men Without Hats$|^Menka Bai$|^Menudo$|^Mercedes Castro$|^Mercedes Sosa$|^Mercury Rev$|^Mercyful Fate$|^MercyMe$|^Meredydd Evans$|^Merle Haggard$|^Merle Haggard & The Strangers$|^Merle Travis$|^Meryl Streep$|^Meshell Ndegeocello$|^Meshuggah$|^Message To Bears$|^Metal Church$|^Metallica$|^Metalocalypse: Dethklok$|^Method Man$|^Metric$|^Metro Boomin$|^Metro Station$|^Metronomy$|^mewithoutYou$|^MF DOOM$|^MF Grimm$|^MFSB$|^MGM Studio Chorus$|^MGM Studio Orchestra$|^MGMT$|^Mi Banda El Mexicano$|^Mia Martini$|^Miami Horror$|^Miami Sound Machine$|^Michael Bolton$|^Michael BublÃ©$|^Michael Chapman$|^Michael Franks$|^Michael Franti & Spearhead$|^Michael Giacchino$|^Michael Hedges$|^Michael Henderson$|^Michael Hurley$|^Michael Jackson$|^Michael Johnson$|^Michael Joncas$|^Michael Jones$|^Michael Kiwanuka$|^Michael Learns To Rock$|^Michael Lington$|^Michael Martin Murphey$|^Michael McDonald$|^Michael Nyman$|^Michael Ray$|^Michael Salgado$|^Michael Schenker Group$|^Michael Stanley Band$|^Michael W. Smith$|^Michel Berger$|^Michel De Villers$|^Michel LaRue$|^Michel Legrand$|^Michel Polnareff$|^Michelle$|^Michelle Branch$|^Michelle Pfeiffer$|^Mick Gordon$|^Mick Jagger$|^Mick Jenkins$|^Mickey & Sylvia$|^Mickey Avalon$|^Mickey Gilley$|^Mickey Mouse$|^Mickey Rooney$|^Midland$|^Midnight Oil$|^Midnight Star$|^Miel San Marcos$|^Mighty Baby$|^Mighty Clouds Of Joy$|^Mighty Diamonds$|^Mighty Sparrow$|^Migos$|^Miguel$|^Miguel Aceves Mejia$|^Miguel BosÃ©$|^Miguel Cassina$|^Miguel Gallardo$|^Miguel Llobet SolÃ©s$|^Miguel Mateos - Zas$|^Miguel Y Miguel$|^Mihalis Kallergis$|^Miike Snow$|^Mijares$|^MIKA$|^Mike & The Mechanics$|^Mike Bloomfield$|^Mike Jones$|^Mike Laure$|^Mike Oldfield$|^Mike Posner$|^Mike WiLL Made-It$|^mike\\.$|^Mikey Dread$|^Miki Howard$|^Miki Matsubara$|^MiklÃ³s RÃ³zsa$|^Mild High Club$|^Mildred Bailey$|^Mildred Bailey & Her Orchestra$") == T, TRUE,
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.25 = ifelse(str_detect(main.artist, "^Miles Davis$|^Miles Davis Quartet$|^Miles Davis Quintet$|^Miles Davis Sextet$|^Miley Cyrus$|^Milky Chance$|^Millencolin$|^Milli Vanilli$|^Millie Jackson$|^Milt Jackson$|^Miltiadis Kazis$|^Milton Nascimento$|^Mily Balakirev$|^MiMS$|^Mina$|^Minako Yoshida$|^Mindless Self Indulgence$|^Mindy McCready$|^Miniature Tigers$|^Ministry$|^Mink DeVille$|^Minnie Riperton$|^Minor Threat$|^Mint Condition$|^Minus the Bear$|^Minutemen$|^Miracle Musical$|^Miracle Tones$|^Miranda Cosgrove$|^Miranda Lambert$|^Miranda!$|^Mireille$|^Miriam Makeba$|^Miriam Yeung$|^Mischief Brew$|^Misfits$|^Miss Angurbala$|^Miss Bibbo$|^Miss May I$|^Missing Persons$|^MISSIO$|^Mission Of Burma$|^Mississippi John Hurt$|^Mississippi Mass Choir$|^Mississippi Sheiks$|^Missy Elliott$|^Mister Chivo$|^Mister Rogers$|^MisterWives$|^Mistinguett$|^Mitaki$|^Mitch Hedberg$|^Mitch Miller$|^Mitch Miller & His Orchestra & Chorus$|^Mitch Miller & The Sing-Along Gang$|^Mitch Ryder and The Detroit Wheels$|^Mitchell Tenpenny$|^Mitski$|^Mitsos Arapakis$|^Mixalis Kalergis$|^Mixalis Thomakos$|^MKTO$|^Mo. Guzzo$|^MO3$|^Mobb Deep$|^Moby$|^Mocedades$|^Moderatto$|^Modern Baseball$|^Modern English$|^Modern Talking$|^Modest Mouse$|^Modest Mussorgsky$|^Moe Bandy$|^Moe Bandy & Joe Stampley$|^Moe Shop$|^moe\\.$|^Mogwai$|^Mohammadreza Shajarian$|^Mohammed Abdel Wahab$|^Mohammed Farooqui$|^Mohammed Rafi$|^Mohantara Talpade$|^Mohit Chauhan$|^Moises Vivanco$|^Molly Hatchet$|^Moloko$|^Molotov$|^Mom Jeans.$|^Mon Rivera$|^Monchy & Alexandra$|^Money Man$|^Moneybagg Yo$|^Mongo Santamaria$|^Monica$|^Monica Naranjo$|^Monica Zetterlund$|^Monifah$|^Monique Nikkole$|^Monks Of The Abbey Of Notre Dame$|^Monster Magnet$|^Montell Jordan$|^Montez de Durango$|^Montgomery Gentry$|^Montrose$|^Moodymann$|^Moon Taxi$|^Moondog$|^Moonshine Bandits$|^Moose Charlap$|^Morbid Angel$|^Morcheeba$|^Morgan Evans$|^Morgan Wallen$|^Morgana King$|^Moritz Moszkowski$|^Mormon Tabernacle Choir$|^Morphine$|^Morris Day$|^Morrissey$|^Mort Garson$|^Morton Downey$|^Mos Def$|^Mose Allison$|^Moshe Wilensky$|^MotÃ¶rhead$|^Mother Goose Club$|^Mother Love Bone$|^Mother Mother$|^Mother Nature Sound FX$|^Mothers Finest$|^Moti Bai$|^Motilal$|^Motion City Soundtrack$|^Motionless In White$|^Mott The Hoople$|^Mountain$|^Mountain John$|^Moving Pictures$|^Mr. Big$|^Mr. Bungle$|^Mr. Capone-E$|^Mr. Knightowl$|^Mr. Lil One$|^Mr. Mister$|^Mrinal Kanti Ghosh$|^Ms. Lauryn Hill$|^Mt. Joy$|^Mtume$|^Mubarak Begum$|^Muddy Waters$|^Mudhoney$|^Mudvayne$|^Mukesh$|^Mukhtar Begum$|^Mulatto$|^Mulatu Astatke$|^Mumford & Sons$|^Mumtaz Shanti$|^Munawar Sultana$|^Munawwar Sultana$|^Mungo Jerry$|^Munir Alam$|^Muscadine Bloodline$|^Muse$|^Mushroomhead$|^Mushy Peas$|^Musikkorps der 1. Gebirgsdivision Garmisch-Partenkirchen & der Chor des Gebirgsfernmeldebataillons 8$|^Musiq Soulchild$|^Mustard$|^Mustard Plug$|^Muzak Orchestra$|^Muzio Clementi$|^mxmtoon$|^MxPx$|^My Bloody Valentine$|^My Chemical Romance$|^My Darkest Days$|^My Life With The Thrill Kill Kult$|^My Morning Jacket$|^Myka 9$|^Myke Towers$|^Mykola Dmytrovych Leontovych$|^Myriam Hernandez$|^Mystery Skulls$|^Mystikal$|^N. S. Krishnan$|^N. Vanaja$|^N\\.E\\.R\\.D$|^N\\.O\\.R\\.E\\.$|^N\\.W\\.A\\.$|^n/a$|^Nacha Pop$|^Nada Surf$|^Nadira$|^Naina$|^Najee$|^Naked Eyes$|^Naked Raygun$|^Nalini Jaywant$") == T, TRUE,
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.26 = ifelse(str_detect(main.artist, "^Nana Mouskouri$|^Nanci Griffith$|^Nancy Sinatra$|^Nancy Wilson$|^Nanette Fabray$|^Napalm Death$|^Nappy Roots$|^Nara LeÃ£o$|^Nas$|^Naseem Akhtar$|^Naseem Bano$|^Nasim Begum$|^Nat Adderley$|^Nat King Cole$|^Nat King Cole Trio$|^Natalia Kills$|^Natalia Lafourcade$|^Natalie Cole$|^Natalie Grant$|^Natalie Imbruglia$|^Natalie Merchant$|^Natalino Otto$|^Natanael Cano$|^Natasha Bedingfield$|^Natasha Richardson$|^Nataural$|^Nate Dogg$|^Nathan Lane$|^Nathaniel Rateliff & The Night Sweats$|^Natti Natasha$|^Natural White Noise Relaxation$|^Nature Sounds$|^Nature Sounds Nature Music$|^Naughty By Nature$|^NAV$|^Nazareth$|^Nazem al-Ghazali$|^Nazia Hassan$|^NB Ridaz$|^NCT 127$|^Ne-Yo$|^Neal McCoy$|^Neck Deep$|^Necro$|^Ned Doheny$|^NEEDTOBREATHE$|^Neena$|^Neeta Bardhan Sen$|^NEFFEX$|^Negative Approach$|^Neil Diamond$|^Neil Patrick Harris$|^Neil Sedaka$|^Neil Young$|^Nek$|^Neko Case$|^Nektar$|^Nelly$|^Nelly Furtado$|^Nelson Cavaquinho$|^Nelson GonÃ§alves$|^Nelson Ned$|^Nelson Riddle$|^Nena$|^Nena Leal$|^Neon Trees$|^NERO$|^Neros Day At Disneyland$|^Nesian N\\.I\\.N\\.E\\.$|^NEU!$|^Neutral Milk Hotel$|^Never Shout Never$|^New Boyz$|^New Edition$|^New Found Glory$|^New Kids On The Block$|^New Orchestral Society of Boston$|^New Order$|^New Orleans Heritage Hall Jazz Band$|^New Radicals$|^New Riders of the Purple Sage$|^New York Dolls$|^Newcleus$|^Newsboys$|^Newsies Ensemble$|^Newsong$|^Next$|^NF$|^NGHTMRE$|^Niall Horan$|^NiccolÃ² Paganini$|^Nice & Smooth$|^Nicholas Brodszky$|^Nicholas Hooper$|^Nick Cave & The Bad Seeds$|^Nick Drake$|^Nick Jonas$|^Nick Lowe$|^Nickel Creek$|^Nickelback$|^Nicki Minaj$|^Nicky Jam$|^Nico$|^Nico & Vinz$|^Nicola Di Bari$|^NicolÃ¡s Cieri$|^Nicolas Urcelay$|^Nicole Croisille$|^Nicole Kidman$|^Nicolette Larson$|^Niels Brincker$|^Nigga$|^Night Lovell$|^Night Ranger$|^Nightmare$|^Nightmares On Wax$|^Nightwish$|^Nik Kershaw$|^NIKI$|^Nikki Blonsky$|^niko-qÃ©e$|^Nikolai Rimsky-Korsakov$|^Nikolaus Harnoncourt$|^Nikos Gounaris$|^Nikos Karakostas$|^Nilla Pizzi$|^Nilo SÃ©rgio$|^Nils Frahm$|^Nils Lofgren$|^Nina$|^Nina Ntouka$|^Nina Simone$|^Nine Inch Nails$|^Nino Bravo$|^Nino Rota$|^Ninon Vallin$|^Ninu Mazumder$|^Nio Garcia$|^Nipsey Hussle$|^Nirmala Devi$|^Nirvana$|^Nitty Gritty Dirt Band$|^Nitzer Ebb$|^Nivea$|^Niykee Heaton$|^NLE Choppa$|^NNN$|^No Doubt$|^No Use For A Name$|^No Vacation$|^Noah And The Whale$|^Noah Cyrus$|^Noah Kahan$|^Nobuo Uematsu$|^Noe Fajardo Y Su Orquesta$|^Noel Coward$|^Noel Rosa$|^Noel Torres$|^NOFX$|^Nohidea$|^Nomy$|^Nonpoint$|^Nonsense Stinks$|^Noor Jehan$|^Norah Jones$|^Norma Jean$|^Norma Tanega$|^Norman Blake$|^Norman Brown$|^Norman Connors$|^Norman Greenbaum$|^Noro Morales$|^NOTD$|^nothing$|^Nothing More$|^Novo Amor$|^Novos Baianos$|^NRBQ$|^Nuclear Assault$|^Nujabes$|^Numba 9$|^Nuno Soares$|^Nursery Rhymes$|^Nursery Rhymes 123$|^Nusrat Fateh Ali Khan$|^NxWorries$|^O\\.A\\.R\\.$|^O\\.T\\. Genasis$|^Oasis$|^Obie Trice$|^Obituary$|^October Country$|^Odd Future$|^ODESZA$|^Odetta$|^Odette Joyeux$|^Odyssey$|^Of Mice & Men$|^Of Monsters and Men$|^of Montreal$") == T, TRUE,
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.27 = ifelse(str_detect(main.artist, "^Offset$|^Ofra Haza$|^Ogden Nash$|^Oh Wonder$|^Ohio Express$|^Ohio Players$|^Oingo Boingo$|^OK Go$|^Ol Dirty Bastard$|^Old & In The Way$|^Old 97s$|^Old Crow Medicine Show$|^Old Dominion$|^Old Harp Singers of Eastern Tennessee$|^Oleta Adams$|^Olga Svendsen$|^Olga TaÃ±Ã³n$|^Oliver Hardy$|^Oliver Nelson$|^Oliver Tree$|^Olivia Holt$|^Olivia Newton-John$|^Olivia OBrien$|^Olivia Rodrigo$|^Olly Murs$|^Omar Apollo$|^Omar Ruiz$|^Omara Portuondo$|^Omarion$|^Onda Vaselina$|^One Direction$|^ONE OK ROCK$|^One Way$|^OneRepublic$|^ONIGAWARA$|^Only The Family$|^Onyx$|^Oompa Loompa Cast$|^Operation Ivy$|^Opeth$|^Orange Juice$|^Orbital$|^Orchestra$|^Orchestra Baobab$|^Orchestra Italiana Santa Lucia$|^Orchestra Studio 7$|^Orchestral Manoeuvres In The Dark$|^Orchestre Piero Coppola$|^Orgy$|^Original Broadway Cast Of Can-Can$|^Original Broadway Cast of Hamilton$|^Original Broadway Cast of Pal Joey$|^Original Broadway Cast of Three Wishes For Jamie$|^Original Broadway Cast of Top Banana$|^Orkestr Borisa Shermana$|^Orlando Silva$|^Orleans$|^Ornella Vanoni$|^Ornette Coleman$|^Orquesta AragÃ³n$|^Orquesta Bizarros$|^Orquesta Francisco Canaro$|^Orquesta Gran Casino$|^Orquesta Harlow$|^Orquesta Huambaly$|^Orquestra RomÃ¢nticos de Cuba$|^Os Cariocas$|^Os Mutantes$|^Os Originais Do Samba$|^Os Paralamas Do Sucesso$|^Oscar Brand$|^Oscar DLeÃ³n$|^Oscar Levant$|^Oscar Peterson$|^Oscar Peterson Quartet$|^Oscar Peterson Trio$|^Otakar Parik$|^Otis Redding$|^Otis Rush$|^Otis Spann$|^Ottmar Liebert$|^Otto Reutter$|^Ottokar Novacek$|^Ottorino Respighi$|^Ouija Macc$|^Our Lady Peace$|^Our Last Night$|^OutKast$|^Overkill$|^Owl City$|^Ozomatli$|^Ozuna$|^Ozzy Osbourne$|^P\\!nk$|^P\\. A\\. Periyanayaki$|^P\\. B\\. Sreenivas$|^P\\. Leela$|^P\\. Susheela$|^P\\. U\\. Chinnappa$|^P\\.M\\. Dawn$|^P\\.O\\.D\\.$|^P\\.Pinchink$|^PÃ©rez Prado$|^Pablo Abraira$|^Pablo AlborÃ¡n$|^Pablo Cruise$|^Pablo de Sarasate$|^Pablo Ruiz$|^Paco Aguilera$|^Paco BarrÃ³n y sus NorteÃ±os Clan$|^Paco de LucÃ­a$|^Paddy Reilly$|^Padmadevi$|^Pages$|^Pahola Marino$|^Paige Morehead$|^Palabra en AcciÃ³n$|^Palaraga$|^Palito Ortega$|^Paloma San Basilio$|^Palomo$|^Pam Tillis$|^Panchiko$|^Pancho Barraza$|^Panditrao Nagarkar$|^Pandora$|^Panic! At The Disco$|^Pankaj Mullick$|^Pannalal Bhattacharya$|^Panos Gavalas$|^Panos Visvardis$|^Panteon Rococo$|^Pantera$|^Paolo Nutini$|^Papa Roach$|^Papithbk$|^Paquita La Del Barrio$|^Paquito Guzman$|^Parachute$|^Paradosiako$|^Paradosiako I\\. KIriakatis$|^Paraguassu$|^Paramore$|^Paresh Banerjee$|^Paris Hilton$|^Parker McCollum$|^Parkway Drive$|^Parliament$|^Parmalee$|^Paro Devi$|^Parokya Ni Edgar$|^Parov Stelar$|^Parry Gripp$|^PARTYNEXTDOOR$|^Parul Ghosh$|^Passenger$|^Passion$|^Passion Pit$|^Pastor T\\.L\\. Barrett and the Youth for Christ Choir$|^Pastor Troy$|^Pasupuleti Kannamba$|^Pat Benatar$|^Pat Boone$|^Pat Carroll$|^Pat Green$|^Pat Metheny$|^Pat Metheny Group$|^Pat Travers Band$|^Patrice Rushen$|^Patricia TeherÃ¡n$|^Patricio Rey y sus Redonditos de Ricota$|^Patrick Cowley$|^Patrick Doyle$|^Patrick Hunt$|^Patrick Swayze$|^Patrick Watson$|^Patrulla 81$|^Patsy Cline$|^Patti Austin$|^Patti LaBelle$|^Patti LuPone$|^Patti Page$|^Patti Smith$|^Patty Griffin$|^Patty Loveless$|^Patty Pravo$|^Paul Amp$|^Paul Anka$|^Paul Barbarin & His New Orleans Jazz Band$|^Paul Bley$|^Paul Bridgwater$|^Paul Cardall$|^Paul Chambers$|^Paul Clayton$|^Paul Davis$|^Paul Desmond$|^Paul Dukas$|^Paul Hardcastle$|^Paul Hertzog$|^Paul Hindemith$") == T, TRUE,
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.28 = ifelse(str_detect(main.artist, "^Paul Horn$|^Paul Kandel$|^Paul Mauriat$|^Paul McCartney$|^Paul Petersen$|^Paul Revere & The Raiders$|^Paul Simon$|^Paul Stanley$|^Paul Wall$|^Paul Westerberg$|^Paul Weston$|^Paul Whiteman$|^Paul Whiteman & His Orchestra$|^Paul Williams$|^Paul Winter$|^Paul Young$|^Paula Abdul$|^Paula Cole$|^Paula DeAnda$|^Paula Tsui$|^Paulina Rubio$|^Pavement$|^PAW Patrol$|^Peabo Bryson$|^Peach Pit$|^Peaches$|^Peaches & Herb$|^Pearl Bailey$|^Pearl Jam$|^Pebbles$|^Pedrito FernÃ¡ndez$|^Pedro FernÃ¡ndez$|^Pedro Infante$|^Pedro Maffia$|^Pedro Quintero$|^Pee Wee King & His Golden West Cowboys$|^Pee Wee King and His Band$|^Pegboard Nerds$|^Peggy Lee$|^Peggy March$|^Peggy Seeger$|^Pello Revolvers$|^Pendulum$|^Penelope Scott$|^Penguin Cafe Orchestra$|^Penny and Sparrow$|^Pennywise$|^Pentangle$|^Pentatonix$|^People Under The Stairs$|^Pepe Aguilar$|^Pepe Tovar Y Los Chacales$|^Pepper$|^Perchicot$|^Percy Faith$|^Percy Faith & His Orchestra$|^Percy Faith & His Orchestra & Chorus$|^Percy Sledge$|^Perdikopoylos$|^Perfect$|^Perpetual Groove$|^Perry Como$|^Pesado$|^Pescado Rabioso$|^Pet Shop Boys$|^Pete Drake$|^Pete Fountain$|^Pete Rock$|^Pete Rock & C\\.L\\. Smooth$|^Pete Rodriguez$|^Pete Seeger$|^Pete Townshend$|^Pete Yorn$|^Peter$|^Peter and the Test Tube Babies$|^Peter Bjorn and John$|^Peter Cetera$|^Peter Cornelius$|^Peter Erasmus Lange-MÃ¼ller$|^Peter Frampton$|^Peter Gabriel$|^Peter Green$|^Peter Maxwell Davies$|^Peter Murphy$|^Peter Nero$|^Peter Palmer$|^Peter Sandberg$|^Peter Schilling$|^Peter Tosh$|^Peter White$|^Petey Pablo$|^Petit Biscuit$|^Petra$|^Petre Alexandru$|^Petros Epitropakis$|^Petula Clark$|^Phantogram$|^Pharoah Sanders$|^Pharrell Williams$|^Phil Collins$|^Phil Harris$|^Phil Keaggy$|^Phil Ochs$|^Phil Regan$|^Phil Silvers$|^Phil Vassar$|^Phil Wickham$|^Philip Aaberg$|^Philip Bailey$|^Philip Glass$|^Phillip Phillips$|^Phillipa Soo$|^Phillips$|^Philly Joe Jones Sextet$|^Phiroz Dastur$|^Phish$|^Phoebe Bridgers$|^Phoebe Snow$|^Phoenix$|^Phora$|^Phosphorescent$|^Phyllis Dillon$|^Phyllis Hyman$|^Pia Mia$|^Pieces Of A Dream$|^Pierce The Veil$|^Piero$|^Piero Piccioni$|^Pietro Mascagni$|^Pilot$|^Pimp C$|^Pimpinela$|^Pinakin Shah$|^Pinback$|^Pink Floyd$|^Pink Martini$|^Pink Sweat$$|^Pink Turns Blue$|^PIPER$|^Pirgaki Filio$|^Piso 21$|^Pistol Annies$|^Pitbull$|^Pithapuram Nageswara Rao$|^Pixies$|^Pixinguinha$|^PJ Harvey$|^Placebo$|^Plain White Ts$|^Plan B$|^Planet Patrol$|^Plastilina Mosh$|^Playa Limbo$|^Playboi Carti$|^Player$|^Pleasure P$|^Plies$|^Plumb$|^Plus Crier$|^PLVTINUM$|^PMW Studio Musicians$|^PnB Rock$|^Poco$|^Poe$|^Poison$|^PokÃ©mon$|^Polo G$|^Polo Urias Y Su Maquina NorteÃ±a$|^Polvo$|^Pooh$|^Pooh Shiesty$|^Pop Evil$|^Pop Smoke$|^Popol Vuh$|^Porcupine Tree$|^Porno for Pyros$|^PornoGraffitti$|^Porte Diferente$|^Porter Robinson$|^Porter Wagoner$|^Portishead$|^Portugal. The Man$|^Possessed$|^Post Malone$|^potsu$|^Pouya$|^Powerman 5000$|^PowerThoughts Meditation Club$|^Powerwolf$|^Powfu$|^ppcocaine$|^Pradeep Kumar$|^Pran$|^Pratima Banerjee$|^Prefab Sprout$|^Prem Adib$|^Premlata$|^Premlata Nayak$|^President Franklin Delano Roosevelt$|^Pretenders$") == T, TRUE,
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.29 = ifelse(str_detect(main.artist, "^Pretty Lights$|^Pretty Ricky$|^PRETTYMUCH$|^Primal Scream$|^Primitivo Y Su Combo$|^Primus$|^Prince$|^Prince Buster$|^Prince Royce$|^Priscilla Chan$|^Procol Harum$|^Prodromos Tsaousakis$|^Prodyut Narayan$|^Prof\\. Ramanand$|^Professor Longhair$|^Project Pat$|^Prong$|^Propaganda$|^Propagandhi$|^Proyecto Uno$|^prxz$|^Psychic TV$|^Psycoprata$|^Pt. Amarnath$|^Public Enemy$|^Public Image Ltd\\.$|^Puddle Of Mudd$|^Pulp$|^Punnamoyee Dasi$|^Pure Prairie League$|^Purity Ring$|^Purnakumari Dasi$|^Puscifer$|^Pusha T$|^Pushpa Hans$|^Pussycat$|^PXNDX$|^Pylon$|^Pyotr Ilyich Tchaikovsky$|^Q-Tip$|^Quad City DJs$|^Quality Control$|^Quarterflash$|^Quasimoto$|^Queen$|^Queen Latifah$|^Queen Naija$|^Queens of the Stone Age$|^QueensrÃ¿che$|^Quicksilver Messenger Service$|^Quiet Riot$|^Quincy Jones$|^Quinn XCII$|^R\\. A\\. DvorskÃ½$|^R\\. Carlos Nakai$|^R\\. D\\. Burman$|^R\\. Kelly$|^R\\.E\\.M\\.$|^R\\.H\\. Harris & His Gospel Paraders$|^R\\.K\\.M & Ken-Y$|^R\\.L\\. Burnside$|^R3HAB$|^RÃ©gulo Caro$|^RÃ¶yksopp$|^RaÃºl AbrÃ­l$|^Raavu Balasaraswathi$|^Rabindranath Tagore$|^Rabito$|^RAC$|^Racer X$|^Rachel Platten$|^Rachel Portman$|^Radharani$|^Radical Face$|^Radio Futura$|^Radiohead$|^Radney Foster$|^RADWIMPS$|^Rae Sremmurd$|^Raekwon$|^RaeLynn$|^Raffi$|^Rage Against The Machine$|^Raheem DeVaughn$|^Rahsaan Patterson$|^Rahsaan Roland Kirk$|^Railroad Earth$|^Raimonds Pauls$|^Rain Recorders$|^Rain Sound Studio$|^Rain Sounds$|^Rain Sounds Factory STHLM$|^Rain Storm Sample Library$|^Rainbow$|^Rainbow Kitten Surprise$|^RajÃ© Shwari$|^Rajkumari$|^Rakim$|^Ralfi Pagan$|^Ralph Burns$|^Ralph Stanley$|^Ralph Tresvant$|^Ralph Vaughan Williams$|^Ram Jam$|^Ramblin Jack Elliott$|^Ramdulari$|^Ramin Djawadi$|^Ramirez$|^Ramito$|^Rammstein$|^Ramola$|^Ramon Ayala$|^Ramon Ayala Y Sus Bravos Del Norte$|^Ramones$|^Rampyari$|^Ramsey Lewis$|^Ramsey Lewis Trio$|^Rancid$|^Randy Crawford$|^Randy Edelman$|^Randy Houser$|^Randy Newman$|^Randy Rogers Band$|^Randy Travis$|^RÃ­o Roma$|^RÃœFÃœS DU SOL$|^Raphael$|^Raphael Saadiq$|^Rappin 4-Tay$|^Raquel Meller$|^Raquel Rastenni$|^Rare Earth$|^Rascal Flatts$|^Raspberries$|^Rata Blanca$|^Ratatat$|^Ratikumar Vyas$|^Ratnaprabha$|^Ratt$|^Raul Di Blasio$|^Raul Garces$|^Raul Seixas$|^Raulin Rodriguez$|^Rauw Alejandro$|^Ravi$|^Ravi Shankar$|^Ray Anthony$|^Ray Anthony & His Orchestra$|^Ray Barretto$|^Ray Bolger$|^Ray Brown$|^Ray Charles$|^Ray Conniff$|^Ray J$|^Ray LaMontagne$|^Ray Lynch$|^Ray Parker Jr\\.$|^Ray Price$|^Ray Stevens$|^Ray Wylie Hubbard$|^Rayito Colombiano$|^Rayland Baxter$|^Raymond Scott$|^RBD$|^RBL Posse$|^Ready For The World$|^Reagan Youth$|^Real Estate$|^Real Life$|^Real McCoy$|^Reba McEntire$|^Rebel Son$|^Rebel Souljahz$|^Rebelution$|^Rebirth Brass Band$|^Reckless Kelly$|^Red$|^Red Foley$|^Red Garland$|^Red Garland Quintet$|^Red Garland Trio$|^Red Hot Chili Peppers$|^Red House Painters$|^Red Norvo & His Orchestra$|^Red Rider$|^Red Simpson$|^Red Sovine$|^Red Velvet$|^Redbone$|^Redimi2$|^Redman$|^Reel 2 Real$|^Reel Big Fish$|^Regard$|^Regina$|^Regina Belle$|^Regina Spektor$|^Regine Velasquez$|^Rehab$|^Reik$") == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.30 = ifelse(str_detect(main.artist, "^Relangi$|^Relient K$|^Remmy Valenzuela$|^RenÃ© CloÃ«rec$|^RenÃ© Urtreger$|^RenÃ©e Elise Goldsberry$|^RenÃ©e Zellweger$|^Renaissance$|^Renan Garcia$|^Renato Rascel$|^Rene & Angela$|^Renee Olstead$|^Renuka Devi$|^REO Speedwagon$|^Restless Heart$|^Return To Forever$|^Rev\\. Milton Brunson$|^Reverend J\\.M\\. Gates$|^Rewa Shankar$|^Rex Harrison$|^Rex Orange County$|^Rex Smith$|^Rey Ruiz$|^Reyli Barba$|^Reynaldo Hahn$|^Rhett Akins$|^Rhye$|^Ric Segreto$|^Ricardo Arjona$|^Ricardo Montaner$|^Ricardo Richie Ray$|^Ricardo Rodriguez$|^Riccardo Cocciante$|^Rich Brian$|^Rich Homie Quan$|^Rich Mullins$|^Rich The Kid$|^Richard & Linda Thompson$|^Richard Adler$|^Richard Arnell$|^Richard Elliot$|^Richard Groove Holmes$|^Richard Harris$|^Richard Himber and his Orchestra$|^Richard Levitt$|^Richard Marx$|^Richard OBrien$|^Richard Pryor$|^Richard Rodgers$|^Richard Strauss$|^Richard Thompson$|^Richard Wagner$|^Richie Havens$|^Richie Rich$|^Rick Astley$|^Rick James$|^Rick Moranis$|^Rick Ross$|^Rick Springfield$|^Rick Trevino$|^Rickie Lee Jones$|^Ricky Martin$|^Ricky Montgomery$|^Ricky Nelson$|^Ricky Skaggs$|^Ricky Van Shelton$|^Ricochet$|^Ride$|^Righeira$|^Rigo Tovar$|^Rihanna$|^Riley Green$|^Riley Lee$|^Rilo Kiley$|^Ringo Starr$|^Rino Gaetano$|^Riot$|^Rise Against$|^Rise Stevens$|^Rita Abatzi$|^Rita Ampatzi$|^Rita Coolidge$|^Rita Lee$|^Ritchie Valens$|^Rites of Spring$|^Rittz$|^Ritza Ampatzi$|^Rivermaya$|^Rixton$|^RJD2$|^RL Grime$|^RM$|^Roar$|^Rob Bailey & The Hustle Standard$|^Rob Base & DJ EZ Rock$|^Rob Thomas$|^Rob Zombie$|^Robbie Dupree$|^Robbie Robertson$|^Robbie Williams$|^Robert Alda$|^Robert Billig$|^Robert Cray$|^Robert David Hall$|^Robert de VisÃ©e$|^Robert Earl Keen$|^Robert Farnon$|^Robert Francis$|^Robert Fripp$|^Robert Frost$|^Robert Gordon$|^Robert Goulet$|^Robert Johnson$|^Robert Jysor$|^Robert Miles$|^Robert Mitchum$|^Robert Palmer$|^Robert Plant$|^Robert Preston$|^Robert Schumann$|^Robert Shaw Chorale$|^Robert Tepper$|^Robert Tree Cody$|^Robert Westenberg$|^Robert Wyatt$|^Roberta Flack$|^Roberto Carlos$|^Roberto Murolo$|^Roberto Pulido$|^Roberto Roena Y Su Apollo Sound$|^Roberto Tapia$|^Robin Gibb$|^Robin Majumdar$|^Robin Thicke$|^Robin Trower$|^Robin Williams$|^Robyn$|^RocÃ­o DÃºrcal$|^RocÃ­o Jurado$|^Rocio Banquells$|^Rock Projection$|^Rockabye Baby!$|^Rockabye Lullaby$|^Rockpile$|^Rockwell$|^Rod Stewart$|^Rod Wave$|^Roddy Ricch$|^Rodney Atkins$|^Rodney Carrington$|^Rodney Crowell$|^RodrÃ­guez$|^Rodrigo y Gabriela$|^Roedelius$|^Roger$|^Roger Bart$|^Roger Creager$|^Roger Daltrey$|^Roger Eno$|^Roger Hodgson$|^Roger McGuinn$|^Roger Miller$|^Roger Quilter$|^Roger Waters$|^Roger Williams$|^Rojo$|^Roky Erickson$|^Rolando AguilÃ³ y su Orquesta$|^ROLE MODEL$|^Rome$|^Romeo Santos$|^Romeo Void$|^Ron Carter$|^Ron Pope$|^Ronan Keating$|^Ronnie Dyson$|^Ronnie Foster$|^Ronnie Laws$|^Ronnie McDowell$|^Ronnie Milsap$|^Ronnie Self$|^Ronnie Wood$|^Ronny Jordan$|^Rooney$|^Rooprekha Chatterjee$|^Rory Gallagher$|^Ros Serey Sothea$|^ROSALÃ\u008dA$|^Rosanne Cash$|^Rosario$|^Rosario Dawson$|^Rose$|^Rose Royce$|^Rose Tattoo$|^Rosemary Clooney$|^Rosie & The Originals$|^Rosinha De ValenÃ§a$|^Ross Lynch$|^Roupa Nova$|^Roxette$") == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.31 = ifelse(str_detect(main.artist, "^Roxy Music$|^Roy Acuff$|^Roy Acuff & His Smoky Mountain Boys$|^Roy Ayers$|^Roy Ayers Ubiquity$|^Roy Buchanan$|^Roy Clark$|^Roy Eldridge$|^Roy Fox$|^Roy Hamilton$|^Roy Hargrove$|^Roy Harper$|^Roy Haynes$|^Roy Haynes Quartet$|^Roy Jones Jr.$|^Roy Orbison$|^Roy Rogers$|^Roy Webb$|^Roy Woods$|^Royal Blood$|^Roykoynas$|^Roza Eskenazi$|^RubÃ©n Blades$|^Rubby PÃ©rez$|^Ruben Gonzalez$|^Ruby And The Romantics$|^Ruby Braff$|^Rudi Schuricke$|^Rudimental$|^Rudy La Scala$|^Rudy Ray Moore$|^Rudyard Kipling$|^Ruel$|^Ruelle$|^Ruff Endz$|^Ruff Ryders$|^Rufus$|^Rufus & Chaka Khan$|^Rufus Thomas$|^Rufus Wainwright$|^Ruggero Leoncavallo$|^Rumblin Ruby$|^Run The Jewels$|^Runâ€“D.M.C.$|^RuPaul$|^Rupert Holmes$|^Ruperto ChapÃ­$|^Rush$|^Russ$|^Russ Morgan and His Orchestra$|^Russell Dickerson$|^Rusted Root$|^Rusty & Doug Kershaw$|^Ruth B.$|^Ruth Brown$|^Rvssian$|^Ry Cooder$|^Ryan Adams$|^Ryan Bingham$|^Ryan Caraveo$|^Ryan Gosling$|^Ryan Hurd$|^Ryan McCartan$|^Ryuichi Sakamoto$|^S Club 7$|^S. D. Batish$|^S. D. Burman$|^S. Loukopoulos$|^S. P. Balasubrahmanyam$|^S. Varalakshmi$|^S.N.Tripathi$|^S3RL$|^SÃ©rgio Mendes$|^SÃ©rgio Murillo$|^Saba$|^Sabah$|^Sabaton$|^Sabine Sommerkamp$|^Sabrina Carpenter$|^Sabrina Claudio$|^Sabu$|^Saccao$|^Sacha Guitry$|^Sad Lovers & Giants$|^Sada Baby$|^SadBoyProlific$|^Sade$|^SafetySuit$|^Safiye Ayla$|^Sage The Gemini$|^Sahana Devi$|^Saib$|^Saikat Mitra$|^Saint Etienne$|^SAINt JHN$|^Saint Motel$|^SALES$|^Salim Raza$|^Saliva$|^Sally Yeh$|^Salt-N-Pepa$|^Saltoy Maria$|^salvia palth$|^Sam & Dave$|^Sam Cooke$|^Sam Eskin$|^Sam Hui$|^Sam Hunt$|^Sam Manning$|^Sam Phillips$|^Sam Rivers$|^Sam Smith$|^Sam Spence$|^Sam Tinnesz$|^Samar Gupta$|^Sammy Adams$|^Sammy Davis Jr.$|^Sammy Hagar$|^Sammy Kaye and His Orchestra$|^Sammy Kershaw$|^Sample Rain Library$|^Samsa$|^Samuel A. Ward$|^Samuel Barber$|^Samuel E. Wright$|^Samuel HernÃ¡ndez$|^Samuray$|^San Holo$|^Sanchez$|^Sanctus Real$|^Sandhya Mukherjee$|^Sandi Patty$|^Sandie Shaw$|^Sandra$|^Sandro$|^Sandy Lam$|^Sandy Nelson$|^Santana$|^Santigold$|^Santo & Johnny$|^Santosh Sengupta$|^Saosin$|^Sara Bareilles$|^Sara Evans$|^Sarah McLachlan$|^Sarah Vaughan$|^Saraswati Rane$|^Sardar Akhtar$|^Sarita Devi$|^Sasha Sloan$|^Sassydee$|^Satinath Mukherjee$|^Satya Chowdhury$|^Satyen Ghosal$|^Savage$|^Savage Garden$|^Savatage$|^Saves The Day$|^Saving Abel$|^Savoy Brown$|^Saweetie$|^Sawyer Brown$|^Sax Man Mike Clark$|^Saxon$|^Say Anything$|^SAYGRACE$|^Scandal$|^Scarface$|^Scarlet DCarpio$|^Scary Kids Scaring Kids$|^Scatman John$|^ScHoolboy Q$|^Scissor Sisters$|^Scorpions$|^Scott McKenzie$|^Scott Walker$|^Scotty McCreery$|^Screamin Jay Hawkins$|^Screaming Trees$|^Screeching Weasel$|^Screwston$|^Scripture Lullabies$|^Scritti Politti$|^Sea Wolf$|^Seafret$|^Seal$|^Seals and Crofts$|^Seamus Kennedy$|^Sean Dagher$|^Sean Kingston$|^Sean Paul$|^SEATBELTS$|^Sebastian Yatra$|^Sech$|^Secondhand Serenade$|^Secos & Molhados$|^Secret Garden$|^Section 25$|^Seduction$") == T, TRUE,
                         ifelse(str_detect(main.artist, "(Royce Da)") == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.32 = ifelse(str_detect(main.artist, "^Seether$|^Selah$|^Selena$|^Selena Gomez$|^Selena Gomez & The Scene$|^Selena y los Dinos$|^Semisonic$|^Senses Fail$|^Sentidos Opuestos$|^Sepultura$|^Serafeim Gerotheodoroy$|^Serafim Gerotheodorou$|^SerÃº GirÃ¡n$|^Serge Chaloff$|^Serge Gainsbourg$|^Sergei Prokofiev$|^Sergei Rachmaninoff$|^Sergio Mendes & Brasil 66$|^Sergio Vargas$|^Sergio Vega El Shaka$|^Serj Tankian$|^Set It Off$|^Seth Ennis$|^Seven Lions$|^Seven Mary Three$|^Sevendust$|^Seweryn GoszczyÅ„ski$|^Sex Bob-Omb$|^Sex Pistols$|^Sexteto Habanero$|^Seyed Ali Asghar Kurdistani$|^Sezen Aksu$|^SG Lewis$|^Sgt. Barry Sadler$|^Sha Na Na$|^Shabba Ranks$|^Shadowfax$|^Shaggy$|^Shai$|^Shaila Devi$|^Shakatak$|^Shakey Graves$|^Shakira$|^Shalamar$|^Sham 69$|^Shamans Harvest$|^Shamim Akhtar$|^Shamshad Begum$|^Shane & Shane$|^Shania Twain$|^Shanice$|^Shankar$|^Shankar-Ehsaan-Loy$|^Shankar Dasgupta$|^Shankar Mahadevan$|^Shankar Rao Vyas$|^Shannon$|^Shannon Bolin$|^Shanta Apte$|^Shanta Hublikar$|^Shanti Sharma$|^Sharmila Roy Pommot$|^Sharon$|^Sharon Jones & The Dap-Kings$|^Sharon Van Etten$|^Sharpay Evans$|^Shaun Cassidy$|^Shawn Colvin$|^Shawn Mendes$|^She & Him$|^She Wants Revenge$|^SHeDAISY$|^Sheela$|^Sheena Easton$|^Sheff G$|^Sheila E\\.$|^Shel Silverstein$|^Sheldon Allman$|^Shelley Fabares$|^Shelly Manne & His Friends$|^Shenandoah$|^Sherman Edwards$|^Sheryl Crow$|^Shinedown$|^SHINee$|^Shinichi Yuize$|^Shiny Toy Guns$|^Shirley Bassey$|^Shirley Brown$|^Shirley Caesar$|^Shirley Ellis$|^Shirley Horn$|^Shirley Murdock$|^Shirley R. Cohen$|^Shizuka Kudo$|^Shobha$|^Shocking Blue$|^Shoes$|^Sholom Secunda$|^Shooting Star$|^Shoreline Mafia$|^Shorty Bralik$|^Shuggie Otis$|^Shungi Music Crew$|^Shwayze$|^Shyam Sunder$|^Shyamal Mitra$|^Shyne$|^Si Zentner$|^Sia$|^Sibylle Baier$|^Sick Puppies$|^SID$|^Sid King & The Five Strings$|^Side A$|^Sidewalk Prophets$|^Sidney Bechet$|^Sierra Nelson$|^Sigmund Romberg$|^Sigur RÃ³s$|^Sik World$|^Silk$|^Silkk The Shocker$|^Silu Wang$|^Silver Apples$|^Silver Convention$|^Silver Jews$|^Silverchair$|^Silverstein$|^Silversun Pickups$|^Silvio Caldas$|^Silvio RodrÃ­guez$|^SimÃ³n DÃ­az$|^Simon & Garfunkel$|^Simon Curtis$|^Simple Minds$|^Simple Plan$|^Simply Red$|^Sin Bandera$|^SinÃ©ad OConnor$|^Sinclair Lewis$|^Siouxsie and the Banshees$|^SiR$|^Sir Lancelot$|^Sir Mix-A-Lot$|^Sisqo$|^Sister Hazel$|^Sister Rosetta Tharpe$|^Sister Sledge$|^Sisters of Mercy$|^Sitara$|^Six$|^Sixpence None The Richer$|^Sixx:A\\.M\\.$|^Sizzla$|^Skeeter Davis$|^Ski Mask The Slump God$|^Skid Row$|^Skillet$|^Skinny Puppy$|^Skizzy Mars$|^Skrillex$|^Sky Cries Mary$|^Skyy$|^Slade$|^SLANDER$|^Slash$|^Slaughter$|^Slave$|^Slayer$|^Sleater-Kinney$|^Sleep$|^Sleep Baby Sleep$|^Sleeping At Last$|^Sleeping With Sirens$|^Sleepy Hallow$|^Sleigh Bells$|^Slick Rick$|^Slightly Stoopid$|^Slim Gaillard$|^Slim Thug$|^Slim Whitman$|^Slint$|^Slipknot$|^Slowburner$|^Slowdive$|^Slum Village$|^Sly & The Family Stone$|^Small Faces$|^Small Island Pride$|^Smallpools$|^Smash Mouth$|^Smif-N-Wessun$|^Smino$|^SMO$|^Smog$|^Smoke Ring$|^Smokepurpp$|^Smokey Robinson$|^Smokey Robinson & The Miracles$") == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.33 = ifelse(str_detect(main.artist, "^Smokie$|^Smokie Norful$|^Smt. Angurbala Devi$|^Snakehips$|^SNAP\\!$|^SNBRN$|^Sneaker Pimps$|^Sneeky Dee$|^Snehprabha$|^Snehprabha Pradhan$|^Snoh Aalegra$|^Snoop Dogg$|^Snot$|^Snow Patrol$|^SOB X RBE$|^Social Distortion$|^Soda Stereo$|^Sodom$|^Sofia Karivali$|^Sofia Vempo$|^Soft Cell$|^Soft Machine$|^Soil$|^SOJA$|^Solange$|^Solido$|^Solomon Burke$|^Something Corporate$|^SoMo$|^Son Seals$|^Son Volt$|^Songs: Ohia$|^Sonia Lopez$|^Sonic Youth$|^Sonido Mazter$|^Sonny & Cher$|^Sonny Boy Williamson I$|^Sonny Boy Williamson II$|^Sonny Clark$|^Sonny Davis$|^Sonny James$|^Sonny Rollins$|^Sonny Rollins Quartet$|^Sonny Stitt$|^Sonny Terry$|^Sono$|^Sonora PonceÃ±a$|^Sons of the Pioneers$|^Sonu Nigam$|^Sophie B. Hawkins$|^Sorority Noise$|^Sotiria Bellou$|^Sotiris Stasinopoulos$|^Soul Asylum$|^Soul Coughing$|^Soul For Real$|^Soul II Soul$|^Soula Karagiorgi$|^Soulfly$|^Soulja Boy$|^Souls Of Mischief$|^Sound Library XL$|^Soundgarden$|^Sounds Of Blackness$|^South Border$|^South Park Mexican$|^Southside Johnny And The Asbury Jukes$|^Space$|^Spandau Ballet$|^Spanky & Our Gang$|^Sparklehorse$|^Sparks$|^Spawnbreezie$|^Speaker Knockerz$|^Special Ed$|^Spectre General$|^Speed Gang$|^Speedy West$|^Spice 1$|^Spice Girls$|^Spike Jones$|^Spike Jones Orchestra$|^Spillage Village$|^Spin Doctors$|^Spinal Tap$|^Spineshank$|^Spirit$|^Spiritualized$|^Split Enz$|^Sponge$|^Spongebob Squarepants$|^Spoon$|^Springtoifel$|^SPYAIR$|^Spyro Gyra$|^Squeeze$|^Squirrel Nut Zippers$|^SR-71$|^Sridhar Parsekar$|^St Germain$|^St. Louis Jesuits$|^St. Lucia$|^St. Paul & The Broken Bones$|^StÃ©phane Grappelli$|^Staatskapelle Dresden$|^Stabbing Westward$|^Stacey Kent$|^Stacy Lattisaw$|^Staind$|^Stan Bush$|^Stan Getz$|^Stan Getz Quartet$|^Stan Kenton$|^Stan Kenton & His Orchestra$|^Stan Rogers$|^Stan Whitmire$|^Stanley Clarke$|^Stanley Donen$|^Stanley Holloway$|^Stanley Turrentine$|^Stars$|^Stars On 45$|^STARSET$|^Starship$|^State Champs$|^Stathis Kavouras$|^Stathis Koukoularis$|^Static-X$|^Status Quo$|^Stavros Tzouanakos$|^Stealers Wheel$|^Steel Panther$|^Steel Pulse$|^Steeleye Span$|^STEELHEART$|^Steely Dan$|^Stefanie Sun$|^Stefano Torossi$|^Stelios Kazantzidis$|^Stella Xaskil$|^Stellakis Perpiniadis$|^Stephanie Mills$|^Stephen Bishop$|^Stephen Marley$|^Stephen Schwartz$|^Stephen Sondheim$|^Stephen Speaks$|^Stephen Stills$|^Steppenwolf$|^Steps$|^Stereo MCs$|^Stereolab$|^Stereophonics$|^Sterling Brown$|^Stetsasonic$|^Steve Aoki$|^Steve Correll Group$|^Steve Earle$|^Steve Erquiaga$|^Steve Green$|^Steve Hackett$|^Steve Holy$|^Steve Jablonsky$|^Steve Lacy$|^Steve Lawrence$|^Steve Martin$|^Steve Miller Band$|^Steve Perry$|^Steve Roach$|^Steve Stills$|^Steve Tyrell$|^Steve Vai$|^Steve Wariner$|^Steve Winwood$|^Steve Young$|^Steven Curtis Chapman$|^Steven Halpern$|^Steven Sharp Nelson$|^Steven Universe$|^Steven Wright$|^Stevie B$|^Stevie Nicks$|^Stevie Ray Vaughan$|^Stevie Wonder$|^Stick Figure$|^Sticky Fingers$|^Stiff Little Fingers$|^Still Woozy$|^Sting$|^Stompin Tom Connors$|^Stone Poneys$|^Stone Sour$|^Stone Temple Pilots$|^Stonewall Jackson$|^Stoney LaRue$|^Story Of The Year$|^Straight No Chaser$|^Stranger Cole$|^Stratos Pagioumtzis$|^Strawberry Alarm Clock$") == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.34 = ifelse(str_detect(main.artist, "^Strawberry Switchblade$|^Strawbs$|^Stray Cats$|^Stray Kids$|^Streetheart$|^Streetlight Manifesto$|^STRFKR$|^Stroke 9$|^Stromae$|^Strung Out$|^Stryper$|^Stubby Kaye$|^Studio Chorus - Saludos Amigos$|^Studio Musicians$|^Stunna 4 Vegas$|^Sturgill Simpson$|^Styles P$|^Styx$|^Subhumans$|^Sublime$|^Sublime With Rome$|^Suburban Lawns$|^Suchitra Mitra$|^Sudha Malhotra$|^Sudha Mukherjee$|^Sudhir Phadke$|^Sue Thompson$|^Suffocation$|^Sufjan Stevens$|^Suga Free$|^Sugar$|^Sugar Chile Robinson$|^Sugar Ray$|^Sugarcult$|^Sugarland$|^Sui Generis$|^Suicidal Tendencies$|^Suicide$|^Suicide Silence$|^Sujan Majhi$|^Sulochana$|^Sulochana Kadam$|^Sum 41$|^Suman Kalyanpur$|^Summer Salt$|^Summer Walker$|^Sumo$|^Sun Ra$|^Sundef$|^Sunder Singh$|^Sunetra$|^Sunny Day Real Estate$|^Supafriendz$|^Supantho Basu$|^Super Cat$|^Super Grupo Colombia$|^Superchunk$|^Supergrass$|^Supertramp$|^Supriti Ghosh$|^Suprova Ghosh$|^Suraiya$|^Surendra$|^Surendranath$|^Suresh Wadkar$|^SURF$|^Surf Curse$|^Surface$|^Surfaces$|^Surinder Kaur$|^Survivor$|^Susan Cadogan$|^Susan Egan$|^Susan Sarandon$|^Sushila Rani$|^Sutton Foster$|^Suzanne Vega$|^Suzi Quatro$|^Suzy Bogguss$|^Suzy Delair$|^Svend Asmussen$|^Svend Asmussens Kvintet$|^Swae Lee$|^Swans$|^Swedish House Mafia$|^Sweet$|^Sweet Sensation$|^Sweet Trip$|^Sweethearts of the Rodeo$|^Sweetwater$|^Swing Out Sister$|^Swirlies$|^Switch$|^Switchfoot$|^SWV$|^Sy Oliver$|^Sybil$|^Syd Dale$|^Syl Johnson$|^Sylvan Esso$|^Sylvester$|^Sylvia de Grasse$|^Sylvia Rexach$|^SYML$|^Syreeta$|^System Of A Down$|^SZA$|^T-Bone Walker$|^T-Dre$|^T-Pain$|^T. Graham Brown$|^T. M. Soundararajan$|^T. R. Mahalingam$|^T. Rex$|^T. S. Bhagavathi$|^T. S. Eliot$|^t\\.A\\.T\\.u\\.$|^T.G. Sheppard$|^T\\.I\\.$|^T.O Suprapto$|^T\\.S\\.O\\.L\\.$|^T3R Elemento$|^TÃ©lÃ©phone$|^Tabet$|^Tadd Dameron$|^Tadd Dameron Sextet$|^Taeko Onuki$|^TAEYANG$|^Tainy$|^Taio Cruz$|^Taj Mahal$|^Take 6$|^Take That$|^Taking Back Sunday$|^Takis Karnavas$|^Takis Nikolaou$|^Tal Farlow$|^Talat Mahmood$|^Talib Kweli$|^Talk Talk$|^Talking Heads$|^Tall Heights$|^Tally Hall$|^TamÃ¡s Cseh$|^Tamar Braxton$|^Tame Impala$|^Tamia$|^Tammy Wynette$|^Tangerine Dream$|^Tanguturi Suryakumari$|^Tank$|^Tantric$|^Tanya Goodman$|^Tanya Tucker$|^Taproot$|^Tara$|^Tara Bai$|^Tarun Banerjee$|^Tasha Cobbs Leonard$|^Tasia Verra$|^Taste$|^Tate McRae$|^Tauren Wells$|^Tavares$|^Tay-K$|^Taylor Dayne$|^Taylor Ray Holbrook$|^Taylor Swift$|^Tear Da Club Up Thugs$|^Tears For Fears$|^Tech N9ne$|^Tech N9ne Collabos$|^Technotronic$|^Ted Hawkins$|^Ted Heath$|^Ted Neeley$|^Ted Nugent$|^Ted Weems & His Orchestra$|^Teddi King$|^Teddy Pendergrass$|^Teddy Petersens Koncertorkester og kor$|^Teddy Wilson$|^Tedeschi Trucks Band$|^Tee Grizzley$|^Teen Suicide$|^Teena Marie$|^Teenage Fanclub$|^Tegan and Sara$|^Tego Calderon$|^Television$|^Temple Of The Dog$|^Ten Years After$|^Tenacious D$|^Tennessee Ernie Ford$|^Tenth Avenue North$|^Teodoro Reyes$|^Teqkoi$|^Tercer Cielo$|^Terence Trent DArby$|^Teresa Teng$") == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))))
  )



spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.35 = ifelse(str_detect(main.artist, "^Terrence Mann$|^Terri Clark$|^Terry Callier$|^Terry Reid$|^Tesla$|^Testament$|^Tevin Campbell$|^Tex Beneke$|^Tex Tex$|^Tex Williams$|^Texas$|^Texas Tornados$|^Teyana Taylor$|^Tha Dogg Pound$|^Thad Fiscella$|^Thad Jones$|^Thalia$|^Thanasis Eugenikos$|^Thanasis Kavourakis$|^Thanasis Varsamas$|^The-Dream$|^The 1937 Flood$|^The 1975$|^The 5 Heartbeats$|^The 5th Dimension$|^The Academy Is\\.\\.\\.$|^The Action$|^The Adicts$|^The Adverts$|^The Afters$|^The Alan Parsons Project$|^The Alarm$|^The Album Leaf$|^The All-American Rejects$|^The Almanac Singers$|^The Amboina Serenaders$|^The Amboy Dukes$|^The Ames Brothers$|^The Amity Affliction$|^The Andrews Sisters$|^The Angels$|^The Animals$|^The Aquabats!$|^The Archies$|^The Art Of Noise$|^The Association$|^The Ataris$|^The Avalanches$|^The Avett Brothers$|^The B-52s$|^The Babys$|^The Band$|^The Band CAMINO$|^The Band Of Heathens$|^The Band Perry$|^The Bangles$|^The Bar-Kays$|^The Barry Sisters$|^The Beach Boys$|^The Beatles$|^The Beatnuts$|^The Beau Brummels$|^The Beautiful South$|^The Bellamy Brothers$|^The Belle Stars$|^The Ben Webster Quintet$|^The Beta Band$|^The Big Bopper$|^The Birthday Party$|^The Black Crowes$|^The Black Keys$|^The Blackbyrds$|^The Blasters$|^The Blue Nile$|^The Blue Stars$|^The Bluegrass Album Band$|^The Blues Brothers$|^The Blues Magoos$|^The Blues Project$|^The Bobby Fuller Four$|^The Bonzo Dog Band$|^The Boomtown Rats$|^The Bouncing Souls$|^The Box Tops$|^The Boys$|^The Brady Bunch$|^The Bravery$|^The Breeders$|^The Brian Jonestown Massacre$|^The Brian Setzer Orchestra$|^The Brobecks$|^The Brothers Cazimero$|^The Brothers Four$|^The Brothers Johnson$|^The Buckinghams$|^The Budos Band$|^The Buffalo Bills$|^The Buggles$|^The Business$|^The Buttertones$|^The Byrds$|^The Cab$|^The Cadillacs$|^The California Honeydrops$|^The Call$|^The Cannonball Adderley Quintet$|^The Canton Spirituals$|^The Cardigans$|^The Cars$|^The Carter Family$|^The Carter Sisters$|^The Cascades$|^The Casino Royal$|^The Castells$|^The Cats$|^The Chainsmokers$|^The Challengers$|^The Chambers Brothers$|^The Chameleons$|^The Champs$|^The Channels$|^The Chantays$|^The Charlie Daniels Band$|^The Cheetah Girls$|^The Chemical Brothers$|^The Chenille Sisters$|^The Chi-Lites$|^The Chicks$|^The Chico Hamilton Quintet$|^The Chieftains$|^The Chinese Cultural Theatre Group$|^The Chocolate Watchband$|^The Chordettes$|^The Chords$|^The Church$|^The Cinematic Orchestra$|^The Citizens of Halloween$|^The City of Prague Philharmonic Orchestra$|^The Civil Wars$|^The Clancy Brothers$|^The Clark Sisters$|^The Clash$|^The Cleaners From Venus$|^The Cleftones$|^The Click$|^The Clovers$|^The Coasters$|^The Collins Kids$|^The Commitments$|^The Congos$|^The Connells$|^The Cookies$|^The Corrs$|^The Cotton Candy Blues Band$|^The Countdown Kids$|^The Cover Girls$|^The Cowsills$|^The Cramps$|^The Cranberries$|^The Crickets$|^The Crusaders$|^The Crystal Method$|^The Crystals$|^The Cult$|^The Cure$|^The Cyrkle$|^The D\\.O\\.C\\.$|^The Damned$|^The Dandy Warhols$|^The Darkness$|^The Dave Brubeck Quartet$|^The Dave Clark Five$|^The Dawn$|^The Dayton Family$|^The dBs$|^The De Castro Sisters$|^The Dead Milkmen$|^The Decemberists$|^The Deele$|^The Del-Vikings$|^The Delfonics$|^The Dells$|^The Derek Trucks Band$|^The Devil Makes Three$|^The Devil Wears Prada$|^The Dickies$|^The Dillards$|^The Dillinger Escape Plan$|^The Diplomats$|^The Disney Holiday Chorus$|^The Distillers$|^The Dixie Cups$|^The Doobie Brothers$|^The Doors$|^The Dovells$|^The Dramatics$|^The Dreadnoughts$|^The Dream Academy$|^The Drifters$|^The Drums$") == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.36 = ifelse(str_detect(main.artist, "^The Dubliners$|^The Dubs$|^The Dukes Of Dixieland$|^The Duprees$|^The Durutti Column$|^The Dwarf Chorus$|^The Easybeats$|^The Ebonys$|^The Edgar Winter Group$|^The Edwin Hawkins Singers$|^The Egyptian Lover$|^The Electric Flag$|^The Electric Prunes$|^The Emotions$|^The Equatics$|^The Eric Rogers Chorale and Orchestra$|^The Ethiopians$|^The Everly Brothers$|^The Executor$|^The Expendables$|^The Exploited$|^The Fabulous Thunderbirds$|^The Fall$|^The Firm$|^The Fisk Jubilee Singers$|^The Five Satins$|^The Fixx$|^The Flaming Lips$|^The Flamingos$|^The Fleetwoods$|^The Flying Burrito Brothers$|^The Focsle Singers$|^The Forester Sisters$|^The Format$|^The Foundations$|^The Four Aces$|^The Four Freshmen$|^The Four Lads$|^The Fratellis$|^The Fray$|^The Free Design$|^The Friends Of Distinction$|^The Frights$|^The Front Bottoms$|^The Fugs$|^The Game$|^The Gap Band$|^The Garden$|^The Gaslight Anthem$|^The Georgia Satellites$|^The Get Up Kids$|^The Gil Evans Orchestra$|^The Glitch Mob$|^The Gns Band$|^The Go-Gos$|^The Goo Goo Dolls$|^The Grass Roots$|^The Greatest Bits$|^The Green$|^The Greg Kihn Band$|^The Gregg Allman Band$|^The Groundhogs$|^The Growlers$|^The Guess Who$|^The Gun Club$|^THE GUY$|^The Happenings$|^The Harvard Krokodiloes$|^The Hates$|^The Head and the Heart$|^The Heavy$|^The Heptones$|^The High Kings$|^The Highwaymen$|^The Hives$|^The Hollies$|^The Hollywood Four Blazes$|^The Honeydrippers$|^The Hoosiers$|^The Hooters$|^The Housemartins$|^The Human League$|^The Hush Sound$|^The Imperials$|^The Impressions$|^The Incredible String Band$|^The Ink Spots$|^The Internet$|^The Intruders$|^The Irish Rovers$|^The Isley Brothers$|^The J. Geils Band$|^The J.B.s$|^The Jackson 5$|^The Jackson Southernaires$|^The Jacksons$|^The Jam$|^The Jayhawks$|^The Jeff Healey Band$|^The Jesters$|^The Jesus and Mary Chain$|^The Jesus Lizard$|^The Jets$|^The Jim Carroll Band$|^The Jimmy Castor Bunch$|^The Johnny Smith Quintet$|^The Jon Spencer Blues Explosion$|^The Jones Girls$|^The Judds$|^The Kentucky Headhunters$|^The Kiboomers$|^The Kid LAROI$|^The Killers$|^The Kings$|^The Kingston Trio$|^The Kinks$|^The Knack$|^The Knife$|^The Kooks$|^The Kossoy Sisters$|^The Lacs$|^The Larks$|^The Las$|^The Last Mr. Bigg$|^The Last Shadow Puppets$|^The Latin Brothers$|^The Latin Jazz Quintet$|^The Laurie Berkner Band$|^The Left Banke$|^The Lemonheads$|^The Lettermen$|^The Libertines$|^The Lightning Seeds$|^The Limeliters$|^The Lion$|^The Lively Ones$|^The Living End$|^The Living Tombstone$|^The London Suede$|^The Lonely Island$|^The Lounge Lizards$|^The Louvin Brothers$|^The Lovin Spoonful$|^The LOX$|^The Lumineers$|^The Mad Lads$|^The Magnetic Fields$|^The Main Ingredient$|^The Maine$|^The Mamas & The Papas$|^The Manhattan Pops$|^The Manhattan Transfer$|^The Manhattans$|^The Mar-Keys$|^The MarÃ­as$|^The Marcels$|^The Mars Volta$|^The Marshall Tucker Band$|^The Marvelettes$|^The Mavericks$|^The Maytals$|^The McGuire Sisters$|^The Merlons$|^The Meters$|^The Microphones$|^The Midnight$|^The Mighty Mighty Bosstones$|^The Millennium$|^The Mills Brothers$|^The Miracles$|^The Mission$|^The Modern Jazz Quartet$|^The Modern Lovers$|^The Moments$|^The Monkees$|^The Monks$|^The Moody Blues$|^The Moonglows$|^The Motels$|^The Mothers Of Invention$|^The Mountain Goats$|^The Mowglis$|^The Munchkins$|^The Muppets$|^The Music Machine$|^The Naked And Famous$|^The National$|^The National Parks$|^The Neighbourhood$|^The Neville Brothers$|^The New Birth$|^The New Christy Minstrels$|^The New Life Community Choir$|^The New Lost City Ramblers$|^The New Pornographers$|^The New Stan Getz Quartet$|^The New Year Hit Makers$|^The Norman Luboff Choir$|^The Notorious B\\.I\\.G\\.$|^The Oak Ridge Boys$") == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.37 = ifelse(str_detect(main.artist, "^The Ocean Blue$|^The Offspring$|^The Oh Hellos$|^The OJays$|^The Olympics$|^The Only Ones$|^The Orchestra Nepolitan$|^The Original Broadway Cast Of Of Thee I Sing$|^The Originals$|^The Orion Experience$|^The Orlons$|^The Oscar Brown Jazz Trio$|^The Osmonds$|^The Outfield$|^The Outlaws$|^The Ozark Mountain Daredevils$|^The Paper Kites$|^The Paragons$|^The Partridge Family$|^The Paul Butterfield Blues Band$|^The Percy Faith Strings$|^The Pharcyde$|^The Piano Guys$|^The Pied Pipers$|^The Pirates Of Penzance$|^The Platters$|^The Plimsouls$|^The Pogues$|^The Pointer Sisters$|^The Police$|^The Postal Service$|^The Power Station$|^The Presidents Of The United States Of America$|^The Pretty Reckless$|^The Pretty Things$|^The Prisonaires$|^The Proclaimers$|^The Prodigy$|^The Psychedelic Furs$|^The Pussycat Dolls$|^The Raconteurs$|^The Rain Library$|^The Raincoats$|^The Rapture$|^The Rascals$|^The Ravens$|^The Ray Bryant Trio$|^The Ray Conniff Singers$|^The Real McKenzies$|^The Red Army Choir$|^The Red Jumpsuit Apparatus$|^The Refreshments$|^The Remains$|^The Rembrandts$|^The Replacements$|^The Reverend Horton Heat$|^The Revivalists$|^The Rezillos$|^The Righteous Brothers$|^The Rip Chords$|^The Rippingtons$|^The Ritchie Family$|^The Rivieras$|^The Roberta Martin Singers$|^The Roches$|^The Rolling Stones$|^The Romantics$|^The Ronettes$|^The Roots$|^The Royal Guardsmen$|^The Royal Victoria Hotel Calypsos$|^The Runaways$|^The Ruts$|^The S\\.O\\.S Band$|^The Salsoul Orchestra$|^The Samples$|^The Sandpipers$|^The Sapphires$|^The Score$|^The Script$|^The Searchers$|^The Seeds$|^The Seekers$|^The Selecter$|^The Shadows$|^The Shadows Of Knight$|^The Shangri-Las$|^The Shins$|^The Shirelles$|^The Silhouettes$|^The Skatalites$|^The Skyliners$|^The Sleep Helpers$|^The Slits$|^The Smashing Pumpkins$|^The Smithereens$|^The Smiths$|^The Smothers Brothers$|^The Soft Winds$|^The Soggy Bottom Boys$|^The Song Swappers$|^The Sonics$|^The Soul Stirrers$|^The Sound$|^The Souther-Hillman-Furay Band$|^The Specials$|^The Spencer Davis Group$|^The Spill Canvas$|^The Spinners$|^The Standells$|^The Stanley Brothers$|^The Staple Singers$|^The Starting Line$|^The Statler Brothers$|^The Steeldrivers$|^The Stills-Young Band$|^The Stone Roses$|^The Stooges$|^The Story So Far$|^The Strangeloves$|^The Stranglers$|^The String Cheese Incident$|^The Strokes$|^The Style Council$|^The Stylistics$|^The Sugarcubes$|^The Sugarhill Gang$|^The Suicide Machines$|^The Sundays$|^The Supremes$|^The Surfaris$|^The Surfmen$|^The Sweet Inspirations$|^The Sweetback Sisters$|^The Sylvers$|^The System$|^The Tallest Man On Earth$|^The Teardrop Explodes$|^The Techniques$|^The Temper Trap$|^The Temprees$|^The Temptations$|^The The$|^The Three Degrees$|^The Three Sounds$|^The Three Stooges$|^The Three Suns$|^The Tiger$|^The Time$|^The Tokens$|^The Tornados$|^The Tragically Hip$|^The Trammps$|^The Trashmen$|^The Tremeloes$|^The Troggs$|^The Tubes$|^The Turtles$|^The Tymes$|^The Undertones$|^The Undisputed Truth$|^The Union Underground$|^The United States Of America$|^The Upsetters$|^The Used$|^The Vaccines$|^The Valentinos$|^The Vamps$|^The Vandals$|^The Vaughan Brothers$|^The Velvet Underground$|^The Ventures$|^The Verve$|^The Verve Pipe$|^The Veterinary Street Jazz Band$|^The Vibrators$|^The Village Stompers$|^The Vogues$|^The Voices Of Walter Schumann$|^The Wailers$|^The Wailin Jennys$|^The Waitresses$|^The Walker Brothers$|^The Wallflowers$|^The Walters$|^The Wanted$|^The War On Drugs$|^The Waterboys$|^The Weakerthans$|^The Weather Girls$|^The Weeknd$|^The West Coast Pop Art Experimental Band$|^The Whispers$|^The White Buffalo$|^The White Stripes$|^The Whitest Boy Alive$|^The Who$|^The Wiggles$|^The Williams Brothers$|^The Winans$") == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.38 = ifelse(str_detect(main.artist, "^The Wombats$|^The Wonder Years$|^The Wood Brothers$|^The xx$|^The Yardbirds$|^The Young Rascals$|^The Youngbloods$|^The Zombies$|^TheFatRat$|^Thelma Houston$|^Thelonious Monk$|^Thelonious Monk Quartet$|^Thelonious Monk Quintet$|^Thelonious Monk Septet$|^Thelonious Monk Trio$|^Them$|^Them Crooked Vultures$|^Theodore Bikel$|^Theory of a Deadman$|^They Might Be Giants$|^They Might Be Giants \\(For Kids\\)$|^Thievery Corporation$|^Thin Lizzy$|^Third Day$|^Third Eye Blind$|^Third World$|^Thirty Seconds To Mars$|^This Heat$|^This Mortal Coil$|^This Will Destroy You$|^Thom Yorke$|^Thomas Arne$|^Thomas Bergersen$|^Thomas Dolby$|^Thomas Moore$|^Thomas Newman$|^Thomas Rhett$|^Thompson Square$|^Thompson Twins$|^Thouraya Helmy$|^Thousand Foot Krutch$|^Three 6 Mafia$|^Three Days Grace$|^Three Dog Night$|^Three Plus$|^Thrice$|^Throbbing Gristle$|^Thug Life$|^Thunder$|^Thundercat$|^Thunderstorm$|^Thunderstorm Sound Bank$|^Thurl Ravenscroft$|^Thursday$|^Tia Blake$|^TiÃ«sto$|^Tierra Cali$|^Tiffany$|^Tiger Army$|^Til Tuesday$|^Tim Buckley$|^Tim Curry$|^Tim Hardin$|^Tim Maia$|^Tim McGraw$|^Timbaland$|^Timbiriche$|^Timeflies$|^Timi Yuro$|^TIN TAN Y MARCELO$|^Tina Brooks$|^Tina Turner$|^Tink$|^Tino Rossi$|^Tiny Meat Gang$|^Tiny Tim$|^Titi Botez$|^Tito El Bambino$|^Tito Nieves$|^Tito Puente$|^Tito Puente & His Orchestra$|^Tito Rodriguez$|^Tito Rodriguez & His Orchestra$|^Tito Rojas$|^Tito Rojas Y Su Orquesta$|^Tito Schipa$|^TKA$|^TLC$|^Tmsoftâ€™s White Noise Sleep Sounds$|^ToÃ±o Escobar Y Sus Locos$|^ToÃ±o Rosario$|^Toad The Wet Sprocket$|^Toadies$|^tobi lou$|^Toby Fox$|^Toby Keith$|^Toby Love$|^TobyMac$|^Todd Rundgren$|^Todd Snider$|^TOKYOâ€™S REVENGE$|^Tom Browne$|^Tom Felton$|^Tom Jones$|^Tom Lehrer$|^Tom MacDonald$|^Tom Misch$|^Tom Odell$|^Tom Paxton$|^Tom Petty$|^Tom Petty and the Heartbreakers$|^Tom Rush$|^Tom T. Hall$|^Tom Tom Club$|^Tom Waits$|^Tom ZÃ©$|^Tomas Ballicora$|^Tommy Bolin$|^Tommy Dorsey$|^Tommy Dorsey & His Clambake Seven$|^Tommy Flanagan$|^Tommy Flanagan Trio$|^Tommy James & The Shondells$|^Tommy Olivencia$|^Tommy Olivencia y Su Orquesta$|^Tommy Roe$|^TOMORROW X TOGETHER$|^Tomppabeats$|^Tone-Loc$|^Tones And I$|^Tones On Tail$|^Toni Braxton$|^Tonic$|^Tony Bennett$|^Tony Burrello$|^Tony Dize$|^Tony Fruscella$|^Tony Jay$|^Tony Joe White$|^Tony Orlando & Dawn$|^Tony Rice$|^Tony Rice Unit$|^Tony Russo$|^Tony Schwartz$|^Tony Scott$|^Tony Vega$|^Tony! Toni! TonÃ©!$|^Too $hort$|^TOOL$|^Toots & The Maytals$|^Toots Thielemans$|^Toploader$|^Topol$|^Toquinho$|^Tori Amos$|^Tori Kelly$|^Tormenta$|^Toro y Moi$|^Tory Lanez$|^TotÃ²$|^Total$|^TOTO$|^Toto Cutugno$|^Tove Lo$|^Tower Of Power$|^Townes Van Zandt$|^TPau$|^Trace Adkins$|^Tracy Byrd$|^Tracy Chapman$|^Tracy Lawrence$|^Trade Martin$|^Traditional$|^Traffic$|^Train$|^Tramaine Hawkins$|^Trampled by Turtles$|^Trans-Siberian Orchestra$|^Trans-X$|^Transplants$|^Tranzas$|^TrÃ­o Los Chamas$|^Trapt$|^Traveling Wilburys$|^Traviezoz de la Zierra$|^Travis$|^Travis Porter$|^Travis Scott$|^Travis Tritt$|^Trebol Clan$|^Trent Reznor and Atticus Ross$|^Trevor Daniel$|^Trevor Hall$|^Trevor Jones$|^Trevor Rabin$|^Trey Anastasio$|^Trey Songz$|^Treyarch$|^Tribal Seeds$|^Trick Daddy$") == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))))))))
  )


spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.39 = ifelse(str_detect(main.artist, "^Tricky$|^Trillville$|^Trina$|^Triny La Leyenda$|^Trio Aguilillas$|^Trio Lescano$|^Trio Los Condes$|^Trio Maravilla$|^Trio Surdina$|^Trippie Redd$|^Trisha Yearwood$|^Tristam$|^Triumph$|^Trivium$|^Trixter$|^Troop$|^Trooper$|^Tropical PanamÃ¡$|^TropicalÃ­simo Apache$|^Troy$|^Troye Sivan$|^Tryhardninja$|^Tsai Chin$|^Tsegue-Maryam Guebrou$|^Tubeway Army$|^Tuck & Patti$|^Tuck Andress$|^Tulshiram Buva Dixit$|^Tune-Yards$|^Turbotronic$|^Turnover$|^Turnpike Troubadours$|^TV Girl$|^TV On The Radio$|^Tweet$|^Twenty One Pilots$|^TWICE$|^Twila Paris$|^Twista$|^Twista & The Speedknot Mobstaz$|^Twisted Sister$|^Twiztid$|^Two Door Cinema Club$|^Two Feet$|^Ty Dolla $ign$|^Ty Herndon$|^Tycho$|^Tye Tribbett$|^Tyga$|^Tyla Yaweh$|^Tyler$|^Tyler Childers$|^Tyler Farr$|^Type O Negative$|^Tyrese$|^Tyrone Davis$|^U-Roy$|^U2$|^UB40$|^Udit Narayan$|^UFO$|^UGK$|^Ugly Kid Joe$|^Uli$|^Ulices Chaidez$|^Ultimate Spinach$|^Ultra NatÃ©$|^Ultravox$|^Uma Devi$|^Umberto Giordano$|^UMI$|^Umm Kulthum$|^Umphreys McGee$|^Uncle Kracker$|^Uncle Tupelo$|^Underoath$|^Underworld$|^University of North Texas Symphony Orchestra$|^UNKLE$|^Unknown Mortal Orchestra$|^Unspecified$|^Unspoken$|^Unwritten Law$|^Upchurch$|^Urbie Green$|^Uriah Heep$|^Usher$|^Utpala Sen$|^Uttara Devi$|^V\\.I\\.C\\.$|^VÃ­ctor Manuel$|^VÃ­ctor Manuelle$|^Vagon Chicano$|^Val Rosing$|^Valdemar Davids$|^ValentÃ­n Elizalde$|^Valentino Fioravanti$|^Vampire Sound Inc.$|^Vampire Weekend$|^Van Dyke Parks$|^Van Halen$|^Van Morrison$|^Van Shipley$|^Vance Joy$|^Vanessa Carlton$|^Vanessa Hudgens$|^Vanessa Williams$|^Vangelis$|^Vanilla Fudge$|^Vanilla Ice$|^Vanmala$|^Various Artists$|^Vasanti$|^Vasantrao Deshpande$|^Vasco Rossi$|^Vashti Bunyan$|^Vasilis Agrafiotis$|^Vasilis Skaliotis$|^Vasilis Tsitsanis$|^Vatsala Kumthekar$|^Vaya Con Dios$|^Vedo$|^Veena$|^VeggieTales$|^Velvet Revolver$|^Vengaboys$|^Venom$|^Vera Hall and Dock Reed$|^Vern Gosdin$|^Veronica Gonzalez Day$|^Vertical Horizon$|^Veruca Salt$|^Verzache$|^Vibe2Vibe$|^Vic Damone$|^VIC MENSA$|^Vicente Celestino$|^Vicente FernÃ¡ndez$|^Vicentico$|^Vicetone$|^Vico C$|^Victor Borge$|^Victor Cornelius$|^Victor Jara$|^Victor Silvester and his Ballroom Orchestra$|^Victor Yturbe El Piruli$|^Victorious Cast$|^Vidyanath Seth$|^Viento Y Sol$|^Vikki Carr$|^Viktor Vaughn$|^Village People$|^Vilma Palma e Vampiros$|^VinÃ­cius de Moraes$|^Vinayakrao Patwardhan$|^Vince DiCola$|^Vince Gill$|^Vince Guaraldi$|^Vince Guaraldi Trio$|^Vince Staples$|^Vincent dIndy$|^Vincenzo Bellini$|^Vinicio melis$|^Vinnie Vincent Invasion$|^Vino Nuevo$|^Violent Femmes$|^Viorel Demetriad$|^Virginia Lopez$|^Virlan Garcia$|^Virus$|^Virustage$|^Vishnupant Pagnis$|^Vivian Blaine$|^Vivian Chow$|^Vixen$|^Vladimir Horowitz$|^Voces Del Rancho$|^Volbeat$|^Volcano Choir$|^Voodoo Glow Skulls$|^Voz De Mando$|^Vulfpeck$|^Vundabar$|^Vyacheslav Sketch$|^Vybz Kartel$|^W.A.S.P.$|^Wade Bowen$|^Wade Hayes$|^Wade Hemsworth$|^Wadih El Safi$|^Wage War$|^Wah!$|^Wahidan Bai$|^Wailing Souls$|^Waka Flocka Flame$|^Wakin Chau$|^Wale$|^WALK THE MOON$|^Walker Hayes$|^Wall Of Voodoo$") == T, TRUE,
                         ifelse(at_least_3_songs.38 == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.40 = ifelse(str_detect(main.artist, "^Wallace House$|^Wallows$|^Walt Disney Sound Effects Group$|^Walter Bobbie$|^Walter Brennan$|^Walter Hawkins$|^Walter Murphy$|^Walter Wanderley$|^Walter Wanderley Trio$|^Waltham$|^Wanda Jackson$|^Wang Chung$|^War$|^Wardell Gray$|^Wardruna$|^Warner Bros Studio Orchestra$|^Warrant$|^Warren G$|^Warren Haynes$|^Warren Hill$|^Warren Zevon$|^Washed Out$|^Wasted Youth$|^Watsky$|^Wax Tailor$|^Waylon Jennings$|^Wayne Newton$|^Wayne Shorter$|^Wayne Toups$|^Wayne Wonder$|^WC$|^We Came As Romans$|^We The Kings$|^Weather Factory$|^Weather Report$|^Webb Pierce$|^Webbie$|^Ween$|^Weezer$|^Weird Al Yankovic$|^Wes Montgomery$|^Westlife$|^Westside Connection$|^Wet Wet Wet$|^Wet Willie$|^Wham!$|^Wheeler Walker Jr\\.$|^Whethan$|^Whigfield$|^Whiskey Myers$|^Whiskeytown$|^White Flag$|^White Lion$|^White Noise Baby Sleep$|^White Noise Therapy$|^White Zombie$|^Whitechapel$|^Whitesnake$|^Whitey Morgan and the 78s$|^Whitney Houston$|^Whodini$|^Why Dont We$|^Why Not$|^Wicked Lady$|^Widespread Panic$|^Wilbert Harrison$|^Wilbur De Paris$|^Wilco$|^Wild Cherry$|^Wild Rivers$|^Wilfrid Hyde-White$|^Wilfrido Vargas$|^Will Ackerman$|^Will Downing$|^Will Reagan$|^Will Smith$|^Will To Power$|^will.i.am$|^William Bell$|^William Carlos Williams$|^William Clark Green$|^William DeVaughn$|^William McDowell$|^William Onyeabor$|^William Steffe$|^William Walton$|^William Warfield$|^Willie Bobo$|^Willie ColÃ³n$|^Willie Dixon$|^Willie Gonzalez$|^Willie Hutch$|^Willie Nelson$|^Willie Rosario$|^Willie The Lion Smith$|^Willis Alan Ramsey$|^WILLOW$|^Wilmoth Houdini$|^Wilson Phillips$|^Wilson Pickett$|^Winger$|^Wings$|^Wink$|^Wipers$|^Wire$|^Wishbone Ash$|^Wisin$|^Wisin & Yandel$|^Witchfinder General$|^with Studio Orchestra$|^Within Temptation$|^Witt Lowry$|^Wiz Khalifa$|^WizKid$|^Wojciech Kilar$|^Wolfgang Amadeus Mozart$|^Wolfmother$|^Womack & Womack$|^Woodie$|^Woody Guthrie$|^Woody Herman$|^Woody Herman & His Orchestra$|^Woody Herman And His Woodchoppers$|^World Party$|^Wrabel$|^Wu-Tang Clan$|^Wu Bai$|^Wun Two$|^WWE$|^Wyclef Jean$|^Wynn Stewart$|^Wynonna$|^Wynton Kelly$|^Wynton Marsalis$|^WYS$|^X$|^X-Clan$|^X-Raided$|^X Ambassadors$|^X JAPAN$|^Xavier Cugat & His Orchestra$|^Xavier Cugat & His Waldorf-Astoria Orchestra$|^Xavier Rudd$|^Xavier Wulf$|^Xmal Deutschland$|^Xrisoula Staurou$|^Xristina Euthimiadou$|^Xristos Kontopoulos$|^Xristos Kontopoylos$|^Xscape$|^XTC$|^Xtreme$|^XXXTENTACION$|^Xzibit$|^Y&T$|^Y. Rosnblatt$|^Yandel$|^Yann Tiersen$|^Yanni$|^Yarbrough & Peoples$|^Yasuaki Shimizu$|^Yasunori Mitsuda$|^Yaz$|^YBN Nahmir$|^Yeah Yeah Yeahs$|^Years & Years$|^Yeasayer$|^Yehonatan Geffen$|^Yelawolf$|^Yella Beezy$|^Yello$|^Yellow Claw$|^YELLOW MAGIC ORCHESTRA$|^Yellowcard$|^Yellowjackets$|^Yellowman$|^Yes$|^Yessister$|^YFN Lucci$|^YG$|^Ying Yang Twins$|^Ying Yin Wu$|^Yiruma$|^Yma Sumac$|^Yndio$|^Yngwie Malmsteen$|^YNW Melly$|^Yo-Yo Ma$|^Yo Gotti$|^Yo La Tengo$|^Yohai Gabai$|^Yoke Lore$|^Yoko Ono$|^Yolanda Adams$|^Yolanda Del Rio$|^Yonder Mountain String Band$|^Yordano$|^Yoskar Sarante$|^You Me At Six$|^Young Bleed$") == T, TRUE,
                         ifelse(at_least_3_songs.39 == T, TRUE,                                 
                         ifelse(at_least_3_songs.38 == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.41 = ifelse(str_detect(main.artist, "^Young Buck$|^Young Dolph$|^Young Dro$|^Young M.A$|^Young Marble Giants$|^Young MC$|^Young Money$|^Young the Giant$|^Young Thug$|^Youngbloodz$|^YoungBoy Never Broke Again$|^Youth Of Today$|^Yugo Kanno$|^Yuji Nomi$|^Yumi Arai$|^Yumi Matsutoya$|^Yung Bleu$|^Yung Gravy$|^Yung Joc$|^Yung Pinch$|^YUNGBLUD$|^Yuri$|^Yuridia$|^Yusef Lateef$|^Yusuf / Cat Stevens$|^Yves Montand$|^Yvonne Elliman$|^Z-Ro$|^Z.Kwartin$|^Z.Z. Hill$|^Zac Brown Band$|^Zac Efron$|^Zacarias Ferreira$|^Zach Bryan$|^Zach Williams$|^Zacherley$|^Zack Hemsey$|^Zafar Khurshid$|^Zahur Raja$|^Zanin$|^Zapp$|^Zara Larsson$|^Zarbo$|^Zavaidoc$|^Zayde WÃ¸lf$|^ZAYN$|^zebrahead$|^Zedd$|^Zeds Dead$|^Zeenat Begum$|^Zeki MÃ¼ren$|^Zella Day$|^Zendaya$|^Zero 7$|^Zero Boys$|^Zero Mostel$|^ZhanÃ©$|^ZHU$|^Ziad Rahbani$|^Ziggy Alberts$|^Ziggy Marley$|^Ziggy Marley & The Melody Makers$|^Zion$|^Zion & Lennox$|^Zion I$|^Zion.T$|^ZoÃ©$|^Zofia Dromlewiczowa$|^Zohrabai Ambalawali$|^Zohrabai Ambalewali$|^ZoltÃ¡n KodÃ¡ly$|^Zoot Sims$|^Zsa Zsa Padilla$|^Zubaida Khanum$|^ZZ Top$") == T, TRUE,
                         ifelse(at_least_3_songs.40 == T, TRUE,
                         ifelse(at_least_3_songs.39 == T, TRUE,                                 
                         ifelse(at_least_3_songs.38 == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))))))))))
  )

```

      NOTE: I've probably had some names that slipped the cracks, so need to look what I miss and correct their labelling. 

```{r}

missed_artists = spotify_updated %>% 
  filter(at_least_3_songs.41 == F) %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(count = n()) %>%
  arrange(desc(count)) %>%
  top_n(290)

missed_artists_names = missed_artists$main.artist[missed_artists$count > 2]

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.42 = ifelse(str_detect(main.artist, "^Ð­Ñ€Ð½ÐµÑ\u0081Ñ‚ Ð¥ÐµÐ¼Ð¸Ð½Ð³ÑƒÑ\u008dÐ¹$|^Ð­Ñ€Ð¸Ñ… ÐœÐ°Ñ€Ð¸Ñ\u008f Ð ÐµÐ¼Ð°Ñ€Ðº$|^Javier SolÃ­s$|^Ð¢Ñ€ÑƒÐ¼ÐµÐ½ ÐšÐ°Ð¿Ð¾Ñ‚Ðµ$|^JAY-Z$|^James Taylor$|^Jackie Gleason$|^James Brown$|^Jack Johnson$|^J. Cole$|^Jefferson Airplane$|^Jackson Browne$|^Jack Teagarden$|^AntonÃ­n DvoÅ™Ã¡k$|^Jason Aldean$|^Jeezy$|^Janet Jackson$|^J.J. Cale$|^Jay Chou$|^Jack Payne$|^éœœè\u008f¯é›ªè\u008f¯$|^ç´«è–‡$|^Jean Moscopol$|^J Balvin$|^Jackie Wilson$|^James Brown & The Famous Flames$|^Jascha Heifetz$|^Too $hort$|^å‘¨ç’‡$|^James Horner$|^Jeff Beck$|^å´”è\u0090\u008d$|^Janis Joplin$|^Jean Sibelius$|^Jeremy Soule$|^Î›Î±ÏŠÎºÎ® ÎŸÏ\u0081Ï‡Î®ÏƒÏ„Ï\u0081Î± ÎœÎ¹Ï‡Î¬Î»Î· Î¦ÎµÎ»Î¿Ï…Î¶Î®$|^James Gang$|^Janes Addiction$|^Jennifer Lopez$|^Jelly Roll Morton$|^Î‘Î½Ï„ÏŽÎ½Î·Ï‚ Î\u009dÏ„Î±Î»Î³ÎºÎ¬Ï‚$|^Î Î­Ï„Ï\u0081Î¿Ï‚ ÎšÏ…Ï\u0081Î¹Î±ÎºÏŒÏ‚$|^Jenni Rivera$|^äºŽç’‡$|^ç™½å…‰$|^Jack Jackson & His Orchestra$|^Jamiroquai$|^Jay & The Americans$|^Î‘Î½Ï„ÏŽÎ½Î·Ï‚ Î”Î¹Î±Î¼Î±Î½Ï„Î¯Î´Î·Ï‚$|^Jason Derulo$|^J.J. Johnson$|^Jaganmoy Mitra$|^Jason Mraz$|^å¼µç\u0090\u008dæ•\u008f$|^è‘›è˜­$|^Ja Rule$|^Jack Teagarden And His Orchestra$|^James Piano Bar$|^Jack Jones$|^Jacky Cheung$|^Jefferson Starship$|^ã‚ªãƒ¡ã‚¬ãƒˆãƒ©ã‚¤ãƒ–$|^ÎšÏŽÏƒÏ„Î±Ï‚ Î¡Î¿Ï\u008dÎºÎ¿Ï…Î½Î±Ï‚$|^Jack Kerouac$|^Jeff Buckley$|^Ty Dolla $ign$|^Jagged Edge$|^Jeff Stetson$|^Jeremy Camp$|^æ°´æŸ³ä»™$|^James Arthur$|^Jean Ritchie$|^Jelly Roll$|^Jackson C. Frank$|^Jake Owen$|^Jeff Beatman$|^Jeremih$|^Jacques Dutronc$|^James Cleveland$|^Jan Johansson$|^Jelly Roll Morton & His Red Hot Peppers$|^ÐžÐ¢Ð’Ð\u0090Ð› Ð‘Ð\u0090WKN$|^El HaragÃ¡n y CompaÃ±Ã­a$|^Jamey Johnson$|^Jean-Michel Jarre$|^Jean-Yves Thibaudet$|^×\u0090×•×ž×Ÿ ×”×\u0090×•×¨ ×•×ž×œ×š ×”×¡×‘×•×Ÿ$|^å¼µæ·‘ç¾Ž$|^æœ\u008déƒ¨çˆµå£«å¤§æ¨‚éšŠ$|^çŽ‹ç§€å¦‚$|^Î”Î·Î¼Î®Ï„Ï\u0081Î·Ï‚ Î ÎµÏ\u0081Î´Î¹ÎºÏŒÏ€Î¿Ï…Î»Î¿Ï‚$|^J.L.B. Y CÃ­a$|^Jack Teagarden & His Band$|^Jaheim$|^James Bay$|^Jay McShann & His Orchestra$|^Jeff Alexander$|^ã‚»ã‚­ãƒˆã‚ªãƒ»ã‚·ã‚²ã‚ª$|^Î¤Î­Ï„Î¿Ï‚ Î”Î·Î¼Î·Ï„Ï\u0081Î¹Î¬Î´Î·Ï‚$|^ÎœÎ±Ï\u0081Î¯ÎºÎ± Î Î±Ï€Î±Î³ÎºÎ¯ÎºÎ±$|^J Dilla$|^Jagjit Singh$|^Jean-Luc Ponty$|^Jean Giono$|^Jeanette$|^Jeremy Zucker$|^Jeri Southern$|^J Boog$|^Jacquees$|^Jacques Brel$|^Jaden$|^James Ingram$|^Jean Servais$|^Jeffrey Osborne$|^å†‰è‚–çŽ²$|^ç¨²åž£æ¬¡éƒŽã\u0081¨ã‚½ã‚¦ãƒ«ãƒ»ãƒ¡ãƒ‡ã‚£ã‚¢$|^ç’°ç\u0090ƒç®¡å¼¦æ¨‚éšŠ$|^James Cagney$|^James Last$|^James Newton Howard$|^Jamie Foxx$|^Japan$|^Jararaca E Ratinho$|^Jazmine Sullivan$|^Jean Goldkette and his Orchestra$|^à¸Šà¸¢à¸¸à¸”à¸µ à¸§à¸ªà¸§à¸²à¸™à¸™à¸—à¹Œ$|^ÎœÎ¹Ï‡Î¬Î»Î·Ï‚ ÎšÎ±Î»Î­Ï\u0081Î³Î·Ï‚$|^Jadakiss$|^James Blunt$|^James Darren$|^James TW$|^Jan & Dean$|^Jay Rock$|^Jaymes Young$|^Jean Cocteau$|^Jeff Williams$|^å·¦è‰·è“‰$|^æ\u009dŽæ¸…é¢¨$|^Î‘.ÎšÏ‰ÏƒÏ„Î®Ï‚$|^ÎšÏŽÏƒÏ„Î±Ï‚ ÎšÎ±Ï\u0081Î¯Ï€Î·Ï‚$|^J.I the Prince of N.Y$|^Jackie DeShannon$|^Jacks Mannequin$|^Jacques Ibert$|^Jacques Offenbach$|^Jake Scott$|^James Blake$|^James McMurtry$|^Janis Ian$|^Jason Rivas$|^Jean-Jacques Perrey$|^Jerome Kern$|^Ã\u0081ngel Viloria Conjunto TÃ­pico CibaeÃ±o$|^ç¦\u008få±…è‰¯$|^ç§‹å…ƒè–«$|^ç¾…å¤§ä½‘$|^é»ƒåœ‹éš†$|^Ha*Ash$|^Î“Î¹ÏŽÏ\u0081Î³Î¿Ï‚ Î‘Î½ÎµÏƒÏ„ÏŒÏ€Î¿Ï…Î»Î¿Ï‚$|^Î“Î¹ÏŽÏ\u0081Î³Î¿Ï‚ ÎœÏ€Î¬Ï„Î·Ï‚$|^Î“Î¹ÏŽÏ\u0081Î³Î¿Ï‚ ÎšÎ±Ï„ÏƒÎ±Ï\u0081ÏŒÏ‚$|^ÎšÏŽÏƒÏ„Î±Ï‚ Î”Î¿Ï\u008dÏƒÎ¹Î±Ï‚$|^Jack Fascinato$|^Jack Harlow$|^Jack White$|^Jackyl$|^Jacqueline Taieb$|^James Morrison$|^Janelle MonÃ¡e$|^Janie Fricke$|^Jarabe De Palo$|^Jars Of Clay$|^Jasmine Thompson$|^Jason Isbell$|^Jean Ferrat$|^Jermaine Jackson$|^å¸­è“‰è“‰$|^éˆ´æœ¨ å¼˜$|^Grupo Kual?$|^Î”Î±Î½Î¬Î·$|^Î\u009dÏ„Î¿Ï\u008dÎ¿ Î§Î¬Ï\u0081Î¼Î±$|^ÎšÏŽÏƒÏ„Î±Ï‚ Î“ÎºÎ±Î½Ï„Î¯Î½Î·Ï‚$|^ÎšÏŽÏƒÏ„Î±Ï‚ Î\u009dÎ¿Ï\u008dÏ\u0081Î¿Ï‚$|^ÎšÏŽÏƒÏ„Î±Ï‚ ÎœÎ±Ï…Ï\u0081Î­Î±Ï‚$|^Jackie McLean$|^Jackson Do Pandeiro$|^Jacob Do Bandolim$|^Jagmohan Sursagar$|^James$|^James & Bobby Purify$|^James Vincent McMorrow$|^Jason Isbell and the 400 Unit$|^Jay Blackton$|^Jayamala Shiledar$|^JayDaYoungan$|^Jean-Jacques Goldman$|^Jean-Philippe Rameau$|^Jeff Foxworthy$|^Jeff Wayne$|^Jermaine Dupri$") == T, TRUE,
                         ifelse(at_least_3_songs.41 == T, TRUE,
                         ifelse(at_least_3_songs.40 == T, TRUE,
                         ifelse(at_least_3_songs.39 == T, TRUE,                                 
                         ifelse(at_least_3_songs.38 == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE))))))))))))))))))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% 
  mutate(
    at_least_3_songs.43 = ifelse(str_detect(main.artist, "^Lillys Chapel School \\(Ala\\.\\)$|^Pink Sweat\\$$|^Babes In Toyland\\\\xa0$|^ç«¥å®‰æ ¼$|^Î‘Î½Î­ÏƒÏ„Î·Ï‚ Î”ÎµÎ»Î¹Î¬Ï‚$|^Î“Ï\u0081Î·Î³ÏŒÏ\u0081Î·Ï‚ Î‘ÏƒÎ¯ÎºÎ·Ï‚$|^Î“Î¹Î±Î½Î½Î¬ÎºÎ·Ï‚ Î™Ï‰Î±Î½Î½Î¯Î´Î·Ï‚$|^Î“Î¹Î¬Î½Î½Î·Ï‚ Î™Ï‰Î±Î½Î½Î¯Î´Î·Ï‚$|^Î“Î¹ÏŽÏ\u0081Î³Î¿Ï‚ ÎšÎ±Î²Î¿Ï\u008dÏ\u0081Î±Ï‚$|^Î›Î±ÏŠÎºÎ® ÎŸÏ\u0081Ï‡Î®ÏƒÏ„Ï\u0081Î±$|^J-Kwon$|^J Alvarez$|^J. Holiday$|^J.D. Crowe & The New South$|^JÃ³nsi$|^Jack Ãœ$|^Jack Conte$|^Jack Costanzo$|^Jack Stauber$|^JACKBOYS$|^Jackie Cusic$|^Jaco Pastorius$|^Jaguares$|^Jai Paul$|^Jaime Y Los Chamacos$|^Jane Powell$|^Jasiah$|^Jason Boland & The Stragglers$|^Jatin-Lalit$|^Jawbreaker$|^Jawga Boyz$|^Jay & The Techniques$|^Jay PÃ©rez$|^Jay Sean$|^Jazz4Fun$|^JD Souther$|^Jean FranÃ§aix$|^Jean LumiÃ¨re$|^Jean Marion$|^Jedi Mind Tricks$|^Jeff Lorber$|^Jennifer Warnes$|^Jeremy Jordan$|^Jerrod Niemann$|^Ù…Ø­Ù…Ø¯ Ù\u0081ÙˆØ²ÙŠ$|^A*Teens$|^å¼µè‰¾å˜‰$|^bbno$$|^Ð”Ð”Ð¢$|^Î–Î±Ï‡Î±Ï\u0081Î¯Î±Ï‚ ÎšÎ±ÏƒÎ¹Î¼Î¬Ï„Î·Ï‚$|^Î‘Î¼Î±Î»Î¯Î± Î’Î¬ÎºÎ±$|^Î’Î±Î³Î³Î­Î»Î·Ï‚ Î£Î¿Ï†Ï\u0081Ï‰Î½Î¯Î¿Ï…$|^Î“Î¹Î¬Î½Î½Î·Ï‚ ÎœÏ€Î¿Ï…Î»ÏŒÏ„Î±Ï‚$|^Î“Î¹Î¬Î½Î½Î·Ï‚ ÎšÎ±Î¼Î²Ï\u008dÏƒÎ·Ï‚$|^Î“Î¹ÏŽÏ\u0081Î³Î¿Ï‚ Î’Î¹Î´Î¬Î»Î·Ï‚$|^Î•Î»Î»Î·Î½Î¹ÎºÎ® Î•ÏƒÏ„Î¿Ï…Î´Î¹Î±Î½Ï„Î¯Î½Î±$|^Î•Î»ÎµÏ…Î¸Î­Ï\u0081Î¹Î¿Ï‚ Î’ÎµÎ½Î¹Î¶Î­Î»Î¿Ï‚$|^Î\u009dÎ¯Ï„ÏƒÎ± ÎœÏŒÎ»Î»Ï…$|^Î\u009dÎ¯ÎºÎ¿Ï‚ Î¡Î­Î»Î»Î¹Î±Ï‚$|^ÎšÏŽÏƒÏ„Î±Ï‚ Î“Î¹Î±Î¿Ï\u008dÎ¶Î¿Ï‚$|^J.B. Lenoir$|^Jaci Velasquez$|^Jack Carson$|^Jack Jezzro$|^Jack Nitzsche$|^Jack Off Jill$|^Jack Wilkins$|^Jade$|^Jah Cure$|^Jahloul Bouchikhi$|^Jai Wolf$|^Jakob Ogawa$|^James Rado$|^Jamuna Rani$|^Jana Kramer$|^Janabai Pawar$|^Jason Donovan$|^Jason Michael Carroll$|^Jay Wheeler$|^Jean-Marie Leclair$|^Jean Sablon$|^Jeannie C. Riley$|^Jennifer Hudson$|^Jenny Lewis$|^Lady in the Dark Ensemble \\(1963\\)$|^LeoÅ¡ JanÃ¡Ä\u008de$|^Too \\$hort$|^Ty Dolla \\$ign$|^Ha\\*Ash$|^Grupo Kual\\?$|^A\\*Teens$|^bbno\\$$|^(Ð­Ñ€Ð¸Ñ)$") == T, TRUE,
    ifelse(str_detect(main.artist, "^Dre Dog$|^DIIV$") == T, FALSE,
    ifelse(str_detect(main.artist, "^(Î”Î·Î¼Î®Ï„Ï)|^ç«¥å®‰æ ¼$|^Robert Glasper$|^Guy dHardelot$|^(LeoÅ¡ JanÃ¡Ä)|^(ÎœÎ±Ï)") == T, TRUE,        
                         ifelse(at_least_3_songs.42 == T, TRUE,                                 
                         ifelse(at_least_3_songs.41 == T, TRUE,
                         ifelse(at_least_3_songs.40 == T, TRUE,
                         ifelse(at_least_3_songs.39 == T, TRUE,                                 
                         ifelse(at_least_3_songs.38 == T, TRUE,
                         ifelse(at_least_3_songs.37 == T, TRUE,
                         ifelse(at_least_3_songs.36 == T, TRUE,
                         ifelse(at_least_3_songs.35 == T, TRUE,
                         ifelse(at_least_3_songs.34 == T, TRUE,
                         ifelse(at_least_3_songs.33 == T, TRUE,
                         ifelse(at_least_3_songs.32 == T, TRUE,
                         ifelse(at_least_3_songs.31 == T, TRUE,
                         ifelse(at_least_3_songs.30 == T, TRUE,
                         ifelse(at_least_3_songs.29 == T, TRUE,
                         ifelse(at_least_3_songs.28 == T, TRUE,                                 
                         ifelse(at_least_3_songs.27 == T, TRUE, 
                         ifelse(at_least_3_songs.26 == T, TRUE, 
                         ifelse(at_least_3_songs.25 == T, TRUE,                           
                         ifelse(at_least_3_songs.24 == T, TRUE,  
                         ifelse(at_least_3_songs.23 == T, TRUE,                                  
                         ifelse(at_least_3_songs.22 == T, TRUE, 
                         ifelse(at_least_3_songs.21 == T, TRUE,                                 
                         ifelse(at_least_3_songs.20 == T, TRUE,
                         ifelse(at_least_3_songs.19 == T, TRUE,
                         ifelse(at_least_3_songs.18 == T, TRUE,
                         ifelse(at_least_3_songs.17 == T, TRUE,                                 
                         ifelse(at_least_3_songs.16 == T, TRUE,                                 
                         ifelse(at_least_3_songs.15 == T, TRUE,
                         ifelse(at_least_3_songs.14 == T, TRUE,
                         ifelse(at_least_3_songs.13 == T, TRUE,
                         ifelse(at_least_3_songs.12 == T, TRUE,
                         ifelse(at_least_3_songs.11 == T, TRUE,
                         ifelse(at_least_3_songs.10 == T, TRUE,                                 
                         ifelse(at_least_3_songs.9 == T, TRUE,
                         ifelse(at_least_3_songs.8 == T, TRUE,
                         ifelse(at_least_3_songs.7 == T, TRUE,
                         ifelse(at_least_3_songs.6 == T, TRUE,        
                         ifelse(at_least_3_songs.5 == T, TRUE,        
                         ifelse(at_least_3_songs.4 == T, TRUE,
                         ifelse(at_least_3_songs.3 == T, TRUE,
                         ifelse(at_least_3_songs.2 == T, TRUE, 
                         ifelse(at_least_3_songs.1 == T, TRUE, FALSE)))))))))))))))))))))))))))))))))))))))))))))
  )

spotify_updated = spotify_updated %>% mutate(at_least_3_songs = at_least_3_songs.43)

spotify_updated %>% 
  filter(at_least_3_songs == F) %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(count = n()) %>%
  arrange(desc(count))

```
It looks like there are 3 artists that can't be captured (likely due to the characters used).  However, considering that the sample size is in the upper 100000s, this really wouldn't be a real issue here.  Nevertheless, add this as a potential limitation in this analysis. 


**Part F**: Reorganize the data set to something more usable for me

    NOTE: I only need a few columns, so some of the intermediary ones are eliminated for the finalized version.  Also, I only will need like 2 additiona featured artist since any more than this is extremely rate in most cases. 

```{r}

spotify_updated = spotify_updated %>% dplyr::select(id, year, name, main.artist, more_than_one_artist, feature.artist.1, feature.artist.2, acousticness, at_least_3_songs, danceability, duration, energy, explicit, instrumentalness, is_foreign, is_major, key, liveness, loudness, popularity, speechiness, tempo, valence)

```


**Part G**: Re-configure the Key Variable to something that makes sense 

```{r}

spotify_updated = spotify_updated %>% 
  mutate(
    key = as.factor(key)
  ) %>%
  mutate(
    key = plyr::revalue(key, c('0'='A', '1'='A#/Bb','2'='B','3'='C','4'='C#/Db','5'='D','6'='D#/Eb','7'='E','8'='F','9'='F#/Gb','10'='G','11'='G#/Ab'))
  ) 

spotify_updated

```



# OBJECTIVE 1: Observe trends in audio + song features according to year of release 

```{r}

spotify_updated %>% 
  ggplot(aes(x = year)) + 
  geom_line(aes(fill = ..count..), stat = 'bin', binwidth = 1, color = 'purple') + 
  theme_classic() + 
  theme(
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  labs(x = "Year of Release", 
       y = "Number of Tracks on Spotify", 
       caption = "FIGURE1A. Number of Tracks According to Year of Release")

```

Looking at the number of tracks in the data set based on year of release, it appears as though there were approximately 1800-1900 original tracks collected for each year starting from the 1950s.  Interestingly, there was a great deal of fluctuation prior to that.  This may be explained with the filtering on different version of the same songs amongst artists prior to the 1950s.  

    NOTE: There was likely more than 2000 songs released since the 1950s each year. However, this is likely a result of a limit to the webscraping that was done to collect this data.  

```{r}

spotify_updated %>% 
 ggplot(aes(x = year, fill = more_than_one_artist))+
  geom_bar(color = 'black') + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) +
  xlab("Year") + 
  ylab("Number of Tracks on Spotify") + 
  labs(caption = 'FIGURE1B. Number of Tracks Released from 1921-2020 Based on More than 1 Artist Stutus') + 
  scale_fill_manual(name = "The Track Featured One 
or More Additional Artist", values = c("chartreuse3","lemonchiffon2"))


```
Examining this data set, it was found that there was a prominence in the number of tracks with one or more featured artist between the period of the 1940s to early 1950s.  However this dropped to a multi-decade low up until the mid 1980s, which then regained some prominence since.  

```{r}
spotify_updated %>% 
  group_by(year) %>% # group things according to year that track was released
  dplyr::summarise( # creates the pseudo columns which contains the mean scores for audio features that range from 0 to 1 
    acousticness = mean(acousticness),
    danceability = mean(danceability), 
    energy = mean(energy),
    instrumentalness = mean(instrumentalness),
    liveness = mean(liveness),
    speechiness = mean(speechiness),
    valence = mean(valence)
  ) %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = acousticness, color = "acousticness")) +  # individual line for the mean of acousticness
  geom_line(aes(y = energy, color = "energy")) +              # individual line for the mean of energy
  geom_line(aes(y = danceability, color = "danceability")) +  # individual line for the mean of danceability
  geom_line(aes( y = instrumentalness, color = "instrumentalness")) +  # individual line for the mean of instrumentalness
  geom_line(aes(y = liveness, color = "liveness")) +          # individual line for the mean of liveness
  geom_line(aes(y = speechiness, color = "speechiness")) +    # individual line for the mean of speechiness
  geom_line(aes(y = valence, color = "valence")) +            # individual line for the mean of valence
  theme_classic() + 
  theme(
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
    ) + 
  labs(x = "Track Released Year", 
       y = "Acoustic Feature Mean Scores", 
       caption = "FIGURE1C. Mean Acoustic Feature Score For Tracks Released from 1921-2020") +
     scale_color_manual(name = "Audio Features", 
                     values = c("acousticness"="coral4", "energy"="chartreuse4", "danceability"="cadetblue", "instrumentalness" = "darkmagenta", "liveness" = "darkkhaki", "speechiness" = "lightsalmon1", "valence"="turquoise3"), 
  labels = c('acousticness', 'energy', 'danceability', 'instrumentalness', 'liveness', 'speechiness', 'valence')) +
  scale_x_continuous(breaks = seq(from = 1920, to = 2025, by = 20))

```
A look into some of the audio features of tracks, we see that instrumentalness + acousticness have significantly declined over the years whilst danceabilty & energy have been on an uptick.  However, for the most part, valence and speechiness have been consistent~ish for the past 50+ years. 

```{r}

spotify_updated %>% 
 ggplot(aes(x = year, fill = explicit))+
  geom_bar(color = 'black') + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) +
  xlab("Year") + 
  ylab("Number of Tracks on Spotify") + 
  labs(caption = 'FIGURE1D. Number of Tracks Released from 1921-2020 Based on Explicit Status') + 
  scale_fill_manual(name = "The Track Contains 
Explicit Content", values = c("orange2","olivedrab4"))

```

However, as it pertains to explicit content, there has been a rise since the late 80s-early 90s with 2010s being at an all time high. 

```{r}

track_distribution_by_key_and_year = function(num) {
  
  caption_text = paste("FIGURE1E. Distribution of Tracks on Spotify Released in the Year ", as.character(num), ".")
  
  spotify_updated %>%
  filter(year == num) %>%
  group_by(key) %>% 
  dplyr::summarise(count = n()) %>%
  ggplot(aes(x = key, y =count, fill = key)) + 
    geom_bar(stat = 'identity', color = 'black') + 
    theme_classic() + 
    theme(
      axis.text = element_text(color = 'black'),
      plot.caption = element_text(face = 'bold', hjust = 0)
    ) + 
    labs(x = "Key", y = "Number of Tracks on Spotify", caption = caption_text) + 
    guides(fill = F)
  
}

track_distribution_by_key_and_year(1921)
track_distribution_by_key_and_year(1925)
track_distribution_by_key_and_year(1930)
track_distribution_by_key_and_year(1935)
track_distribution_by_key_and_year(1940)
track_distribution_by_key_and_year(1945)
track_distribution_by_key_and_year(1950)
track_distribution_by_key_and_year(1955)
track_distribution_by_key_and_year(1960)
track_distribution_by_key_and_year(1965)
track_distribution_by_key_and_year(1970)
track_distribution_by_key_and_year(1975)
track_distribution_by_key_and_year(1980)
track_distribution_by_key_and_year(1985)
track_distribution_by_key_and_year(1990)
track_distribution_by_key_and_year(1995)
track_distribution_by_key_and_year(2000)
track_distribution_by_key_and_year(2005)
track_distribution_by_key_and_year(2010)
track_distribution_by_key_and_year(2015)
track_distribution_by_key_and_year(2020)

```
```{r}

spotify_updated %>% 
 ggplot(aes(x = year, fill = is_major))+
  geom_bar(color = 'black') + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) +
  xlab("Year") + 
  ylab("Number of Tracks on Spotify") + 
  labs(caption = 'FIGURE1F. Number of Tracks Released from 1921-2020 Based on Major Status of Song') + 
  scale_fill_manual(name = "Is the Track in Major?", values = c("chartreuse","lightsalmon"))

```
A look at the keys in which songs have been played over the years, there doesn't seem to be much of a trend.  However, for the most part, the majority of tracks are played in a major key as opposed to a minor key. 

```{r}

spotify_updated %>% 
  group_by(year) %>% 
  dplyr::summarise(avg = mean(duration)) %>%
  ggplot(aes(x = year, y = avg)) + 
  geom_line(color = 'dodgerblue4') + 
  theme_classic() + 
  theme(axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  labs(x = "Year", y = "Length of Track (in Seconds)", caption = "FIGURE1G. Average Duration of Track on Spotify According to Year of Release") + 
  scale_x_continuous(breaks = seq(from = 1920, to = 2020, by = 10)) + 
  ylim(0, 300)

```

Looking at the average duration of tracks, there has been a fluctuating, but consistent, length of around 200 - 250 seconds in length for tracks released since the 1970s. This amounts to a length of 3:20 to 4:02.  Considering the change in technology relating to music recording [as shown here](https://pitchfork.com/features/lists-and-guides/9940-music-technology-of-the-1970s-a-timeline/), it wouldn't be surprising to see a more consistent duration length than compared to the decades before which relied on older technology and their limitations.  

```{r}
spotify_updated %>% 
  group_by(year) %>% 
  dplyr::summarise(avg = mean(tempo)) %>%
  ggplot(aes(x = year, y = avg)) + 
  geom_line(color = 'grey7') + 
  theme_classic() + 
  theme(axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  labs(x = "Year", y = "Tempo of Track (in BPM)", caption = "FIGURE1H. Average Tempo of Track on Spotify According to Year of Release") + 
  scale_x_continuous(breaks = seq(from = 1920, to = 2020, by = 10)) + 
  ylim(0, 150)
```

Overall, it appears as though the tempo of tracks remained relatively consistent throughout the decades.  While the slight and gradual increase in the 60s to 80s can be attributed to the new tech as well as changing flavor of music taste with the rise in rock music, this didn't seem to have changed much since. 

```{r}


spotify_updated %>% 
  group_by(year) %>% 
  dplyr::summarise(avg = mean(loudness)) %>%
  ggplot(aes(x = year, y = avg)) + 
  geom_line(color = 'skyblue1') + 
  theme_classic() +
  theme(axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  labs(x = "Year", y = "Loudness (in dB)", caption = "FIGURE1I. Average Loudness of Track on Spotify According to Year of Release") + 
  scale_x_continuous(breaks = seq(from = 1920, to = 2020, by = 10)) 

```
Examining how loud tracks have gotten over the years, we see that it has been increasing since the 1960s.  

```{r}

spotify_updated %>% 
  group_by(year) %>% 
  dplyr::summarise(avg = mean(popularity)) %>%
  ggplot(aes(x = year, y = avg)) + 
  geom_line(color = 'orangered3') + 
  theme_classic() + 
  theme(axis.text = element_text(color = 'black'),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  labs(x = "Year", y = "Popularity Scores", caption = "FIGURE1I. Average Popularity of Track on Spotify According to Year of Release") + 
  scale_x_continuous(breaks = seq(from = 1920, to = 2020, by = 10)) + 
  scale_y_continuous(breaks = seq(from = 0, to = 100, by = 10))

```
Popularity scores on Spotify appears to be highly related to year of release with the most recent having a higher average popularity score than compared to the classics (i.e. pre-2000s...try not to feel your age here) or oldies (i.e. pre-1960s).  This would make sense as in the documentation, popularity score is largely driven by number of clicks or plays at a given time frame and it would make sense to have newer tracks have more airplay and recall than older tracks. 


## Objective 1: Summary

Looking at the tracks in this data set, there appeared to be ~2000 tracks for each release year.  This likely corresponded to a cap that occurred from scrapping this data from Spotify.  In terms of audio features, it was found that: 

    * Popularity scores tend to be skewed towards more recently-released tracks as compared to earlier tracks. 
    * Features that have been on a decline in more recently released tracks are: (1) acousticness, (2) liveness, (3) instrumentalness
    * Conversely, both energy and loudness have been on the rise over the years 
    * Majority of songs over the years average around 200-250 seconds (aka. 3:20 - 4:10 minutes) 
    * There has been a rise in explicit content in tracks over recent years 
    * There appears to be a phasic element with respect to having featured artists on tracks where from 1920s-1950s there was some rise in having multiple featured artist which then went in the decline until the mid 1980s before returning to a rising trend in more tracks having a featured artist. 
    
    
    







# OBJECTIVE 2: ANSWERING SOME INTERESTING QUESTIONS

**Q.1) Who's The Top 40 Contributing Artists on Spotify?**

Based on this distribution, it appears as though the top 5 contributing artists with non-duplicated tracks were mainly from classical music composers.  Following them stemmed oldies greats such as Billie Holliday, Frank Sinatra, Johnny Cash, Elvis Presley, etc. This likely pertained to the length and longevity of the artists' careers that allowed for a large discography. 

```{r}

spotify_updated %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(num_tracks = n()) %>% 
  arrange(desc(num_tracks)) %>% 
  top_n(40) %>% 
  ggplot(aes(x = reorder(main.artist, num_tracks), y = num_tracks)) + 
  geom_bar(stat = 'identity', color = 'black', fill = 'turquoise') + 
  theme_classic() + 
  theme(
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 6),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) + 
  xlab("Main Credited Artists") + 
  ylab("Number of Tracks
on Spotify") + 
  labs(caption = "FIGURE2A. Top 40 Artists with the Most Tracks on Spotify whilst Credited as the 
Principal Artist") + 
  coord_flip()

```

**Q.2) Who's The Top 40 Contributing Artists That's Likely Known in N.America?**

Essentially we got rid of the two Russian composers from the top 40 list. 

```{r}

spotify_updated %>% 
  filter(is_foreign == 'no') %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(count = n()) %>% 
  arrange(desc(count)) %>%
  top_n(40) %>%
  ggplot(aes(x = reorder(main.artist, count), y = count)) + 
  geom_bar(stat = 'identity', color = 'black', fill = "slateblue1") + 
  coord_flip() +
  xlab("Main Credited Artist") + 
  ylab("Number of Tracks on Spotify") + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 6),
    plot.caption = element_text(face = 'bold', hjust = 0) 
  ) + 
  labs(caption = "FIGURE2B. Top 40 Artists with the Most Tracks on Spotify whilst Credited as the
Principal Artist and Likely Not Unknown in North America")

```
**Q.3A) Who are the most popular artist on Spotify?**

Based on the output, it looks like Frank Sinatra, The Beetles and Elvis Presley hold the title of the three most popular artists on Spotify (at least according to when this data was collected).  

```{r}

spotify_updated %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(total = sum(popularity)) %>%
  arrange(desc(total)) %>%
  top_n(40) %>% 
  ggplot(aes(x = reorder(main.artist, total), y = total)) + 
  geom_bar(stat = 'identity', color = 'black', fill = "darkkhaki") + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 6),
    plot.caption = element_text(face = 'bold', hjust = 0)  
  ) + 
  coord_flip() + 
  xlab("Main Credited Artist") + 
  ylab("Total Popularity Score") + 
  labs(caption = "FIGURE2C. Top 40 Artists on Spotify Based on Total Popularity Score")

```
**Q.3B) What are these artists' average popularity score per track on Spotify?**

Amongst these popular artists, the artists that have the highest average scores are the more contemporary ones (i.e. BTS, Drake, Taylor Swift). 

```{r}

spotify_updated %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(sum_popularity = sum(popularity), average_popularity = mean(popularity)) %>% 
  arrange(desc(sum_popularity)) %>% 
  head(40) %>% 
  ggplot(aes(x = reorder(main.artist, sum_popularity), y = average_popularity)) + 
  geom_bar(stat = 'identity', color = 'black', fill = 'darkgoldenrod2') + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.text = element_text(color = 'black'),
    axis.line = element_line(color = 'black'),
    axis.text.y = element_text(size = 6.5),
    plot.caption = element_text(face = 'bold', hjust = 0)
  ) +
  xlab("Credited Artist") +
  ylab("Average Popularity Score on Spotify") + 
  labs(caption = 'FIGURE2D. Average Popularity Score of a Track from Top 40 Popular Artist on Spotify ') + 
  coord_flip()

```

**Q.4) Which Artists have The Highest Average Popularity Score?**

Looking at the Top 40 popular artists based on average scores, they are predominantly artists that recently had a chart topper near the end of 2020. However, interestingly, the majority of them have less than 3 songs on Spotify. 

```{r}

spotify_updated %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(avg = mean(popularity)) %>%
  arrange(desc(avg)) %>%
  top_n(40) %>% 
  ggplot(aes(x = reorder(main.artist, avg), y = avg)) + 
  geom_bar(stat = 'identity', color = 'black', fill = "darksalmon") + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 6),
    plot.caption = element_text(face = 'bold', hjust = 0)  
  ) + 
  coord_flip() + 
  xlab("Main Credited Artist") + 
  ylab("Mean Popularity Score") + 
  labs(caption = "FIGURE3A. Top 40 Artists on Spotify Based on Total Popularity Score")

```
**Q.4) Who Are The Artists With The Highest Average Popularity Score That Have At Least 3 Songs on Spotify?**

These artists have very recently came onto the scene (i.e. last 3-4 years). Interestingly, the top 5 artists that are on this list are foreign artist (for context, I mean non-American/Canadian).  Again, this would make sense as the algorithm for dictating popularity score on Spotify's documentation stated that number of clicks and plays for a given time frame dictates score as of time of data collection.  In this case, most of this happens when a track is actually released rather than older released tracks (unless something tragic happened to the artist)

```{r}

spotify_updated %>%
  filter(at_least_3_songs == T) %>% 
  group_by(main.artist) %>% 
  dplyr::summarise(avg = mean(popularity)) %>%
  arrange(desc(avg)) %>%
  top_n(40) %>%
  ggplot(aes(x = reorder(main.artist, avg), y = avg)) + 
  geom_bar(stat = 'identity', color = 'black', fill = "firebrick2") + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 6),
    plot.caption = element_text(face = 'bold', hjust = 0)  
  ) + 
  coord_flip() + 
  xlab("Main Credited Artist") + 
  ylab("Mean Popularity Score") + 
  labs(caption = "FIGURE3B. Top 40 Artists With at Least 3 Songs on Spotify Based on Total Popularity Score")

```

**Q.5)  What Are The Most Popular Tracks On Spotify (as of 11-24-2020)?**

The most popular track on Spotify was Dakiti by Bad Bunny x Jhay Cortez (it's Raggaeton), followed by Mood by 24KGolkdn (Hip-Hop) and then Dynamite by BTS (K-Pop).  

```{r}

spotify_updated %>% 
  group_by(name) %>% 
  arrange(desc(popularity)) %>%
  head(20) %>% 
  ggplot(aes(x = reorder(name, popularity), y = popularity)) +
  geom_bar(stat = 'identity', color = 'black', fill = 'violet') + 
  coord_flip() + 
  xlab("Name of Track") + 
  ylab("Popularity Score") + 
  labs(caption = "FIGURE4F: Top 20 Popular Tracks on Spotify (as of 11-24-2020)") + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.line = element_line(color = 'black'),
    axis.text = element_text(color = 'black'),
    axis.text.y = element_text(color = 'black', size = 8),
    plot.caption = element_text(face = 'bold', hjust = 0)     
  )

```

**(FOR FUN) Create a function to put out the most popular tracks based on year of release (as of 11-20-2020)**

```{r}

retrieve_top_20_tracks = function (num) {
  
  string_here = paste("Top 20 Rated Songs on Spotify released in the year", as.character(num))
  
  spotify_updated %>% 
    filter(year == num) %>%
    group_by(name) %>%
    arrange(desc(popularity)) %>% 
    head(20) %>%
    ggplot(aes(x = reorder(name, popularity), y = popularity)) +
    geom_bar(stat = 'identity', color = 'black', fill = 'chartreuse') + 
    coord_flip() + 
    xlab("Name of Track") + 
    ylab("Popularity Score") + 
    labs(caption = string_here) + 
    theme(
      panel.background = element_rect(fill = 'white'),
      axis.line = element_line(color = 'black'),
      axis.text = element_text(color = 'black'),
      axis.text.y = element_text(color = 'black', size = 8),
      plot.caption = element_text(face = 'bold', hjust = 0)
    )
}

```
```{r, fig.width = 13, fig.height=5}

# A look from the last 20 years

post_2000 = c(2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020)

for (i in post_2000) {
  x = retrieve_top_20_tracks(i)
  print(x)
}

```









# OBJECTIVE 3: Predictive Modelling of Popularity Scores according to Audio + Track Features

**Part 1**: Correlation Matrix

Examining the correlation b/t audio and track features in relation to popularity score, it was found that: 

    * Positive Correlation: Year (high), Energy (moderate), Loudness (moderate)
    * Negative Correlation: Having a featured artist (low), Acousticness (moderate), Instrumentalness (low)
    
```{r, fig.height= 8.5, fig.width=8,5}

spotify_updated_correlation = spotify_updated %>% dplyr::select(-id, -name, -main.artist, -feature.artist.1, -feature.artist.2, -key, -is_foreign)

corr_spotify_updated <- cor(spotify_updated_correlation)

ggcorrplot(corr_spotify_updated, method = 'square', type = 'full', sig.level = 0.1, insig = 'blank', p.mat = cor_pmat(corr_spotify_updated), lab = T) + 
  theme(
    panel.background = element_rect(fill = 'white'),
    axis.text.x = element_text(angle = 90, hjust = 1),
    axis.text =  element_text(color = 'black')  , 
    plot.caption = element_text(face = "bold", hjust = 0)
  ) + 
  labs(x = "Variable X", y = "Variable Y", caption = "FIGURE5. Correlation Matrix")

```

**Part 2**: A further look into these variables in relation to popularity scores

```{r}
spotify_updated %>% 
  group_by(year) %>%
  dplyr::summarise(average = mean(popularity)) %>%
  ggplot(aes(x = year, y = average)) + 
  geom_point(color = 'darkblue') +
  geom_smooth(method = 'gam', se = F)+
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', color = "black", hjust = 0),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "Year of Release", y = "Average Popularity Score", caption = "FIGURE6A1. Mean Popularity Score x Year of Release")
```
```{r}
spotify_updated %>% 
  ggplot(aes(x = year, y = popularity)) + 
  geom_point() + 
  geom_smooth() + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', color = "black", hjust = 0),
    axis.text = element_text(color = 'black')    
  ) + 
  labs(x = "Year of Release", y = "Popularity", caption = "FIGURE6A2. Popularity Score x Year of Release") 

```
```{r}
cor(spotify_updated$year, spotify_updated$popularity)
summary(lm(popularity ~ year, data = spotify_updated))
```

      * Looking at the Year variable, we can see that the correlation between popularity & year to be very positively correlated.  Again this isn't too surprising considering what we know about this dataset. 
      
```{r}
spotify_updated %>% 
  ggplot(aes(x = more_than_one_artist, y = popularity, fill = more_than_one_artist)) +
  geom_boxplot(color = 'black') + 
  theme_classic() + 
  theme(
    axis.text = element_text(color = 'black'),
    plot.caption = element_text(hjust = 0, face = 'bold')
  ) + 
  labs(x = "Were there multiple artists on the track?", 
       y = "Popularity Scores", 
       caption = "FIGURE6B. Popularity Score Based on Status of a Featured Artist") +
  guides(fill = F)

```
```{r}
t.test(spotify_updated$popularity ~ spotify_updated$more_than_one_artist)
summary(lm(popularity ~ more_than_one_artist, data = spotify_updated))
```
      
      *Examining popularity as a function of whether a track had more than one artist listed, it was found that those that did had a lower popularity score on average as compared to those that did not
      
```{r}
spotify_updated %>% 
  group_by(acousticness) %>%
  dplyr::summarise(average = mean(popularity)) %>%
  ggplot(aes(x = acousticness, y = average)) + 
  geom_point(color = 'darkgoldenrod2') + 
  geom_smooth(method = 'gam', se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', color = "black", hjust = 0),
    axis.text = element_text(color = 'black'),
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) + 
  labs(x = "Acosticness Score", y = "Average Popularity Score", caption = "FIGURE6C1. Mean Popularity Score x Acousticness Score")  + 
  scale_x_continuous(breaks = seq(from = 0, to = 1, by = 0.05))
```
```{r}
spotify_updated %>% 
  ggplot(aes(x = acousticness, y = popularity)) + 
  geom_point(color = 'orange') + 
  geom_smooth(method = 'gam', se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', color = "black", hjust = 0),
    axis.text = element_text(color = 'black'),
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) + 
  labs(x = "Acousticness", y = "Popularity", caption = "FIGURE6C2. Popularity Score x Acousticness")  + 
  scale_x_continuous(breaks = seq(from = 0, to = 1, by = 0.05))
```
```{r}
cor(spotify_updated$acousticness, spotify_updated$popularity)
summary(lm(popularity ~ acousticness, data = spotify_updated))
```

      * Examining the relationship b/t acousticness and popularity, it was found that there was a moderate negative correlation.  
      
```{r}
spotify_updated %>% 
  group_by(energy) %>% 
  dplyr::summarise(average = mean(popularity)) %>% 
  ggplot(aes(x = energy, y = average)) + 
  geom_point(color = "lightsteelblue2") + 
  geom_smooth(method = 'gam', color = "yellow1", se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(color = 'black', hjust = 0, face = 'bold'),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "Energy Scores", y = 'Mean Popularity Scores', caption = "FIGURE6D1. Mean Popularity Score x Energy")
```
```{r}
spotify_updated %>% 
  ggplot(aes(x = energy, y = popularity)) + 
  geom_point(color = 'lightsteelblue2') + 
  geom_smooth(method = 'gam', color = 'yellow1', se = F) + 
  theme_classic()+
  theme(
    plot.caption = element_text(color = 'black', hjust = 0, face = 'bold'),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "Energy Scores", y = 'Popularity Scores', caption = "FIGURE6D2. Popularity Score x Energy")
```
```{r}
cor(spotify_updated$energy, spotify_updated$popularity)
summary(lm(popularity ~ energy, data = spotify_updated))
```

      * Here, we see a moderate positive correlation b/t energy and popularity 

```{r}
spotify_updated %>% 
  group_by(loudness) %>% 
  dplyr::summarise(average = mean(popularity)) %>%
  ggplot(
    aes(x = loudness, y = average)
  ) + 
  geom_point(color = "mediumorchid3") + 
  geom_smooth(method = 'gam', color = "gold2", se = F) +
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', hjust = 0),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "Loudness (in dB)", y = "Mean Popularity Score", caption = "FIGURE6E1. Mean Popularity x Loudness")
```
```{r}
spotify_updated %>%
  ggplot(aes(x = loudness, y = popularity)) + 
  geom_point(color = 'mediumorchid2') + 
  geom_smooth(method = 'gam', color = 'gold2', se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', hjust = 0),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "loudness (in dB)", y = "popularity score", caption = "FIGURE6E2. Popularity x Loudness")
```
```{r}
cor(spotify_updated$loudness, spotify_updated$popularity)
summary(lm(popularity ~ loudness, data = spotify_updated))
```

    * As for loudness, there is a moderate correlation with popularity scores 

```{r}
spotify_updated %>% 
  group_by(instrumentalness) %>% 
  dplyr::summarise(avg = mean(popularity)) %>% 
  ggplot(
    aes(x = instrumentalness, y = avg)
  ) + 
  geom_point(color = "lavenderblush2") + 
  geom_smooth(method = 'gam', se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', hjust = 0),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = "Instrumentalness", y = "Mean Popularity Score", caption = "FIGURE6F1. Mean Popularity x Instrumentalness")
```
```{r}
spotify_updated %>% 
  ggplot(aes(x = instrumentalness, y = popularity)) + 
  geom_point(color = "lavenderblush2") + 
  geom_smooth(method = 'gam', se = F) + 
  theme_classic() + 
  theme(
    plot.caption = element_text(face = 'bold', hjust = 0),
    axis.text = element_text(color = 'black')
  ) + 
  labs(x = 'Instrumentalness', y = "Popularity Score", caption = "FIGURE6F2. Popularity x Instrumentalness")
```
```{r}
cor(spotify_updated$instrumentalness, spotify_updated$popularity)
summary(lm(popularity ~ instrumentalness, data = spotify_updated))
```

      * There is a negative weak correlation between instrumentalness and popularity 


NOTE: It appears to be inflated with a popularity score of 0 for like the majority of tracks.  Thinking about it, this would make sense as there would be a number of songs that just aren't remembered for.  Like think about it, how many times is someone actually going to listen to really obscure songs or one-hit wonders from like 30-40 years ago?  In any case, we need to address this eventually. 
```{r}

spotify_updated %>% 
  ggplot(aes(x = popularity)) +
  geom_histogram(color = 'black', fill = 'skyblue1', bins = 50) +
  theme_classic()

spotify_updated %>% 
  group_by(popularity) %>% 
  dplyr::summarise(count = n()) 

```
Let's create a variable that determines if popularity = 0 or not... this should be 26983 or 16.37%

```{r}
spotify_updated = spotify_updated %>% 
  mutate(
    is_popularity_zero = ifelse(popularity == 0, TRUE, FALSE)
  )

spotify_updated %>% group_by(is_popularity_zero) %>% dplyr::summarise(count = n())

spotify_updated %>% 
  ggplot(aes(x = is_popularity_zero, fill = is_popularity_zero)) + 
  geom_bar(color = 'black') + 
  theme_classic() + 
  theme(axis.text = element_text(color = 'black')) + 
  labs(x = "Is the popularity score 0?", y = "Number of tracks on Spotify") + 
  scale_y_continuous(labels = scales::comma, breaks = seq(from = 0, to = 150000, by = 25000))
```
Looking at the distribution of the popularity scores in the Spotify Data Set, it seems that there is a high number of "0" for a number of tracks.  Again, this wouldn't be too surprising given that popularity score being transient and heavily skewed towards rate of it being played at a given time frame.  In any case, let's try the different kind of predictive models approaches to see if we can find something here. 


```{r}
trainingIndex = createDataPartition(spotify_updated$popularity, p = 0.8, list = F)

spotify_updated_train = spotify_updated[trainingIndex,]
spotify_updated_test = spotify_updated[-trainingIndex,]

View(spotify_updated_test)
View(spotify_updated_train)
```
```{r}
spotify_updated_train %>% 
  group_by(is_popularity_zero) %>% 
  dplyr::summarise(count = n())

spotify_updated_test %>% 
  group_by(is_popularity_zero) %>% 
  dplyr::summarise(count = n())
```


**Part 3: Creating the Different Models**:

###LINEAR REGRESSION (with variables having correlation significant at p < 0.1)

```{r}
train_linear_model = lm(popularity ~ year + acousticness + loudness + energy + instrumentalness + more_than_one_artist, data = spotify_updated_train)
summary(train_linear_model)
AIC(train_linear_model)
```
```{r}
plot(train_linear_model)
lmtest::bptest(train_linear_model)
```
```{r}
predict_linear = predict(train_linear_model, spotify_updated_test)
View(cbind(predict_linear, spotify_updated_test$popularity))
RMSE(predict_linear, spotify_updated_test$popularity)
MAE(predict_linear, spotify_updated_test$popularity)
rms::vif(train_linear_model)

```

    * R^2 = 0.753 (aka. 75.3% reduction in the variance in popularity score after accounting for the above factors; really not bad at all in terms of accounting for variance), AIC = 1,003,018, RMSE = 10.852 (considering that 0 = perfect accuracy, this is like a very inaccurate model; since this model would expect a typical deviation from popularity score by like almost 11), MAE = 8.057
    * Based on VIF, there really isn't much of a concern with issue of multi-collinearity with this model 
    * However, looking at the plots for model, we run into a few problems:
      
      1) In the Residuals vs Fitted plot, there is a **large** value b/t the residuals and the fitted line (upwards of 50) along with an unequivalent spread favoring the positive value. This signals that the assumptions of linearity b/t explanatory and predictor variables along with homoscedasticity are likely violated.  In fact, if we observe the relationship of variables with popularity above, it indeed showed this. 
      
      2) Looking at the Q-Q plot, we see that the fit of the residuals to the normal "predicted" observations of popularity score is off (particularly at the ends)...again this is likely a result of the inflation of zero score.  This basically asserts that normality of residuals is NOT held 
      
      3) Looking at the scale vs. location curve, it seem that there is a sense of variability of the residuals to the red line. Further evaluation with the Breusch Pagan Test found that the model appears to reject the null hypothesis of homoskedasticity and therefore we have a heteroskedastic model (i.e. where residual points are at widely varying distances from the regression line) 

    OVERALL, due to the violation of the assumption of linearity, homeoskedascity and normality, we would say this as a predictive model for popularity score would be pretty poor. 
    

### LINEAR REGRESSION (with all variables)

```{r}
train_linear_model_all = lm(popularity ~ year + acousticness + at_least_3_songs + danceability + duration + explicit + is_major + key + liveness + loudness + energy + instrumentalness + more_than_one_artist + speechiness + tempo + valence, data = spotify_updated_train)
summary(train_linear_model_all)
AIC(train_linear_model_all)
```
```{r}
plot(train_linear_model_all)
lmtest::bptest(train_linear_model_all)
```
```{r}
predict_linear_all = predict(train_linear_model_all, spotify_updated_test)
View(cbind(predict_linear_all, spotify_updated_test$popularity))
RMSE(predict_linear_all, spotify_updated_test$popularity)
MAE(predict_linear_all, spotify_updated_test$popularity)
rms::vif(train_linear_model_all)
```

    * R^2 = 0.759 (aka. 75.9% reduction in the variance in popularity score after accounting for the above factors; really not bad at all in terms of accounting for variance), AIC = 999,755.2, RMSE = 10.732 (considering that 0 = perfect accuracy, this is like a very, very, very inaccurate model; since this model would expect a typical deviation from popularity score by like almost 11), MAE = 8.029
    * Based on VIF, there really isn't much of a concern with issue of multi-collinearity with this model 
    * However, looking at the plots for model, we run into a few problems:
      
      1) In the Residuals vs Fitted plot, there is a **large** value b/t the residuals and the fitted line (upwards of 50) along with an unequivalent spread favoring the positive value. This signals that the assumptions of linearity b/t explanatory and predictor variables along with homoscedasticity are likely violated.  In fact, if we observe the relationship of variables with popularity above, it indeed showed this. 
      
      2) Looking at the Q-Q plot, we see that the fit of the residuals to the normal "predicted" observations of popularity score is off (particularly at the ends)...again this is likely a result of the inflation of zero score.  This basically asserts that normality of residuals is NOT held 
      
      3) Looking at the scale vs. location curve, it seem that there is a sense of variability of the residuals to the red line. Further evaluation with the Breusch Pagan Test found that the model appears to reject the null hypothesis of homoskedasticity and therefore we have a heteroskedastic model (i.e. where residual points are at widely varying distances from the regression line) 
      
    OVERALL, it's a better fitted model (like by the slightest of margins) compared to the one above, but essentially the same.  However, due to the violation of the assumption of linearity, homeoskedascity and normality, we would say this as a predictive model for popularity score would be pretty poor. 
    





## Generalized Additive Models

Okay, so linear regression doesn't appear to be a really good option.  So let's try generalized additive model for the reason that it allows us to deal with non-linear relationship b/t explanatory and outcome variable.  The key to this is to select the appropriate distribution family of the outcome variable.  Considering that there is an abundance of zero for popularity scores, there are two likely types of distribution: [Tweedie](https://www.statisticshowto.com/tweedie-distribution/) or [zero-inflated poisson distribution](https://europepmc.org/article/PMC/3238139).  However, we'll also try it out with a poisson + gaussian distribution as well. 

In an effort to not actually have to run the process of figuring out which predictors to include into this proposed predictive model due to the time it takes to actually run it, I've found that based on a stepwise AIC approach that the variables to include are: (a) Year, (b) Instrumentalness, (c) at_least_3_songs, (d) acousticness, (e) duration, (f) energy, (g) liveness, (h) loudness, (i) danceability, (j) tempo, (k) key, (l) is_major and (m) explicit. 

    NOTE: Since this is a very large dataset, I will use the "bam" function instead of "gam" as speed will be more of a concern here as opposed to convergence.  Trust me, it'll take over a day if you use gam instead. 
    
    
```{r}
gam.model.tw_select = bam(popularity ~ s(year, bs = "cs", k = 100) + more_than_one_artist + s(acousticness, bs = 'cs', k = 89) + s(energy, bs = "cs", k = 89) + s(loudness, bs = "cs", k = 89) + s(instrumentalness, bs = "cs", k = 89), data = spotify_updated_train, method = "REML", family = tw, select = T)
AIC(gam.model.tw_select)
summary(gam.model.tw_select)
```
```{r}
gam.check(gam.model.tw_select)
concurvity(gam.model.tw_select, full = F)$worst
```
```{r}
predict.gam.tw_select = predict.gam(gam.model.tw_select, spotify_updated_test, type = "response")
View(cbind('prediction' = predict.gam.tw_select,  'actual' = spotify_updated_test$popularity, 'residual' = abs(predict.gam.tw_select - spotify_updated_test$popularity)))
RMSE(predict.gam.tw_select, spotify_updated_test$popularity)
MAE(predict.gam.tw_select, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.tw_select)
```
Using only a select choice of predictor variables based on the correlation matrix, it was found that the R^2 = 0.790 and AIC =  900938.7.  So compared to the linear regression models, it looks like a better fit model.  Further insepection at the accuracy of the model by looking at how the RMSE and MAE, it also seemed to perform better than the linear regression models earlier (RMSE = 9.98; MAE = 6.98).  However, a point of contention would be with respect to the Gam.Check where it appears that there isn't enough basis functions for certain variables. In any case, let's observe it with respect to including all variables. 

    
```{r}
gam.model.tw = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 75) + at_least_3_songs + s(acousticness, bs = "cs", k = 89) + s(duration, bs = "cs", k = 45) + s(energy, bs = "cs", k = 69) + s(liveness, bs = "cs", k = 24) + s(loudness, bs = "cs", k = 39) + s(danceability, bs = "cs", k = 40) + s(tempo, bs = "cs", k = 49) + key + is_major + explicit + more_than_one_artist, data = spotify_updated_train, method = 'REML', family = tw)
AIC(gam.model.tw)
summary(gam.model.tw)
```
```{r}
gam.check(gam.model.tw, rep = 500) 
concurvity(gam.model.tw, full = F)$worst
```
```{r}
predict.gam.tw = predict.gam(gam.model.tw, spotify_updated_test, type = "response")
View(cbind('prediction' = predict.gam.tw,  'actual' = spotify_updated_test$popularity, 'residual' = abs(predict.gam.tw - spotify_updated_test$popularity)))
RMSE(predict.gam.tw, spotify_updated_test$popularity)
MAE(predict.gam.tw, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.tw, rug = T, seWithMean = T)
```
Examining the model with the Tweedie distribution, we see that the R^2 = 0.793 and a AIC of 899,843.8. This is slightly better than including only the select predictors based on the correlation matrix.  So compared to the linear regression models, it looks like a better fit model.  Further insepection at the accuracy of the model by looking at how the RMSE and MAE, it also seemed to perform better than the linear regression models earlier (RMSE = 9.90, MAE = 6.995), but still kind of sucks.  

However, as you look into diagnosing the model, we see that there are several red flags:

    1) With the concurvity check, it was found that there was a high degree of concurvity b/t danceability feature and the tempo feature.  Again, looking at it from the perspective of a fan of music, this would really make sense.  Like no one will willingly want to dance to a song that is low tempo unless it's at a wedding or a high school dance.  So a further exploration can be done to test the models without either danceability or tempo and observe the fit of the model to the variables to see if it improves or not. 
    
    2) Looking at the histogram of residuals, Q-Q plots, residual vs fitted plot and the residual vs. linear predict plot, it seem that this model is a poor fit overall.  Potentially, the use of the Tweedie distribution may not be the correct family of distribution for this data and another one should be used instead. 
    
    3) Looking at the gam.check, we see that the residuals are not randomly distributed for year. This often means there are not enough basis function. However, even increasing the number of basis functions doesn't appear to fix this since it's tapped out.  




So in an effort to see if these red flags would be corrected for, I've created two additional GAM models (one without Danceability + one without Tempo).  These two will be compared and we will see which one fits best depending on how it corrects for these red flags.  
```{r}
gam.model.tw_no.dance = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 75) + at_least_3_songs + s(acousticness, bs = "cs", k = 89) + s(duration, bs = "cs", k = 45) + s(energy, bs = "cs", k = 69) + s(liveness, bs = "cs", k = 24) + s(loudness, bs = "cs", k = 39) + s(tempo, bs = "cs", k = 49) + key + is_major + explicit + more_than_one_artist, data = spotify_updated_train, method = 'fREML', family = tw)
AIC(gam.model.tw_no.dance)
summary(gam.model.tw_no.dance)
```
```{r}
gam.check(gam.model.tw_no.dance, rep = 500) 
concurvity(gam.model.tw_no.dance, full = F)$worst
```
```{r}
predict.gam.tw_no.dance = predict.gam(gam.model.tw_no.dance, spotify_updated_test, type = "response")
View(cbind('prediction' = predict.gam.tw_no.dance,  'actual' = spotify_updated_test$popularity, 'residual' = abs(predict.gam.tw_no.dance - spotify_updated_test$popularity)))
RMSE(predict.gam.tw_no.dance, spotify_updated_test$popularity)
MAE(predict.gam.tw_no.dance, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.tw_no.dance, rug = T, seWithMean = T)
```

```{r}
gam.model.tw_no.tempo = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 75) + at_least_3_songs + s(acousticness, bs = "cs", k = 89) + s(duration, bs = "cs", k = 45) + s(energy, bs = "cs", k = 69) + s(liveness, bs = "cs", k = 24) + s(loudness, bs = "cs", k = 39) + s(danceability, bs = "cs", k = 40) + key + is_major + explicit + more_than_one_artist, data = spotify_updated_train, method = 'REML', family = tw)

AIC(gam.model.tw_select, gam.model.tw_no.tempo, gam.model.tw_no.dance, gam.model.tw)

summary(gam.model.tw_no.tempo)
```
```{r}
gam.check(gam.model.tw_no.tempo, rep = 500) 
concurvity(gam.model.tw_no.tempo, full = F)$worst
```
```{r}
predict.gam.tw_no.tempo = predict.gam(gam.model.tw_no.tempo, spotify_updated_test, type = "response")
View(cbind('prediction' = predict.gam.tw_no.tempo,  'actual' = spotify_updated_test$popularity, 'residual' = abs(predict.gam.tw_no.tempo - spotify_updated_test$popularity)))
RMSE(predict.gam.tw_no.tempo, spotify_updated_test$popularity)
MAE(predict.gam.tw_no.tempo, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.tw_no.tempo, rug = T, seWithMean = T)

```

Looking at the comparison b/t these two models, we still see that these red flags are found in these models. Compared b/t the models without tempo and dance, the "no dance" GAM model is slightly better in terms of fit b/t the two.  However, in comparison with a model with the select covariates, the accuracy isn't much better (like a difference of 0.3 in term of R^2 and 0.08 in terms of RMSE).  Let's observe this with other family of distributions. 

```{r}
gam.model_no.tempo = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 75) + at_least_3_songs + s(acousticness, bs = "cs", k = 89) + s(duration, bs = "cs", k = 45) + s(energy, bs = "cs", k = 69) + s(liveness, bs = "cs", k = 24) + s(loudness, bs = "cs", k = 39) + s(danceability, bs = "cs", k = 40) + key + is_major + explicit + more_than_one_artist, data = spotify_updated_train, method = 'REML')
AIC(gam.model_no.tempo)
summary(gam.model_no.tempo)
```
```{r}
gam.check(gam.model_no.tempo, rep = 500)
concurvity(gam.model_no.tempo, full = F)$worst
```
```{r}
pred_norm = predict(gam.model_no.tempo, newdata = spotify_updated_test, type = 'response')
View(cbind('prediction' = pred_norm,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_norm - spotify_updated_test$popularity)))
RMSE(pred_norm, spotify_updated_test$popularity)
MAE(pred_norm, spotify_updated_test$popularity)

```
```{r}
gam.model_select = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 89) + more_than_one_artist + s(acousticness, bs = "cs", k = 89) + s(energy, bs = "cs", k = 89) + s(loudness, bs = "cs", k = 89), data = spotify_updated_train, method = 'REML', select = T)

summary(gam.model_select)
AIC(gam.model_select)
```
```{r}
gam.check(gam.model_select, rep = 500)
concurvity(gam.model_select, full = F)$worst
```
```{r}
pred_norm_select = predict(gam.model_select, newdata = spotify_updated_test, type = 'response')
View(cbind('prediction' = pred_norm_select,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_norm_select - spotify_updated_test$popularity)))
RMSE(pred_norm_select, spotify_updated_test$popularity)
MAE(pred_norm_select, spotify_updated_test$popularity)
```
```{r}
plot(gam.model_select)
```
Examining the use of GAM models with a Gaussian distribution and almost all of the predictors (except for tempo + key), we see that the predictive ability is slightly better than compared to the previous models and definitely better than with just a select number of predictors.  However, it's fit is not as great as compared to the other GAMs, particularly as noted with the Q-Q plots and the distribution of the residuals being quite large.  Overall, there may be a better model to fit, so let's try with the poisson distribution. 


```{r}
gam.model.poisson = bam(popularity ~ s(year, bs = "cs", k = 100) + s(instrumentalness, bs = "cs", k = 75) + at_least_3_songs + s(acousticness, bs = "cs", k = 89) + s(duration, bs = "cs", k = 45) + s(energy, bs = "cs", k = 69) + s(liveness, bs = "cs", k = 24) + s(loudness, bs = "cs", k = 39) + s(danceability, bs = "cs", k = 40) + key + is_major + explicit + more_than_one_artist, select = T, data = spotify_updated_train, family = poisson, method = "REML")

summary(gam.model.poisson)
AIC(gam.model.poisson)
```
```{r}
concurvity(gam.model.poisson, full = F)$worst
gam.check(gam.model.poisson, rep = 500)
```
```{r}
pred_poisson = predict(gam.model.poisson, newdata = spotify_updated_test, type = 'response')
View(cbind('prediction' = pred_poisson,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_norm - spotify_updated_test$popularity)))
RMSE(pred_poisson, spotify_updated_test$popularity)
MAE(pred_poisson, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.poisson)
```
```{r}
gam.model.poisson_select = bam(popularity ~ s(year, bs = 'cs', k = 100) + s(instrumentalness, bs = "cs", k = 89) + s(acousticness, bs = "cs", k = 89) + more_than_one_artist + s(energy, bs = "cs", k = 89) + s(loudness, bs = "cs", k = 89), data = spotify_updated_train, method = "REML", family = poisson)

summary(gam.model.poisson_select)
AIC(gam.model.poisson_select)
```
```{r}
gam.check(gam.model.poisson_select)
concurvity(gam.model.poisson_select)
```
```{r}
pred_poisson_select = predict(gam.model.poisson_select, newdata = spotify_updated_test, type = "response")
View(cbind("prediction" = pred_poisson_select, "actual" = spotify_updated_test$popularity, "residual" = abs(pred_poisson_select - spotify_updated_test$popularity)))
RMSE(pred_poisson_select, spotify_updated_test$popularity)
MAE(pred_poisson_select, spotify_updated_test$popularity)
```
```{r}
plot(gam.model.poisson_select)
```

Looking at using a "poisson distribution", we see that R^2 = 0.794 and the AIC is 1,139,553. However, like the use of a gaussian distribution, the fit is just not very good at all in the diagnosis.  So let's try the zero-inflation poisson regression.  






Using the zero-inflated model, we'll need to see what sort of predictors would play a role in determining the status of a zero popularity score and a non-popularity score.  Using this, we can proceed with a two-step model in determining 

```{r}

starter_model = glm(is_popularity_zero ~ 1, data = spotify_updated_train, family = binomial(link = 'logit'))

full_model = glm(is_popularity_zero ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration + energy + explicit + instrumentalness + is_major + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, family = binomial(link = 'logit'))

stepAIC(starter_model, direction = 'both', scope = formula(full_model))

# What's retained were year, at_least_3_songs, instrumentalness, explicit, acousticness, more_than_one_artist, key, speechiness, loudness, danceability, tempo, valence, duration, liveness and energy. However, considering that the difference with and without energy is like ~ 1, might not need to include energy here...but we'll see  

summary(glm(is_popularity_zero ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration + energy + explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, family = binomial(link = 'logit')))

retained_model = glm(is_popularity_zero ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration + energy + explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, family = binomial(link = 'logit'))

pred_is_zero = predict(retained_model, spotify_updated_test, type = 'response')
pred_is_zero = ifelse(pred_is_zero > 0.5, 1, 0)
View(cbind("Prediction" = pred_is_zero, "Actual" = spotify_updated_test$is_popularity_zero))

mean(pred_is_zero == spotify_updated_test$is_popularity_zero) 
# This is like an approximately 91.467% model 


retained_model_a = glm(is_popularity_zero ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration +  explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, family = binomial(link = 'logit'))

pred_is_zero_a = predict(retained_model_a, spotify_updated_test, type = "response")
pred_is_zero_a = ifelse(pred_is_zero_a > 0.5, 1, 0)
mean(pred_is_zero_a == spotify_updated_test$is_popularity_zero) 
# This model also has a 91.467% accuracy 

AIC(retained_model, retained_model_a) # Essentially doesn't matter which model you really choose here. So just add the energy 


```

What's retained were year, at_least_3_songs, instrumentalness, explicit, acousticness, more_than_one_artist, key, speechiness, loudness, danceability, tempo, valence, duration, liveness and energy. However, considering that the difference with and without energy is like ~ 1, might not need to include energy here.  So in a comparison b/t the model with or without energy, it was found that the prediction is pretty much the same (~ 91.47%).  Based on the idea of not wanting to make a model more complex than it needs to be, we can just not have energy here. 

```{r}
zero_inflate_model = zeroinfl(popularity ~ year + more_than_one_artist + acousticness + energy + loudness + instrumentalness | year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration +  explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence , data = spotify_updated_train, zero.dist = "binomial" , dist = "poisson")
summary(zero_inflate_model)
AIC(zero_inflate_model)
```
```{r}
pred_zero = predict(zero_inflate_model, spotify_updated_test, type = 'response')
View(cbind('prediction' = pred_zero,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_zero - spotify_updated_test$popularity)))
RMSE(pred_zero, spotify_updated_test$popularity) # 10.95
MAE(pred_zero, spotify_updated_test$popularity) # 7.91
```
```{r}
zero_inflate_model.all =  zeroinfl(popularity ~ year + more_than_one_artist + acousticness + at_least_3_songs + duration + danceability + energy + instrumentalness + is_major + key + liveness + loudness + speechiness + tempo + valence | year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration +  explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence , data = spotify_updated_train, zero.dist = "binomial" , dist = "poisson")

summary(zero_inflate_model.all)
AIC(zero_inflate_model.all)
```
```{r}
pred_zero_all = predict(zero_inflate_model.all, spotify_updated_test, type = "response")
View(cbind("Prediction" = pred_zero_all, "actual" = spotify_updated_test$popularity, "Residual" = abs(pred_zero_all - spotify_updated_test$popularity)))
RMSE(pred_zero_all, spotify_updated_test$popularity) # 10.94
MAE(pred_zero_all, spotify_updated_test$popularity) # 7.90
```
```{r}
hurdle_model_all = hurdle(popularity ~ year + more_than_one_artist + acousticness + at_least_3_songs + duration + danceability + energy + instrumentalness + is_major + key + liveness + loudness + speechiness + tempo + valence | year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration +  explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, zero.dist = 'binomial' , dist = "poisson")

summary(hurdle_model_all)
AIC(hurdle_model_all)
```
```{r}
pred_hurdle_all = predict(hurdle_model_all, spotify_updated_test)
View(cbind('prediction' = pred_hurdle_all,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_hurdle_all - spotify_updated_test$popularity)))
RMSE(pred_hurdle_all, spotify_updated_test$popularity) # 10.95
MAE(pred_hurdle_all, spotify_updated_test$popularity) # 7.91
```
```{r}
hurdle_model = hurdle(popularity ~ year + more_than_one_artist + acousticness + energy + loudness + instrumentalness | year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration +  explicit + instrumentalness + key + liveness + loudness + speechiness + tempo + valence , data = spotify_updated_train, zero.dist = 'binomial' , dist = "poisson")

summary(hurdle_model)
AIC(hurdle_model)
```
```{r}
pred_hurdle = predict(hurdle_model, spotify_updated_test)
View(cbind('prediction' = pred_hurdle,  'actual' = spotify_updated_test$popularity, 'residual' = abs(pred_hurdle - spotify_updated_test$popularity)))
RMSE(pred_hurdle, spotify_updated_test$popularity) # 10.95
MAE(pred_hurdle, spotify_updated_test$popularity) # 7.91
```
Ok, so looking at a zero-inflated regression model (assuming a poisson distribution), the model containing just the factors with significant correlations to popularity had a slighly poorer accuracy as compared to all having all of the variables. In fact this was also reflected with the AIC scores.  However, these models performed worse compared to the previous linear and GAM models with Tweedie or Gaussian distribution. 

So far, it looks like the GAM model with the Tweedie Distribution appears to be the best fitted model. However, it still sucks as a predictive model. Let's explore a generalized linear model for a Tweedie Distribution. 



```{r}
tweed_model = glm(popularity ~ year + more_than_one_artist + acousticness + energy + loudness + instrumentalness, data = spotify_updated_train, family = tweedie(var.power = 1.5, link.power = 0))

summary(tweed_model)
```
```{r}
plot(tweed_model)
```
```{r}
pred_tweed = predict(tweed_model, spotify_updated_test, type = "response")
View(cbind("predict" = pred_tweed, "actual" = spotify_updated_test$popularity, "difference" = abs(pred_tweed - spotify_updated_test$popularity)))
RMSE(pred_tweed, spotify_updated_test$popularity)
MAE(pred_tweed, spotify_updated_test$popularity)
rms::vif(tweed_model)

```
```{r}
tweed_model_all = glm(popularity ~ year + more_than_one_artist + acousticness + at_least_3_songs + duration + danceability + energy + instrumentalness + is_major + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, family = tweedie(var.power = 1.5, link.power = 0))

summary(tweed_model_all)
```
```{r}
plot(tweed_model_all)
```
```{r}
pred_tweed_all = predict(tweed_model_all, spotify_updated_test, type = "response")
View(cbind("predict" = pred_tweed_all, "actual" = spotify_updated_test$popularity, "difference" = abs(pred_tweed_all - spotify_updated_test$popularity)))
RMSE(pred_tweed_all, spotify_updated_test$popularity)
MAE(pred_tweed_all, spotify_updated_test$popularity)
rms::vif(tweed_model_all)
```
Observing the linear models with Tweedie distribution, it appears that the model with select covariates performed was a slightly better predictor than compared to using a model with all of the covariates.  However, both of them along with the other linear models as a whole perform poorly as a predictive model compared to the Generalized Additive Models, which also kind of sucks.  Another option is to use regression trees for predicting outcomes. 



```{r}
r.part.tree_all = rpart(popularity ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration + energy + is_major + key + liveness + loudness + speechiness + tempo + valence, data = spotify_updated_train, method = 'anova')

rpart.plot(r.part.tree_all, type = 3, digits = 3, fallen.leaves = T)
printcp(r.part.tree_all) # So, popularity seems to only matter with respect to year ..... we'll talk about this later; least cross-validated error is at nsplit = 4
plotcp(r.part.tree_all)

predict.rpart_all = predict(r.part.tree_all, spotify_updated_test, type = "vector")
View(cbind("prediction" = predict.rpart, "actual" = spotify_updated_test$popularity))
RMSE(predict.rpart_all, spotify_updated_test$popularity)
MAE(predict.rpart_all, spotify_updated_test$popularity)
```
Utilizing a regression tree model, we see that only the "year" variable seems to play the sole role in driving predictions for popularity.  Nevertheless, the RMSE and MAE of this model is 10.64 and 7.76, respectively.  Compared to other models, the accuracy of this model is better than most linear models, but not compared to the generalized additive models. Let's try another modelling procedure to see if accuracy could be improved or not.  This time, we'll use KNN modelling





Ok so, we'll need to work with a modified data set that removes character variables since they aren't necessary here + normalize the data in order to run this.  In this case, I won't need the following: **id, name, main.artist, feature.artist.1, feature.artist.2, is_popularity_zero, is_foreign**

Additionally, we'll need to "normalize" the numerical variables which includes: **year, acousticness, danceability, duration, energy, instrumentalness, liveness, loudness, speechiness, tempo, valence**

So, what this will mean is that we'll take the categorical variables and transform them to a number by trying to make the binary (i.e. 0 and 1). These include the following: **at_least_3_songs, more_than_one_artist, explicit, and is_major**. In the case for **key**, while there is an intrinsic order to it as it is listed as a progression towards an octive, it'll probably be best to separate it out for each individual component.  Lastly, we'll need to treat **popularity** as the target, so take this out of the formalized target.

```{r}

norm_function = function(x) {
  ((x - min(x)) / (max(x) - min(x)))
}

spotify_norm_a = spotify_updated %>% dplyr::select(year, more_than_one_artist, acousticness, at_least_3_songs, danceability, duration, energy, explicit, instrumentalness, is_major, key, liveness, loudness, popularity, speechiness, tempo, valence)


spotify_norm_b = spotify_norm_a %>% 
  mutate(
    key_1 = ifelse(key == "A", 1, 0),
    key_2 = ifelse(key == "A#/Bb", 1, 0),
    key_3 = ifelse(key == "B", 1, 0),
    key_4 = ifelse(key == "C", 1, 0),
    key_5 = ifelse(key == "C#/Db", 1, 0),
    key_6 = ifelse(key == "D", 1, 0),
    key_7 = ifelse(key == "D#/Eb", 1, 0),
    key_8 = ifelse(key == "E", 1, 0),
    key_9 = ifelse(key == "F", 1, 0),
    key_10 = ifelse(key == "F#/Gb", 1, 0),
    key_11 = ifelse(key == "G", 1, 0),
    key_12 = ifelse(key == "G#/Ab", 1, 0), 
    more_than_one_artist = ifelse(more_than_one_artist == TRUE, 1, 0),
    at_least_3_songs = ifelse(at_least_3_songs == TRUE, 1, 0), 
    explicit = ifelse(explicit == T, 1, 0), 
    is_major = ifelse(is_major == T, 1, 0)
  )

```
```{r}
head(spotify_norm_b)
training_indices = createDataPartition(spotify_norm_b$popularity, p = 0.75, list = FALSE)
spotify_norm_b.training = spotify_norm_b[training_indices,]
spotify_norm_b.testing = spotify_norm_b[-training_indices,]
train_control = trainControl(method = "cv", number = 10)
```
```{r}

knn_proposed_one = train(
  popularity ~ year + more_than_one_artist + acousticness + at_least_3_songs + danceability + duration + energy + explicit + instrumentalness + is_major + liveness + loudness + speechiness + tempo + valence + key_1 + key_2 + key_3 + key_4 + key_5 + key_6 + key_7 + key_8 + key_9 + key_10 + key_11 + key_12, 
  data = spotify_norm_b.training,
  method = "knn", 
  trControl = train_control,
  preProcess = c("scale","center")
  )

knn_one_predictions = predict(knn_proposed_one, spotify_norm_b.testing)

evaluate = as.data.frame(cbind("actuals" = spotify_norm_b.testing$popularity, "predictions" = knn_one_predictions, "errors" = abs(spotify_norm_b.testing$popularity - knn_one_predictions), "errors.square" = (abs(spotify_norm_b.testing$popularity - knn_one_predictions)^2)))

rmse_score_knn_one = sqrt(mean(evaluate$errors.square))

rmse_score_knn_one
```
```{r}
knn_proposed_two = train(
  popularity ~ year + more_than_one_artist + acousticness + energy + instrumentalness + loudness, 
  data = spotify_norm_b.training,
  method = "knn", 
  trControl = train_control,
  preProcess = c("scale","center")
  )

knn_two_predictions = predict(knn_proposed_two, spotify_norm_b.testing)

evaluate = as.data.frame(cbind("actuals" = spotify_norm_b.testing$popularity, "predictions" = knn_two_predictions, "errors" = abs(spotify_norm_b.testing$popularity - knn_two_predictions), "errors.square" = (abs(spotify_norm_b.testing$popularity - knn_two_predictions)^2)))

rmse_score_knn_two = sqrt(mean(evaluate$errors.square))

rmse_score_knn_two
```
Using the caret package to undergo training + testing the kNN model with the 10-fold cross validation in predicting popularity score, it was found that RMSE was 10.28 with the predictors with strong colinearity with popularity score at p < 0.1.  This KNN model performed better in terms of accuracy compared to the inclusion of all predictors with a RMSE score of 11.62.  When comparing these to other models, it appears to perform relatively well compared some of the others like linear models with various distributions, regression trees (except for GAM models).  Possibly, by increasing this K-value we might see a bigger difference.

```{r}

spotify_norm_c1 = spotify_norm_a %>% mutate(    
    more_than_one_artist = ifelse(more_than_one_artist == TRUE, 1, 0),
    at_least_3_songs = ifelse(at_least_3_songs == TRUE, 1, 0), 
    explicit = ifelse(explicit == T, 1, 0), 
    is_major = ifelse(is_major == T, 1, 0))

spotify_norm = as.data.frame(lapply(spotify_norm_c1[, c(-11, -14)], norm_function))

indexing <- createDataPartition(spotify_norm_c1$popularity, p = 0.75, list = F)

spotify_norm_test = spotify_norm[-indexing,]
spotify_norm_train = spotify_norm[indexing,]

spotify_norm_target = spotify_norm_c1[indexing, 14]
spotify_norm_target_test = spotify_norm_c1[-indexing, 14]


pred_knn = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 10)


tab = table(pred_knn, spotify_norm_target_test)

View(tab)

accuracy = function(x) {
  sum(diag(x)/sum(rowSums(x)))
}

accuracy(table(pred_knn, spotify_norm_target_test))

```
Using an alternative approach to running the KNN model with the 10-fold CV, (assuming the split works out the same way as the previous...probably not) we see that the accuracy of this model containing all of the predictors is approx. 18.44% (like pretty low).  What if we were to adjust the K value, would we see a difference? 

```{r}

pred_knn_1 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 11)
pred_knn_2 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 12)
pred_knn_3 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 13)
pred_knn_4 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 14)
pred_knn_5 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 15)
pred_knn_6 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 16)
pred_knn_7 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 17)
pred_knn_8 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 18)
pred_knn_9 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 19)
pred_knn_10 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 20)
pred_knn_11 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 21)
pred_knn_12 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 22)
pred_knn_13 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 23)
pred_knn_14 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 24)
pred_knn_15 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 25)
pred_knn_16 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 26)
pred_knn_17 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 27)
pred_knn_18 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 28)
pred_knn_19 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 29)
pred_knn_20 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 30)
pred_knn_21 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 31)
pred_knn_22 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 32)
pred_knn_23 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 33)
pred_knn_24 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 34)
pred_knn_25 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 35)
pred_knn_26 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 36)
pred_knn_27 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 37)
pred_knn_28 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 38)
pred_knn_29 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 39)
pred_knn_30 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 40)
pred_knn_31 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 41)
pred_knn_32 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 42)
pred_knn_33 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 43)
pred_knn_34 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 44)
pred_knn_35 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 45)
pred_knn_36 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 46)
pred_knn_37 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 47)
pred_knn_38 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 48)
pred_knn_39 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 49)
pred_knn_40 = knn(spotify_norm_train, spotify_norm_test, cl = spotify_norm_target, k = 50)

accuracy(table(pred_knn_1, spotify_norm_target_test))
accuracy(table(pred_knn_2, spotify_norm_target_test))
accuracy(table(pred_knn_3, spotify_norm_target_test))
accuracy(table(pred_knn_4, spotify_norm_target_test))
accuracy(table(pred_knn_5, spotify_norm_target_test))
accuracy(table(pred_knn_6, spotify_norm_target_test))
accuracy(table(pred_knn_7, spotify_norm_target_test))
accuracy(table(pred_knn_8, spotify_norm_target_test))
accuracy(table(pred_knn_9, spotify_norm_target_test))
accuracy(table(pred_knn_10, spotify_norm_target_test))
accuracy(table(pred_knn_11, spotify_norm_target_test))
accuracy(table(pred_knn_12, spotify_norm_target_test))
accuracy(table(pred_knn_13, spotify_norm_target_test))
accuracy(table(pred_knn_14, spotify_norm_target_test))
accuracy(table(pred_knn_15, spotify_norm_target_test))
accuracy(table(pred_knn_16, spotify_norm_target_test))
accuracy(table(pred_knn_17, spotify_norm_target_test))
accuracy(table(pred_knn_18, spotify_norm_target_test))
accuracy(table(pred_knn_19, spotify_norm_target_test))
accuracy(table(pred_knn_20, spotify_norm_target_test))
accuracy(table(pred_knn_21, spotify_norm_target_test))
accuracy(table(pred_knn_22, spotify_norm_target_test)) # Best one
accuracy(table(pred_knn_23, spotify_norm_target_test))
accuracy(table(pred_knn_24, spotify_norm_target_test))
accuracy(table(pred_knn_25, spotify_norm_target_test))
accuracy(table(pred_knn_26, spotify_norm_target_test))
accuracy(table(pred_knn_27, spotify_norm_target_test))
accuracy(table(pred_knn_28, spotify_norm_target_test))
accuracy(table(pred_knn_29, spotify_norm_target_test))
accuracy(table(pred_knn_30, spotify_norm_target_test))
accuracy(table(pred_knn_31, spotify_norm_target_test))
accuracy(table(pred_knn_32, spotify_norm_target_test))
accuracy(table(pred_knn_33, spotify_norm_target_test))
accuracy(table(pred_knn_34, spotify_norm_target_test))
accuracy(table(pred_knn_35, spotify_norm_target_test))
accuracy(table(pred_knn_36, spotify_norm_target_test))
accuracy(table(pred_knn_37, spotify_norm_target_test))
accuracy(table(pred_knn_38, spotify_norm_target_test))
accuracy(table(pred_knn_39, spotify_norm_target_test))
accuracy(table(pred_knn_40, spotify_norm_target_test))


evaluate_1 = as.data.frame(cbind("actuals" = spotify_norm_target_test, "predictions" = pred_knn_22, "errors" = abs(spotify_norm_target_test - knn_two_predictions), "errors.square" = (abs(spotify_norm_target_test - knn_two_predictions)^2)))

rmse_score_knn_three = sqrt(mean(evaluate$errors.square))

rmse_score_knn_three

```
Generally, it looks like with an increase in the number of K values, we see that the accuracy is approx. 19%. Howver going with what we have, it looks like a K value of 32 had the highest accuracy.  

```{r}

RMSE_scores = cbind(
"linear with select predictors" = RMSE(predict_linear, spotify_updated_test$popularity),
"linear with all predictors" = RMSE(predict_linear_all, spotify_updated_test$popularity),
"GAM with tweedie distribution & all predictors" = RMSE(predict.gam.tw, spotify_updated_test$popularity),
"GAM with tweedie distribution & all predictors except for danceability" = RMSE(predict.gam.tw_no.dance, spotify_updated_test$popularity),
"GAM with tweedie distribution & all predictors except for tempo" = RMSE(predict.gam.tw_no.tempo, spotify_updated_test$popularity),
"GAM with tweedie distribution & select predictors" = RMSE(predict.gam.tw_select, spotify_updated_test$popularity),
"GAM with gaussian distribution & all predictors except for tempo" = RMSE(pred_norm, spotify_updated_test$popularity),
"GAM with poisson distribution & all predictors except for tempo" = RMSE(pred_poisson, spotify_updated_test$popularity),
"linear with Zero-inflated poisson distribution & select predictors" = RMSE(pred_zero, spotify_updated_test$popularity),
"linear with Zero-inflated poisson distribution & all predictors" = RMSE(pred_zero_all, spotify_updated_test$popularity),
"hurdle model for zero-inflated poisson distribution & select predictors" = RMSE(pred_hurdle, spotify_updated_test$popularity),
"hurdle model for zero-inflated poisson distribution & all predictors" = RMSE(pred_hurdle_all, spotify_updated_test$popularity),
"linear with tweedie distribution & select predictors" = RMSE(pred_tweed, spotify_updated_test$popularity),
"linear with tweedie distribution & all predictors" = RMSE(pred_tweed_all, spotify_updated_test$popularity),
"Regression Tree & all predictors" = RMSE(predict.rpart, spotify_updated_test$popularity),
"kNN Modelling with 10-fold cross validation" = rmse_score_knn_one, 
"kNN Modelling with 10-fold cross validation with select predictors" = rmse_score_knn_two,
"kNN Modelling with 32-fold cross validation with all predictors" = rmse_score_knn_three
)

View(RMSE_scores)

```


## Objective 3 Summary

Looking at the various predictive models for popularity scores based on audio + track features, it appears as though the top 3 are the GAM models in terms of accuracy.  However, there are some concerns with these models having some issue as it pertained to the poor fit of the predictive model to the actual values, particularly with respect to the adequate number of basis functions.  Additionally, by in large, these models all appear to perform poorly in predicting popularity scores given the large RMSE values (perfect fit is 0, pretty accurate models are around 0.2-0.5).  These red flags can be explained by the missingness of one or more key variables that may play an even bigger role in predicting popularity score than what was examined.  Some that I can think of are: (1) artist, (2) genre, (3) domestic vs. international artist (reference: US).  Additionally, the music industry is really fickle and really no one truly knows what will be a hit or how the audience will consume the product despite the abundance of Pop, Hip Hop and Country music on the airwaves.  In fact, there are several examples in history where supposed "next big hits" didn't really pan out as hoped despite artist reputation, label backing, etc.  Nevertheless, we can see that from these models that essentially the year of track release largely drives popularity scores on Spotify, whilst features like acousticness/energy/instrumentalness/loudness/presence of a featured artist played a significant but more minor role. 

